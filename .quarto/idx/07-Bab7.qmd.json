{"title":"Rancangan Split Blok","markdown":{"headingText":"Rancangan Split Blok","containsRefs":false,"markdown":"\nFilosofi dasar rancangan split blok mirip dengan strip plot - ada petak utama dan anak petak. Anak petak tersebut mengandung suatu aspek dari percobaan yang ingin ditekankan (diketahui pengaruhnya dengan ketepatan lebih tinggi). Dalam split blok kasus ini yang ditekankan bukan satu faktor, melainkan interaksi antara faktor. Oleh karena itu, faktor menjadi petak utama.\n\nRancangan split blok hanya dapat diterapkan dalam RAKL, tidak di RAL. Unit percobaan harus dipisahkan menjadi blok, lalu petak utama diacak di lajur dan baris blok tersebut. Pengacakan semua faktor di lajur dan baris tidak mungkin terjadi di satu unit percobaan yang hanya mengandung satu perlakuan atau satu kombinasi faktor sehingga dibutuhkan blok agar pengacakan semua kombinasi tersebut dapat dilakukan.\n\n## Pengacakan\n\nLangkah pengacakannya adalah sebagai berikut:\n\n- Pilihlah kelompok unit percobaan secara acak \n- Tempatkan taraf-taraf faktor A secara acak pada setiap kelompok \nmengikuti plot lajur\n- Tempatkan taraf-taraf faktor B secara acak pada setiap kelompok \nmengikuti plot baris.\n\n### Pengacakan di agricolae\n\nSebelum langkah-langkah pengacakan di atas diikuti, akan didefinisikan faktor yang akan dicobakan dan tarafnya. Hendak dicobakan pupuk dengan taraf \"Kontrol\", \"PK\", \"N\", \"NP\", \"NK\", dan \"NPK\" serta genotipe beras dengan taraf IR-64 dan S-969.\n\n```{r}\nP<-c(\"Kontrol\", \"PK\", \"N\", \"NP\", \"NK\",\"NPK\")\nG<-c(\"IR-64\",\"S-969\")\n```\n\nPengacakan split blok di agricolae cukup sederhana. Nama lain dari split blok adalah strip-plot, dan ada fungsi `design.strip(faktor1, faktor2, nblok)` di package tersebut:\n\n```{r}\nbaganSplitB<-agricolae::design.strip(P,G,r=4,serie=1)\n```\n\nPerlihatkan bagan percobaan:\n\n```{r}\nknitr::kable(head(baganSplitB$book, n=10),\n             col.names= c(\"Petak\", \"Blok\",\n                          \"Pupuk\", \"Genotipe\"))\n```\n\n### Pengacakan di edibble\n\nDalam rancangan strip plot, ada empat unit percobaan. Pengaruh blok tentu diaplikasikan ke blok, lalu pengaruh faktor ditaruh di lajur dan baris, serta interaksi di tiap unit. Maka, di edibble buat empat unit. Blok, lalu kolom dan baris yang `nested_in(blok)`, dan petak yang di dalam blok - `nested_in(blok)` dan `crossed_by(baris, kolom)` - tiap petak merupakan gabungan dari baris dan kolom. Cara mendefinisikan kasus ini adalah dengan menyatakan bahwa petak `crossed_by()` terlebih dahulu, lalu `nested_in()` - di tiap blok, petak merupakan gabungan baris dan kolom. Karena operasi dalam kurung dilaksanakan terlebih dahulu, bentuknya menjadi `nested_in(blok, crossed_by())`.\n\nLalu, pengacakan dilakukan ke baris dan kolom.\n\n```{r}\nlibrary(edibble)\n\ndesSBlok<-design(name=\"Padi\") %>%\n  set_units(blok=4,\n            baris=nested_in(blok,2),\n            kolom=nested_in(blok,6),\n            petak=nested_in(blok,crossed_by(baris,kolom))) %>%\n  set_trts(Genotipe=G,\n           Pupuk=P) %>%\n  allot_trts(Genotipe~baris,\n             Pupuk~kolom) %>%\n  assign_trts(\"random\", seed=420) %>% serve_table\n\nknitr::kable(head(desSBlok,n=10))\n```\n\nPlot rancangan tersebut:\n\n```{r}\ndeggust::autoplot(desSBlok)\n```\n\nBandingkan dengan default edibble:\n\n```{r}\nstrip <- takeout(menu_strip(t1 = 2, t2 = 6, r = 4, seed=420))\nexamine_recipe(strip)\n```\n\nPlotnya akan relatif sama:\n\n```{r}\ndeggust::autoplot(strip)\n```\n\n## ANOVA\n\n### Teori\n\nModel linear aditif bagi split plot RAL adalah:\n$$\ny_{ijk} = \\mu + \\alpha_i + K_{k}+ \\delta_{ik} + \\beta_j + \\gamma_{jk}+(\\alpha\\beta)_{ij} + \\epsilon_{ijk}\n$$\n\nDengan:\n\n1. $y_{ijk}$ adalah nilai pengamatan pada faktor A taraf ke-i dan faktor B taraf ke-j pada blok ke-k.\n2. $\\mu$ komponen aditif dari rataan umum.\n3. $\\alpha_i$ pengaruh utama faktor A. Diasumsikan $\\sum_{i=1}^a \\alpha_i=0$ bagi model tetap dan $\\alpha\\sim N(0,\\sigma_a^2)$ bagi model acak.\n4. $\\beta_{j}$ pengaruh utama faktor B. Diasumsikan $\\sum_{j=1}^b \\beta_j=0$ bagi model tetap dan $\\beta\\sim N(0,\\sigma_b^2)$ bagi model acak.\n5. $K_{k}$ pengaruh utama kelompok.\n6. $(\\alpha\\beta)_{ij}$ komponen interaksi faktor A dan faktor B. Diasumsikan $\\sum_{i=1}^p(\\alpha\\beta)_{ij}=\\sum_{i=1}^t (\\alpha\\beta)_{ij}=0$ bagi model tetap dan $(\\alpha\\beta)_{ij}\\sim N(0,\\sigma_{ab}^2)$ bagi model acak.\n7. $\\delta_{ik}\\sim N(0,\\sigma_{\\delta}^2)$ komponen acak dari faktor A.\n8. $\\gamma_{jk}\\sim N(0,\\sigma_{\\gamma}^2)$ komponen acak dari faktor B.\n8. $\\epsilon_{ijk}\\sim N(0,\\sigma^2)$ komponen acak interaksi dari faktor A dan B.\n\nDan hipotesis pengaruh petak utama, anak petak, dan interaksi.\n$$\n\\begin{aligned}\n&\\text{Pengaruh petak utama (Faktor A)}:\\\\\nH_{0}&:\\alpha_{1}=\\ldots=\\alpha_{a}=0 \\\\\n&\\text{ faktor A tidak berpengaruh pada respon}\\\\\nH_{1}&: \\text{Paling sedikit ada satu i di mana }\\alpha_{i}\\neq 0\\\\\n\\\\\n&\\text{Pengaruh anak petak (Faktor B)}:\\\\\nH_{0}&:\\beta_{1}=\\ldots=\\beta_{b}=0 \\\\\n&\\text{ faktor B tidak berpengaruh pada respon}\\\\\nH_{1}&: \\text{Paling sedikit ada satu j di mana }\\beta_{j}\\neq 0\\\\\n\\\\\n&\\text{Pengaruh interaksi }:\\\\\nH_{0}&:(\\alpha\\beta)_{11}=(\\alpha\\beta)_{12}=\\ldots=(\\alpha\\beta)_{ab}=0 \\\\\n&\\text{ interaksi tidak berpengaruh pada respon}\\\\\nH_{1}&: \\text{Paling sedikit ada sepasang ij di mana }(\\alpha\\beta)_{ij}\\neq 0\\\\\n\\\\\n&\\text{Pengaruh kelompok}:\\\\\nH_{0}&:K_{1}=\\ldots=K_{k}=0 \\\\\n&\\text{ Kelompok tidak berpengaruh pada respon}\\\\\nH_{1}&: \\text{Paling sedikit ada satu k di mana }K_{k}\\neq 0\\\\\n\n\\end{aligned}\n$$\n\nDan tabel ANOVA:\n```{r , echo=FALSE, results='asis'}\n  cat('\n  | Sumber Keragaman| db| JK| KT| F-hit|F(dbP,dbG)|\n  |------------:|-----------:|------------:|------------:|------------:|------------:|\n  |          Blok|         r-1|          JKK| JKK/dbA | KTK/KTGA | |\n  |          A|         a-1|          JKA| JKA/dbA | KTA/KTGA | |\n  |          Galat (a)|         (a-1)(r-1)|          JKGA| JKGA/dbGA | | |\n  |          B|         (b-1)|         JKB| JKB/dbB | KTB/KTGB | |\n  |          Galat (b)|         (b-1)(r-1)|          JKGA| JKGA/dbGB | | |\n  |          AB|         (a-1)(b-1)|         JKAB| JKAB/dbAB | KTAB/KTGC | |\n  |          Galat (c)|       (a-1)(b-1)(r-1)|         JKGC| JKGC/dbGC | | |\n  |          Total|         abr-1|          JKT| | | |')\n```\n\nUntuk bagian pertama tabel, jumlah kuadrat dihitung dengan:\n\n$$\n\\begin{aligned}\nFK&=\\frac{y^2_{...}}{abr}\\\\\n\nJKT&=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k=1}^r\\left(y_{ijk}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k=1}^r y_{ijk}^2-FK\\\\\n\nJKST_a&=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k=1}^r\\left(\\bar{y}_{i.k}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{k=1}^r \\frac{y_{i.k}^2}{b}-FK\\\\\n\nJKA&=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k=1}^r\\left(\\bar{y}_{i..}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a \\frac{y_{i..}^2}{br}-FK\\\\\n\nJKK&=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k=1}^r \\left(\\bar{y}_{..k}-\\bar{y}_{...}\\right)^2=\\sum_{k=1}^r \\frac{y_{..k}^2}{ab}-FK\\\\\n\nJKG_{a}&=JKST_a-JKA-JKK\\\\\n\\end{aligned}\n$$\n\nUntuk bagian kedua tabel:\n\n$$\n\\begin{aligned}\nJKB&=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k=1}^r\\left(\\bar{y}_{.j.}-\\bar{y}_{...}\\right)^2=\\sum_{j=1}^b \\frac{y_{.j.}^2}{ar}-FK\\\\\nJKST_{b}&=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k=1}^r\\left(\\bar{y}_{ij.}-\\bar{y}_{...}\\right)^2=\\sum_{k=1}^r\\sum_{j=1}^b \\frac{y_{.jk}^2}{a}-FK\\\\\nJKG_{b}&=JKST_{b}-JKB\\\\\n\\end{aligned}\n$$\n\nDan untuk bagian terakhir tabel:\n\n$$\n\\begin{aligned}\nJKP&=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k-1}^r\\left(\\bar{y}_{ij}-\\bar{y}_{..}\\right)^2=\\sum_{i=1}^a\\sum_{j=1}^b\\frac{y_{ij.}^2}{r}-FK\\\\\nJKAB&=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k-1}^r\\left(\\bar{y}_{ij.}-\\bar{y}_{i..}-\\bar{y}_{.j.}+\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k-1}^r\\left(\\bar{y}_{ij.}-\\bar{y}_{...}\\right)^2-JKA-JKB\\\\\n&=JKP-JKB-JKA\\\\\nJKG_{c}&=JKT-JKP-JKK-JKG_{a}-JKG_{b}\n\\end{aligned}\n$$\n\n### Analisis dengan R\n\nLoad data:\n\n```{r cache=TRUE}\nlibrary(googlesheets4)\nlibrary(data.table)\n\nData.SB<-as.data.table(read_sheet(\"https://docs.google.com/spreadsheets/d/1meWerIyAv1X8jtHXoFCTysvzPy91ptQL6F9sO_-RUNs/edit?usp=sharing\"))\n\nknitr::kable(Data.SB)\n```\n\nKarena data belum berbentuk *long* - satu baris adalah satu observasi, melt data tersebut. Tiap baris dalam data awal diidentifikasi oleh kombinasi pupuk dan genotipe, sehingga `id.vars` adalag `c(\"P\",\"G\")`:\n\n```{r}\nData.SB<-melt(\n  Data.SB,\n  id.vars=c(\"P\",\"G\"),\n  value.name = \"H\"\n)\n\nknitr::kable(head(Data.SB,10))\n```\n\nUbah kolom `variable` menjadi blok:\n\n```{r}\nsetnames(Data.SB,\"variable\", \"B\")\n```\n\nUntuk melakukan ANOVA, perlu ada struktur error yang khusus. Pada dasarnya, akan ada error khusus untuk faktor serta interaksinya, sehingga tulis `Error(B:(P*G))` - akan dihitung `Error(B:P)`, `Error(B:G)`, dan `Error(B:(G:P))`, atau error tiap faktor dan interaksinya di tiap ulangan (blok). Spesifikasi lain adalah:\n\n```{r}\naov.SB<-aov(H~P*G+B+Error(B:(P*G)),Data.SB)\nsummary(aov.SB)\naov.SB1<-aov(H~P*G+B+Error(B:P*B:G),Data.SB)\nsummary(aov.SB1)\n```\n\nPastikan ada kurung, karena anova akan salah tanpa kurung:\n\n```{r}\naov.SB1<-aov(H~P*G+B+Error(B:P*G),Data.SB)\nsummary(aov.SB1)\n```\n\nAtau, dapat digunakan fungsi `strip.plot(blok, faktor 1, faktor 2, respon)` dari agricolae:\n\n```{r}\nlibrary(agricolae)\n\nout1<-with(Data.SB,strip.plot(B,P,G,H))\n```\n\nUji lanjut untuk tiap faktor dapat mudah dilakukan. gl.a adalah derajat bebas galat a, dan Ea galat A.\n\n```{r}\ntest1<-agricolae::LSD.test(Data.SB$H, Data.SB$P, out1$gl.a, out1$Ea)\ntest1$statistics\nplot(test1)\n```\n\nNamun, tampaknya tidak dilakukan penyesuaian pada KTG sehingga perlu dilakukan perhitungan manual jika ingin ada penyesuaian tersebut:\n\n### Latihan: Huasahuasi\n\nSedang diteliti ambang batas curah hujan sebagai dukungan untuk aplikasi fungisida waktu dalam pengendalian penyakit busuk daun kentang di Peru menggunakan strip plot. \n\n\n```{r}\nlibrary(agricolae)\n\ndata(huasahuasi)\nstr(huasahuasi)\n```\n\nKarena ada dua data.frame, ambil `data.frame` YIELD:\n\n```{r}\nYIELD<-huasahuasi$YIELD\nstr(YIELD)\n```\n\nAda y1da, y2da, dan y3da. Respon yield merupakan penjumlahan dari ketiga respon tersebut - `YIELD$yield<- y1da+y2da+y3da`, dan perlakuan ada di trt dan clon. \n\nBuat bagan percobaan dengan edibble dan lakukan ANOVA!"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"arrow","output-file":"07-Bab7.html"},"language":{"label":{"fig":"Gambar "},"ui":{"chapter_name":"Bab "}},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"0.9.426","bibliography":["book.bib","packages.bib"],"delete_merged_file":true,"theme":"simplex","code-block-border-left":true},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"07-Bab7.pdf"},"language":{"label":{"fig":"Gambar "},"ui":{"chapter_name":"Bab "}},"metadata":{"block-headings":true,"bibliography":["book.bib","packages.bib"],"delete_merged_file":true,"documentclass":"scrreport"},"extensions":{"book":{}}},"epub":{"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"epub","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false},"pandoc":{"default-image-extension":"png","to":"epub","output-file":"07-Bab7.epub"},"language":{"label":{"fig":"Gambar "},"ui":{"chapter_name":"Bab "}},"metadata":{"bibliography":["book.bib","packages.bib"],"delete_merged_file":true,"cover-image":"cover.png"},"extensions":{"book":{}}}}}