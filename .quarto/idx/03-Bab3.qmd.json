{"title":"Perbandingan Nilai Tengah Perlakuan","markdown":{"headingText":"Perbandingan Nilai Tengah Perlakuan","containsRefs":false,"markdown":"ANOVA pada RAK, RAKL, dan RBSL hanya dapat menguji ketidaknolan efek perlakuan. Semisal diketahui setidaknya salah satu perlakuan tersebut memiliki efek, lalu bagaimana? Tentu ada pertanyaan-pertanyaan lain yang menarik, misal:\n\n1. Perlakuan mana yang memberi efek terbesar atau terkecil?\n2. Perlakuan mana yang memberi efek mirip?\n3. Apakah perlakuan dapat dikelompokkan?\n\nDan pertanyaaan-pertanyaan lain. Pertanyaan itu dijawab **uji lanjut**.\n\n## LSD/BNT\n\nUji BNT menguji perlakuan secara berpasangan. Menurut Carmer dan Swanson (1973) di Montgomery (2017), BNT efektif mendeteksi perbedaan rataan perlakuan jika diaplikasikan **setelah* uji-F di ANOVA signifikan di taraf 5 persen. Hipotesis perbandingan BNT sebagai berikut:\n$$\n\\begin{aligned}\nH_{0}&: \\mu_{i}=\\mu_{j}\\\\\nH_{1}&:\\mu_{i}\\neq \\mu_{j} \n\\end{aligned}\n$$\nDengan nilai kritis BNT sebagai berikut:\n$$\n\\begin{aligned}\nLSD&=t_{\\alpha/2,db_{g}}S_{\\bar{y}_{i.}-\\bar{y}_{j.}}\\\\\nS_{\\bar{y}_{i.}-\\bar{y}_{j.}}&=\\sqrt{KTG\\left(\\frac{1}{r_{i}}+\\frac{1}{r_{j}}\\right)}\n\\end{aligned}\n$$\nJika ulangan sama, $S_{\\bar{y}_{i.}-\\bar{y}_{j.}}=\\sqrt{\\frac{2KTG}{r}}$ (kenapa?). Prosedur uji tersebut adalah membandingkan $\\bar{y}_{i.}-\\bar{y}_{j.}$ dengan nilai kritis. Implementasi di R (dari data RAL sebelumnya) sebagai berikut:\n\n```{r warning=FALSE}\nlibrary(googlesheets4)\n#baca sheet\nDataRAL<-read_sheet(\"https://docs.google.com/spreadsheets/d/1Bzm_R2Zd4Zbij7BO7LGDJW83DU6T3Wh7R38NN5DHCBs/edit?usp=sharing\")\n\n#reshaping\nlibrary(reshape2)\n\nRALMelt<- melt(DataRAL,\n               #variabel yang membedakan tiap baris di tabulasi asli:\n               id.vars=c(\"Dosis\"),\n               \n               #kolom yang ingin digabung jadi 1\n               measured.vars=as.character(seq(1,8)),\n               value.name=\"Perkecambahan\")\ncolnames(RALMelt)[2]<-\"Ulangan\"\nRALMelt$Dosis<-as.factor(RALMelt$Dosis)\n\n#anova\naov_RAL <- aov(Perkecambahan ~ Dosis, data = RALMelt)\nsummary(aov_RAL)\n```\n\nGunakan library agricolae:\n```{r}\nlibrary(agricolae)\nLSD<-agricolae::LSD.test(aov_RAL, \"Dosis\") #hasil anova, perlakuan\n\n\nknitr::kables(\n  list(\n    knitr::kable(LSD$statistics[6]), #tabel 1\n    knitr::kable(LSD$groups, col.names = c(\"Rata-Rata per Taraf\",\n                                           \"Kelompok\")) #tabel 2\n  ),\n)\n```\n\nAtau susun argumen sebagai berikut,\n\n```{r}\nlibrary(agricolae)\nLSD2<-agricolae::LSD.test(RALMelt$Perkecambahan, RALMelt$Dosis,35,12.4) #respon, perlakuan, dbg, KTG\n\nknitr::kables(\n  list(\n    knitr::kable(LSD2$statistics[6]) , #tabel 1\n    knitr::kable(LSD2$groups, col.names =c(\"Rata-Rata per Taraf\",\n                                           \"Kelompok\")) #tabel 2\n    ),\n)\n```\n\nDapat dicek sendiri bahwa pengelompokan tersebut benar. Dapat juga dibuat visualisasi:\n\n```{r}\nplot(LSD,horiz=T)\n```\n\nNote, BNT menguji *semua* perlakuan secara berpasangan, sehingga tidak bisa memilih perbandingan tertentu saja (misal, rata-rata terbesar vs terkecil). Selain itu, BNT memiliki kelemahan, yaitu hanya dapat mengontrol tingkat kesalahan uji sepasang rata-rata saja. Jika ada beberapa pasang rata-rata, tingkat kesalahan berpotensial lebih besar. Banyak perbandingan $g=k(k-1)/2$ (dari permutasi), sehingga *family error rate* sebesar $1-(1-\\alpha)^g$. Perhitungan tersebut hanya merupakan kebalikan dari perhitungan $P(\\text{Tolak }H_{0}|H_{0} \\text{ benar})$. $(1-\\alpha)$. Jika diasumsikan perbandingan saling bebas, maka probabilitas tersebut menjadi $(1-\\alpha)^g$.\n\n## BNJ\nLalu, bagaimana cari membuat uji yang mengontrol *family error rate*? BNJ mengontrol kesalahan di t buah perlakuan sebesar $\\alpha$, sehingga di tiap pasangan akan menarima kesalahan sebesar $\\alpha/2g$ karena uji dua arah menggunakan $\\alpha/2$ dan ada g ulangan. Jika jumlah perlakuan banyak, metode ini akan sangat ekstrim. Oleh karena itu, walaupun metode ini tidak terlalu sensitif, metode ini memisahkan perlakuan yang benar-benar beda. BNJ memiliki nilai kritis:\n$$\n\\begin{aligned}\nBNJ&=q_{\\alpha;t;db_{g}}S_{\\bar{y}}\\\\\nS_{\\bar{y}}&=\\sqrt{KTG/r}\n\\end{aligned}\n$$\nDengan t jumlah perlakuan, q memiliki asal statistik *studentized range*. Jika ulangan tak sama, r didekati:\n$$\nr_{h}=\\frac{t}{\\sum_{i=1}^t 1/r_{i}}\n$$\nDengan langkah-langkah uji:\n\n1. Urutkan rataan perlakuan dari yang terkecil sampai yang terbesar atau sebaliknya\n2. Nilai awal i=1 (dari kiri)  dan j =1 (dari kanan)\n3. Hitung beda antara rataan perlakuan terkecil ke-i dengan terbesar ke-j kemudian bandingkan dengan nilai BNJ, jika beda rataan perlakuan lebih kecil lanjutkan ke langkah 5 (taktolak $H_{0}$) dan jika tidak lanjutkan ke langkah 4\n4. Berikan j = j+1, jika j<p kembali ke langkah 3\n5. Buatlah garis mulai rataan perlakuan ke-i sampai ke perlakuan ke-j\n6. Berikan I = i+1, jika i<p kembali ke langkah 3\n7. Stop\n\nImplementasi uji tersebut di R adalah:\n\n```{r}\ntukey <- TukeyHSD(aov_RAL, 'Dosis', conf.level = 0.95)\n\n\nlibrary(kableExtra)\nknitr::kable(tukey$Dosis, col.names = c(\" \",\n                                        \" Bawah\",\n                                        \" Atas\",\n                                        \" \")) %>%\nadd_header_above(c(\" Taraf\"=1, \"Beda\"=1, \"Batas Selang Kepercayaan\"=2, \"P-Value\"=1))\n```\n\nCara membaca tabel tersebut adalah melihat apakah selang kepercayaan (lwr dan upper) memiliki tanda positif dan negatif. Jika ada dua tanda, berarti nol termasuk di selang kepercayaan, sehingga kita belum dapat menyatakan rataan perlakuan tersebut beda. Proses tersebut dapat divisualisikan:\n\n```{r}\nplot(tukey, las = 1, col = 'dark blue')\n```\n\nAnalisis di python dapat dimulai dengan melakukan reshape kepada data. Detail dari proses ini sudah dijelaskan sebelumnya:\n\n```{python}\nimport pandas as pd\n\nRALData = pd.read_csv(\"https://docs.google.com/spreadsheets/d/e/2PACX-1vT8sPRuEulqieCMFJK4sKReRjtuXOQD_xwTlI3RB619yYwSWwb776-Dmu5UY5P44hy5MsMPJPsjcZUp/pub?gid=0&single=true&output=csv\")\nRALMeltpy=pd.melt(RALData, id_vars=['Dosis'], value_vars=[str(x) for x in range(1,9)])\nRALMeltpy.rename(columns = {'variable':'Ulangan', 'value':'Produksi'}, inplace = True)\nRALMeltpy.head()\n```\n\nLalu, statsmodels memiliki fungsi `MultiComparison(respon, perlakuan)`:\n\n```{python}\nimport statsmodels.formula.api as smf\nimport statsmodels.stats.multicomp as multi \n\nmcDosis = multi.MultiComparison(RALMeltpy['Produksi'],RALMeltpy['Dosis'])\nResults = mcDosis.tukeyhsd()\nprint(Results)\n```\n\nHasil sama seperti R. Hasil juga dapat di-plot dengan:\n\n```{python}\nimport matplotlib.pyplot as plt\n\ntukPlot=Results.plot_simultaneous()\nplt.show()\n```\n\n\nTingkat kepercayaan juga dapat diubah:\n\n```{python}\nResults = mcDosis.tukeyhsd(alpha=0.01)\nprint(Results)\n```\n\n## Uji Duncan\n\nUji Duncan intinya mirip dengan uji Tukey, tetapi nilai pembanding di uji Duncan meningkat tergantung jarak dari perlakuan yang dibandingkan. Uji tersebut memiliki nilai kritis:\n$$\n\\begin{aligned}\nR_{p}&=r_{\\alpha;t;db_{g}}S_{\\bar{y}}\\\\\nS_{\\bar{y}}&=\\sqrt{KTG/r}\n\\end{aligned}\n$$\nDan jika jumlah ulangan tak sama dapat didekati rataan harmonik juga. t adalah beda urutan perlakuan kedua kelompok. Misal membandingkan perlakuan terbesar (1) dan terkecil (4) dari 4 perlakuan akan menghasilkan t=3. Langkah uji mirip dengan Tukey, yaitu:\n\n1. Urutkan rataan perlakuan dari yang terkecil sampai yang terbesar atau sebaliknya\n2. Nilai awal i=1 (dari kiri)  dan j =1 (dari kanan)\n3. Hitung beda antara rataan perlakuan terkecil ke-i dengan terbesar ke-j kemudian bandingkan dengan nilai BNJ, jika beda rataan perlakuan lebih kecil lanjutkan ke langkah 5 (taktolak $H_{0}$) dan jika tidak lanjutkan ke langkah 4\n4. Berikan j = j+1, jika j<p kembali ke langkah 3\n5. Buatlah garis mulai rataan perlakuan ke-i sampai ke perlakuan ke-j\n6. Berikan I = i+1, jika i<p kembali ke langkah 3\n7. Stop\n\nLangsung uji:\n\n```{r}\nduncan <- duncan.test(aov_RAL, 'Dosis', alpha = 0.05) #Bisa Model aov atau lm\nknitr::kable(duncan$duncan)\nknitr::kable(duncan$groups)\n```\n\nDan dapat divisualisasikan:\n\n```{r}\nplot(duncan, horiz = TRUE, las = 1)\n```\n\nNote bahwa Uji Tukey menyatakan dosis 64 tak beda dengan dosis 48, padahal uji Duncan dan LSD menyatakan dosis tersebut beda. Hal tersebut menunjukkan kurang sensitifnya uji Tukey.\n\n## Kontras\n\nKontras merupakan kombinasi linear dari rataan perlakuan. Sebuah kombinasi linear tersusun atas seperangkat objek. Setiap objek dikalikan dengan suatu konstanta, dan hasil perkalian semua objek dan konstanta ditambahkan. Pada intinya, setiap rataan perlakuan akan dikalikan dengan suatu konstanta dan hasil perkalian tersebut akan ditambahkan. Bentuk umum kontras adalah:\n$$\n\\begin{aligned}\nH_{0}&: c_{1}\\mu_{1}+c_{2}\\mu_{2}+\\cdots+c_{t}\\mu_{t}=\\sum_{i=1}^t c_{i}\\mu_{i}=0\\\\\nH_{1}&: c_{1}\\mu_{1}+c_{2}\\mu_{2}+\\cdots+c_{t}\\mu_{t}=\\sum_{i=1}^t c_{i}\\mu_{i}\\neq 0\n\\end{aligned}\n$$\nYang diduga dengan\n$$\nC=\\sum_{i=1}^t c_{i}y_{i.}\n$$\nDengan $y_{i.}$ adalah total di perlakuan ke-i. Kontras memiliki syarat:\n$$\n\\sum_{i=1}^t c_{i}=0\n$$\nSelain itu, kontras disebut *ortogonal* jika hasil suatu uji tidak memengaruhi hasil uji lain. Sebagai contoh, kontras:\n$$\n\\begin{aligned}\nH^{(1)}_0\\colon \\mu_1 = \\mu_2\\\\\nH^{(2)}_0\\colon \\mu_1 = \\mu_3\\\\\nH^{(3)}_0\\colon \\mu_2 = \\mu_3\\\\\n\\end{aligned}\n$$\nTidak ortogonal. Bayangkan bahwa kita menolak $H_{0}^3$, tetapi tak tolak hipotesis lainnya. Ini merupakan kontradiksi karena $\\mu_{1}=\\mu_{2}$ dan $\\mu_{1}=\\mu_{3}$ secara logis memberi implikasi $\\mu_{2}=\\mu_{3}$. Namun, uji mengatakan sebaliknya. \n\nUntuk melihat kenapa hal tersebut terjadi, kontras dapat dilihat lebih lanjut:\n$$\n\\begin{aligned}\nH^{(1)}_0\\colon 1\\mu_1-1\\mu_{2}+0\\mu_{3} = 0\\\\\nH^{(2)}_0\\colon 1\\mu_1+0\\mu_2-1\\mu_3=0\\\\\nH^{(3)}_0\\colon 0\\mu_1+1\\mu_2-1\\mu_3=0\\\\\n\\end{aligned}\n$$\nDapat dengan mudah diverifikasi bahwa semua $\\sum_{i=1}^t c_{i}$ adalah nol. Namun, jika kita kalikan kontras pertama ($c_{i}$) dan kontras kedua ($d_{i}$) serta melihat hasilnya, maka kita akan temukan $\\sum_{i=1}^t c_{i}d_{i}=1+0+0=1\\neq 0$. Bandingkan dengan contoh ini:\n\n> Sebuah percobaan menguji efek pemberian nitrogen pada pertumbuhan rumput. Perlakuan dalam percobaan tersebut ada empat, yaitu tidak diberi nitrogen sebagai kontrol (1), diberi nitrogen di musim gugur (2), diberi nitrogen di musim semi (3), dan diberikan pada kedua musim (4). Ingin diketahui:\n>\n>1. Apakah terdapat perbedaan pertumbuhan rumput dari yang tidak diberi nitrogen dengan diberi nitrogen?\n>2. Apakah ada perbedaan pertumbuhan rumput jika diberikan nitrogen pada saat musim gugur dengan musim semi?\n>3. Apakah ada perbedaan pertumbuhan rumput jika diberikan pada saat musim gugur atau musim semi dengan diberikan pada kedua musim tersebut?\n\nKontras tersebut dapat disusun:\n$$\n\\begin{aligned}\nH^{(1)}_0\\colon 3\\mu_1-1\\mu_{2}-1\\mu_{3}-1\\mu_{4} = 0\\\\\nH^{(2)}_0\\colon 0\\mu_1+1\\mu_{2}-1\\mu_{3}-0\\mu_{4}=0\\\\\nH^{(3)}_0\\colon 0\\mu_1+1\\mu_2+1\\mu_3-2\\mu_{4}=0\\\\\n\\end{aligned}\n$$\nAlasan penyusunan kontras sebagai berikut dapat ditelusuri dari beberapa prinsip:\n\n1. Di sebuah kontras, perlakuan yang tidak ingin dibandingkan mendapatkan $c_{i}=2$. Misal, di kontras kedua hanya dibandingkan musim gugur ($\\mu_{2}$) dan musim semi ($\\mu_{3}$), sehingga koefisien di tanpa nitrogen dan kedua musim ($\\mu_{1},\\mu_{4}$) nol. Begitu juga di kontras ketiga, perlakuan tanpa nitrogen tidak ingin dibandingkan sehingga koefisiennya nol.\n2. Pastikan bobot tiap perlakuan sama. Suatu kontras pada dasarnya membagi perlakuan menjadi dua kelompok yang hendak dibandingkan. Namun, agar perbandingan tersebut adil, bobot perlakuan harus sama. Misal, di hipotesis pertama, hanya ada 1 perlakuan tanpa nitrogen sedangkan ada 3 perlakuan dengan nitrogen. Jika kita membandingkan rata-rata 1 perlakuan tanpa nitrogen dengan hasil tambah *tiga* perlakuan dengan nitrogen, pasti tidak adil. Anggap saja $\\mu_{1}=\\mu_{2}=\\mu_{3}=\\mu_{4}$, seharusnya kontras menunjukkan sisi kiri sama dengan sisi kanan. Namun, jika kita melakukan pertambahan secara naif, akan muncul perbandingan $\\mu_{1}\\neq3\\mu_{1}$. Oleh karena itu $\\mu_{1}$ harus kita boboti 3 agar perbandingannya adil. Dalam kasus $H_{0}$ benar tadi, pembobotan $\\mu_{1}$ dengan 3 menghasilkan $3\\mu_{1}=3\\mu_{1}$.\n3. Pastikan tanda antara kelompok berbeda. Satu kelompok akan memiliki tanda positif dan satu kelompok memiliki tanda negatif. Ini dikarenakan jumlah koefisien nol sehingga perlu tanda positif dan negatif untuk menghasilkan angka tersebut.\n\nSekarang, dapat dipikirkan secara logis implikasi dari tiap uji:\n$$\n\\begin{aligned}\nH^{(1)}_0&\\colon \\mu_1=\\frac{\\mu_{2}+\\mu_{3}+\\mu_{4}}{3}\\\\\nH^{(2)}_0&\\colon \\mu_{2}=\\mu_{3}\\\\\nH^{(3)}_0&\\colon \\frac{\\mu_2+\\mu_3}{2}=\\mu_{4}\\\\\n\\end{aligned}\n$$\nTidak ada hipotesis yang saling berkontradiksi. Jika $\\mu_{2}$ tidak sama dengan $\\mu_{3}$, misal, hipotesis pertama dan ketiga masih dapat benar ataupun salah. Jika dijabarkan dalam perkataan, pengujian mengenai efek dari pemberian nitrogen dibandingkan dengan tidak sama sekali tidak memberi informasi mengenai efek pemberian nitrogen di dua musim dibandingkan dengan satu musim. Begitu juga, kedua uji tersebut tidak memberi informasi mengenai efek perbandingan nitrogen di musim semi atau gugur.\n\nSecara formal, dapat kita lihat bahwa $\\sum_{i=1}^t c_{i}d_{i}=0$ untuk tiap kombinasi kontras. Dari aljabar linear, jika **c** dan **d** merupakan vektor, ini sama dengan hasil kali transpose **c** dengan **d**. Maka, buktikan di R:\n\n```{r}\nkontras1<-c(3,-1,-1,-1)\nkontras2<-c(0,1,-1,0)\nkontras3<-c(0,1,1,-2)\n\n#kali vektor\nt(kontras1)%*%kontras2\nt(kontras1)%*%kontras3\nt(kontras2)%*%kontras3\n```\n\nOleh karena itu, kontras akan orthogonal jika $\\sum_{i=1}^t c_{i}d_{i}=0$. Keortogonalan berarti hasil satu uji bebas dari uji lain, sehingga jumlah kuadrat perlakuan dapat dipartisi.\n\n### Menyusun kontras ortogonal\nMisalkan ada contoh:\n\n> Ingin dibandingkan 5 populasi dari data. Sebelumnya, kita memiliki alasan untuk percaya bahwa populasi 2 dan 3 paling dekat. Populasi 4 dan 5 juga dekat, tetapi tidak sedekat populasi 2 dan 3. Populasi 1 lebih dekat ke populasi 2 dan 3 daripada populasi 4 dan 5.\n\nKedekatan tersebut digambarkan dalam diagram:\n\n```{r, echo=FALSE, fig.cap=\"Diagram pengelompokan populasi. Sumber: Department of Statistics, Pennsylvania State University (online.stat.psu.edu).\", out.width='70%'}\nknitr::include_graphics(\"C:/Sem 6/Asprak - Rancob/ModulPrak-Rancob/Gambar/formula_59.gif\")\n```\n\nDari grafik dan soal tersebut, muncul empat pertanyaan:\n1. Apakah populasi 2 dan 3 (yang dianggap sekelompok) beda? (D)\n2. Apakah populasi 4 dan 5 beda? (C)\n3. Apakah populasi 1 beda dengan populasi 2, 3? (B)\n4. Apakah populasi 1, 2, 3, beda dengan populasi 4 dan 5? (A)\n\nOleh karena itu, dapat dibentuk kontras:\n\n```{r , echo=FALSE, results='asis'}\n  cat('\n  | Kontras| 1| 2| 3| 4|5|\n  |------------:|-----------:|------------:|------------:|------------:|------------:|\n  |          A|         2|          2| 2 | -3 | -3 |\n  |          B|         2|          -1| -1 | 0 | 0 |\n  |          C|         0|         0| 0 | 1 |-1 |\n  |          D|         0|          1| -1| 0|0 |')\n```\n\nKeortogonalan kontras tersebut dapat dicek melalui matriks ragam peragam:\n\n```{r}\nA<-c(2,2,2,-3,-3)\nB<-c(2,-1,-1,0,0)\nC<-c(0,0,0,1,-1)\nD<-c(0,1,-1,0,0)\n\ncontrasts<-cbind(A,B,C,D)\ncov(contrasts)\n```\n\nJika matriks diagonal, ini berarti koragam nol dan kontras saling orthogonal. Secara logis, hasil tiap uji tidak memberi informasi mengenai hasil uji lainnya.\n\nContoh lain untuk mengilustrasikan kontras orthogonal adalah sebagai berikut\n\n>Efektivitas suatu obat hendak dicek. Perlakuan 1 merupakan obat A berdosis rendah, perlakuan 2 merupakan obat A berdosis tinggi, perlakuan 3 merupakan obat B berdosis rendah, dan perlakuan 4 merupakan obat B berdosis tinggi.\n\nTentu, terlihat beberapa arah perbandingan:\n\n1. Obat - apakah obat A dan B beda?\n2. Dosis - apakah dosis tinggi dan rendah beda?\n3. Interaksi - apakah efek obat bergantung pada dosis?\n\nSehingga dibuat kontras:\n```{r , echo=FALSE, results='asis'}\n  cat('\n  | Kontras| 1| 2| 3| 4|\n  |------------:|-----------:|------------:|------------:|------------:|\n  |          Obat|         1|          1| -1 | -1 | \n  |          Dosis|         1|          -1| 1 | -1 | \n  |          Interaksi|         1|          -1| -1| 1|')\n```\n\nCek ortogonalitas\n\n```{r}\nObat<-c(1,1,-1,-1)\nDosis<-c(1,-1,1,-1)\nInteraksi<-c(1,-1,-1,1)\n\ncontrasts2<-cbind(Obat,Dosis,Interaksi)\ncov(contrasts2)\n```\n\nAlasan penyusunan kontras obat dan dosis seperti di tabel cukup masuk akal. Bandingkan obat A dan B atau kelompok dosis tinggi dan dosis rendah. Penyusunan kontras interaksi sebenarnya sama saja dengan mengalikan efek-efek sebelumnya. Telah disusun obat A bertanda positif (+) dan obat B bertanda negatif (-). Dosis rendah bertanda positif (+) dan dosis tinggi bertanda negatif. Maka, kalikan saja tanda tersebut.\n\nSebagai contoh lain, misal diberi tabel rata-rata perlakuan sebagai berikut:\n\n```{r , echo=FALSE, results='asis'}\n  cat('\n  | Perlakuan| A| B| C| D|\n  |------------:|-----------:|------------:|------------:|------------:|\n  |          Rata-rata|         12.0|          12.3| 10.8 | 6.8 | ')\n```\n\nDapat dilihat bahwa D tampak sangat berbeda dari perlakuan lain. A dan B tampak sangat mirip. C agak dekat ke A dan B. Oleh karena itu, susun kontras:\n\n```{r , echo=FALSE, results='asis'}\n  cat('\n  | Kontras| A| B| C| D|\n  |------------:|-----------:|------------:|------------:|------------:|\n  |          D vs ABC|         1|          1| 1 | -3 |\n  |          c vs AB|         1|          1| -2 | 0 |\n  |          A vs B|         1|          -1| 0 | 0 |')\n```\n\nOrthogonalitas kontras tersebut dapat diuji:\n\n```{r}\nDvABC<-c(1,1,1,-3)\nCvAB<-c(1,1,-2,0)\nAvB<-c(1,-1,0,0)\n\ncontrasts3<-cbind(DvABC,CvAB,AvB)\ncov(contrasts3)\n```\n\n### Menghitung Kontras\n\nSetelah mengetahui cara membuat kontras, bagaimana perhitungannya? Untuk t-1 kontras orthogonal, dapat dilakukan uji F, dengan statistik uji sebagai berikut:\n$$\n\\begin{aligned}\nJKC&=KTC=\\frac{\\left(\\sum_{i=1}^t c_{i}Y_{i.}\\right)^2}{r\\sum_{i=1}^t c_{i}^2}\\\\\nF&=KTC/KTG=F_{\\alpha,1,db_{g}}\n\\end{aligned}\n$$\nDapat dipraktekkan di R:\n\n```{r warning=FALSE}\nlibrary(googlesheets4)\ndataKontras<-read_sheet(\"https://docs.google.com/spreadsheets/d/19lOrOm5Vb7ATet8tR6Xq5NEOnB1J2Jj7HXPDy6Sv9og/edit?usp=sharing\")\nknitr::kable(dataKontras)\n```\n\nTentu, data harus di-melt:\n\n```{r}\nlibrary(reshape2)\nKontrasMelted<-melt(dataKontras,\n                    id.vars=c(\"Perlakuan\"),\n                    measured.vars=c(\"Kelompok 1\", \"Kelompok 2\",\"Kelompok 3\"),\n                    value.name=\"Pertumbuhan\")\ncolnames(KontrasMelted)[2]<-\"Kelompok\"\n```\n\nLalu, pastikan perlakuan dan kelompok adalah faktor dan buat kontras:\n\n```{r}\n#faktor\nKontrasMelted$Perlakuan<-as.factor(KontrasMelted$Perlakuan)\nKontrasMelted$Kelompok<-as.factor(KontrasMelted$Kelompok)\n\nlevels(KontrasMelted$Perlakuan)\n```\n\nKita sudah mengetahui urutan faktor di R. Oleh karena itu, buat kontras:\n\n```{r}\n#buat kontras\ncontrasts(KontrasMelted$Perlakuan) <- cbind(c(1, -3, 1, 1), c(1, 0, 0, -1),\n                             c(1, 0, -2, 1))\ncontrasts(KontrasMelted$Perlakuan)\n```\n\nLakukan ANOVA dan partisi:\n\n```{r}\naovKontras<-aov(Pertumbuhan~Perlakuan+Kelompok,KontrasMelted)\nsummary.aov(aovKontras, split = list (Perlakuan = list('K vs FSpSpl' = 1, 'F vs Sp' = 2, 'FSp vs Spl' = 3)))\n```\n\nInterpretasi dari partisi tersebut sesuai dengan hipotesis yang diuji. Jika menggunakan $\\alpha=5\\%$, dinyatakan bahwa rata-rata kontrol dengan perlakuan lainnya berbeda signifikan, begitu juga rata-rata 2 musim dengan 1 musim. Namun, belum ditemukan bukti cukup untuk menyatakan rata-rata musim semi dan gugur berbeda signifikan.\n\n## Polinomial Orthogonal\n\nPolinomial orthogonal dilakukan untuk menguji tren pengaruh perlakuan terhadap respon jika perlakuan bersifat kuantitatif dan berjarak sama. Model polinomial orthogonal dapat berbentuk linear, kuadratik, kubik, kuartik, dan lain-lain:\n\n$$\n\\begin{aligned}\n\\text{Linear: }& Y_{i}=\\beta_0+\\beta_1X_i+\\varepsilon_i\\\\\n\\text{Kuadratik: }& Y_{i}=\\beta_0+\\beta_1X_i+\\beta_2X_i^2+\\varepsilon_i\\\\\n\\text{Kubik: }& Y_{i}=\\beta_0+\\beta_1X_i+\\beta_2X_i^2+\\beta_3X_i^3+\\varepsilon_i\\\\\n\\end{aligned}\n$$\n\nDengan bentuk umum polinomial ordo ke-N adalah:\n\n$$\nY=\\alpha_0P_0(X)+\\alpha_1P_1(X)+\\alpha_2P_2(X)+\\ldots+\\alpha_nP_n(X)+\\varepsilon_i\n$$\n\nDengan:\n$$\n\\begin{aligned}\nP_0&=1\\\\\nP_1&=\\lambda_1\\left[\\frac{X-\\bar{X}}{d}\\right]\\\\\nP_2&=\\lambda_2\\left[\\left(\\frac{X-\\bar{X}}{d}\\right)^2-\\left(\\frac{a^2-1}{12}\\right)\\right]\\\\\nP_{n+1}(X)&=\\lambda_{n+1}\\left[P_1(X)P_n(X)-\\frac{n^2(a^2-n^2)}{4(4n^2-1)}P_{n-1}(X)\\right]\n\\end{aligned}\n$$\n\nDengan:\n\n1. $a$: banyaknya taraf faktor\n2. $d$: jarak antar faktor\n3. $n$: polinomial ordo ke-n\n\nTabel kontras bagi polinomial orthogonal untuk `a` jumlah faktor dapat dihasilkan dengan `contr.poly(a)`:\n\n```{r}\nknitr::kable(contr.poly(5), col.names=c(\"Linear\",\n                                        \"Kuadratik\",\n                                        \"Kubik\",\n                                        \"Kuartik\"))\n```\n\nUntuk memperlihatkan cara kerja polinomial orthogonal, dapat dibuat suatu data yang memiliki taraf-taraf faktor kuantitatif:\n\n```{r}\nkerapatan <- factor(rep(c(10, 20, 30, 40, 50), each = 3))\nhasil <- c(12.2, 11.4, 12.4,\n           16.0, 15.5, 16.5, \n           18.6, 20.2, 18.2,\n           17.6, 19.3, 17.1,\n           18.0, 16.4, 16.6)\ndata2 <- data.frame(kerapatan, hasil)\nstr(data2)\n```\n\nSebelum menganalisis menggunakan polinomial, plot data sebagai cara eksploratif:\n\n```{r}\nlibrary(ggplot2)\n\nggplot(data2,aes(x=kerapatan,y=hasil))+\n  geom_point()+\n  stat_summary(fun.y=mean, colour=\"darkblue\", geom=\"line\", aes(group = 1))+\n  theme_bw()\n```\n\nTampaknya pengaruh kerapatan berbentuk kuadratik karena plot menarik, mencapai puncak, lalu menurun. Lalu, definisikan kontras dan lakukan ANOVA.\n\n```{r}\ncontrasts(data2$kerapatan) <- contr.poly(5)\n\nanova2 <- aov(hasil ~ kerapatan, data = data2)\nsummary.aov(anova2, split = list (kerapatan = list('Linear' = 1, 'Kuadratik' = 2,\n                                                    'Kubik' = 3, 'Kuartik' = 4)))\n```\n\nNampaknya pengaruh kerpatan pada hasil berupa kuadratik, yang dapat dimodelkan sebagai:\n\n```{r}\nsummary(lm(hasil~kerapatan,data2))\n```\n\n$$\nY=16.400+3.7947X_i-3.7417X_i^2   \n$$\n\nKontras juga dapat diinput secara manual.\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"arrow","output-file":"03-Bab3.html"},"language":{"label":{"fig":"Gambar "},"ui":{"chapter_name":"Bab "}},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"0.9.426","bibliography":["book.bib","packages.bib"],"delete_merged_file":true,"theme":"simplex","code-block-border-left":true},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"03-Bab3.pdf"},"language":{"label":{"fig":"Gambar "},"ui":{"chapter_name":"Bab "}},"metadata":{"block-headings":true,"bibliography":["book.bib","packages.bib"],"delete_merged_file":true,"documentclass":"scrreport"},"extensions":{"book":{}}},"epub":{"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"epub","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false},"pandoc":{"default-image-extension":"png","to":"epub","output-file":"03-Bab3.epub"},"language":{"label":{"fig":"Gambar "},"ui":{"chapter_name":"Bab "}},"metadata":{"bibliography":["book.bib","packages.bib"],"delete_merged_file":true,"cover-image":"cover.png"},"extensions":{"book":{}}}}}