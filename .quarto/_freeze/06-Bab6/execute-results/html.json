{
  "hash": "3ccfc72d760b896dbc9acefda5b492f4",
  "result": {
    "markdown": "# Rancangan Petak Terpisah (Split Plot Design)\n\nDalam percobaan dua faktor, kombinasi perlakuan belum tentu diacak secara sempurna terhadap unit percobaan. Pengacakan sempurna berarti semua kombinasi perlakuan dibuat dan diacak pada semua unit percobaan (atau pada suatu blok di Split Plot RAKL). Dalam suatu rancangan split plot, pengacakan dilakukan **bertahap**. **Petak utama** diacak terlebih dahulu, lalu faktor yang ditempatkan sebagai **anak petak** diacak di tiap petak utama. Rancangan ini dipilih karena beberapa alasan:\n\n1. Tingkatan kepentingan dari faktor yang dilibatkan. Di Tabel ANOVA, akan terlihat bahwa derajat bebas galat petak utama lebih kecil dari anak petak. Ini berarti faktor pembagi jumlah kuadrat galat akan lebih kecil di petak utama, sehingga kuadrat tengah galat bisa saja lebih besar. Berarti, keragaman (atau kesalahan yang muncul dari faktor acak) lebih besar di petak utama sehingga ketepatan uji di petak utama lebih rendah. Ini dapat terjadi jika peneliti lebih tertarik pada suatu efek (misal, dengan efek varietas daripada lokasi). Oleh karena itu, efek varietas yang harus diduga dengan lebih tepat menjadi anak petak.\n2. Nisbah pengaruh faktor. Jika satu faktor memiliki pengaruh besar, tidak perlu ketepatan tinggi untuk menangkap pengaruh tersebut. Misal diketahui bahan berpengaruh besar pada kualitas suatu pedang (misal, pedang baja lebih kuat dari pedang besi), dan pengaruh waktu tempa lebih kecil. Bahan dapat menjadi petak utama.\n3. Pengembangan dari percobaan yang sudah berjalan. Misal ada percobaan yang mengacak dosen-dosen ke kelas tertentu, lalu di dalam kelas tersebut peneliti tertarik melihat pengaruh bimbingan belajar. Oleh karena itu, kelas yang mengandung dosen menjadi petak utama, lalu bimbingan belajar diacak ke siswa yang menjadi anak petak.\n4. Kendala pengacakan di lapangan. Misal, salah satu faktor tidak bisa atau tidak efisien jika diacak secara karena taraf faktor membutuhkan unit yang besar. Misal, pengolahan lahan membutuhkan traktor, sehingga harus menjadi petak utama dan varietas menjadi anak petak.\n5. Lokasi menjadi petak utama dan perlakuan menjadi anak petak. Misal dicobakan varietas tanaman di kampus IPB Dramaga dan di kampus IPB Baranangsiang.\n6. Waktu (musim, tahun) menjadi petak utama, dan perlakuan menjadi anak petak. Semisal di diacak beberapa kegiatan besar untuk tiap semester, lalu di tiap semester berkegiatan besar tersebut diacak anggota panitianya.\n7. Repeated measurements. Perlakuan menjadi petak utama, lalu waktu-waktu tertentu pengamatan  menjadi anak petak\n\n## Split Plot RAL\n\n### Pengacakan\nPengacakan pada rancangan petak terpisah di R dapat langsung dilakukan menggunakan fungsi design.split dari library agricolae. Akan digunakan studi kasus berikut:\n\n>Dalam usaha menjaga kesehatan lingkungan dilakukan percobaan dengan menggunakan berbagai jenis tanaman untuk menyerap debu di udara. Jenis tanaman yang digunakan antara lain tanaman berdaun kecil licin (J1 dan J2), berdaun kecil kasar (J3, J4), berdaun lebar licin (J5, J6), berdaun lebar kasar (J7, J8), dan berdaun jarum (J9, J10). Percobaan ini dicobakan pada dua lokasi (Cipedak dan Gatot Subroto). Setiap perlakuan diulang 3 kali dan unit-unit percobaan yang digunakan diasumsikan homogen. Dari percobaan ini ingin diketahui jenis tanaman yang mampu menyerap debu paling efektif dan di lokasi mana? Peubah respons yang dicatat dari percobaan ini adalah konsentrasi debu (ppm) yang melekat pada daun tanaman.\n\n\nUntuk melakukan pengacakan, bangkitkan taraf kedua faktor terlebih dahulu:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nLokasi<-c(\"Cipedak\",\"Gatot S.\")\nJenis<-paste(\"J\",seq(10),sep=\"\")\n```\n:::\n\n\nPengacakan secara cepat dapat dilakukan dengan menggunakan design.split dari library agricolae. Pastikan design berupa CRD (completely randomized design) jika menggunakan split plot RAL. Argumen fungsi diurutkan sebagai berikut karena lokasi merupakan petak utama, jenis anak petak, dan ada tiga ulangan.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(agricolae)\n\nbagan<-design.split(Lokasi , Jenis,r=3, design=\"crd\",serie = 0,\n             seed = 0, kinds = \"Super-Duper\", first=TRUE,randomization=TRUE)$book #(utama, anak, ulangan)\nknitr::kable(head(bagan),n=10)\n```\n\n::: {.cell-output-display}\n| plots|splots |  r|Lokasi   |Jenis |\n|-----:|:------|--:|:--------|:-----|\n|     1|1      |  1|Gatot S. |J9    |\n|     1|2      |  1|Gatot S. |J4    |\n|     1|3      |  1|Gatot S. |J2    |\n|     1|4      |  1|Gatot S. |J5    |\n|     1|5      |  1|Gatot S. |J8    |\n|     1|6      |  1|Gatot S. |J10   |\n:::\n\n```{.r .cell-code}\nnrow(bagan)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 60\n```\n:::\n:::\n\n\nBagan memiliki 60 baris, yang masuk akal karena $A\\times B\\times r=2\\times 10\\times 3=60$, di mana faktor A adalah lokasi, B adalah jenis, dan r ulangan. Jika ingin lebih detail, dapat diperhatikan bahwa pengacakan split plot dapat dilakukan sebagai berikut:\n\n1. Pengacakan RAL untuk plot utama, dengan unit percobaan berjumlah $A\\times r$.\n2. RAKL dengan $A\\times r$ blok, dengan $B$ unit percobaan di blok tersebut.\n\nImplementasi di agricolae sebagai berikut:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbagan1<-design.crd(Lokasi,r=3,serie=0)\nknitr::kable(bagan1$book)\n```\n\n::: {.cell-output-display}\n| plots|  r|Lokasi   |\n|-----:|--:|:--------|\n|     1|  1|Cipedak  |\n|     2|  2|Cipedak  |\n|     3|  1|Gatot S. |\n|     4|  2|Gatot S. |\n|     5|  3|Cipedak  |\n|     6|  3|Gatot S. |\n:::\n:::\n\n\nLalu, fase kedua dari pengacakan. Ada $2\\times 3=6$ blok:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbagan2<-design.rcbd(Jenis,r=6)\nknitr::kable(head(bagan2$book),n=10)\n```\n\n::: {.cell-output-display}\n| plots|block |Jenis |\n|-----:|:-----|:-----|\n|   101|1     |J2    |\n|   102|1     |J5    |\n|   103|1     |J10   |\n|   104|1     |J3    |\n|   105|1     |J8    |\n|   106|1     |J1    |\n:::\n\n```{.r .cell-code}\nnrow(bagan2$book)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 60\n```\n:::\n:::\n\n\nLakukan merge. Note bahwa tiap plot di pengacakan pertama akan menjadi blok, sehingga merge di x menggunakan plot dan di y menggunakan blok:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbaganfin<-merge(bagan1$book,bagan2$book,by.x=\"plots\",by.y=\"block\")\nknitr::kable(head(baganfin),n=10)\n```\n\n::: {.cell-output-display}\n| plots|  r|Lokasi  | plots.y|Jenis |\n|-----:|--:|:-------|-------:|:-----|\n|     1|  1|Cipedak |     101|J2    |\n|     1|  1|Cipedak |     102|J5    |\n|     1|  1|Cipedak |     103|J10   |\n|     1|  1|Cipedak |     104|J3    |\n|     1|  1|Cipedak |     105|J8    |\n|     1|  1|Cipedak |     106|J1    |\n:::\n\n```{.r .cell-code}\nnrow(baganfin)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 60\n```\n:::\n:::\n\n\nSehingga terbuat bagan final. Bagan tersebut dapat dilihat dengan beberapa format lain, seperti:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbag2<-bagan[,-c(1,2)]\nknitr::kables(list(\n  knitr::kable(reshape2::dcast(bag2,Lokasi~Jenis)), #lokasi vs jenis (berapa jenis tertentu di lokasi tertentu)\n  knitr::kable(reshape2::dcast(bag2,Lokasi+r~Jenis)) #lokasi, ulangan vs jenis (bagan, tapi tabulasi format wide)\n ),\n caption=\"Dua cara menunjukkan bagan percobaan\"\n)\n```\n\n::: {.cell-output-display}\n<table class=\"kable_wrapper\">\n<caption>Dua cara menunjukkan bagan percobaan</caption>\n<tbody>\n  <tr>\n   <td> \n\n|Lokasi   | J1| J10| J2| J3| J4| J5| J6| J7| J8| J9|\n|:--------|--:|---:|--:|--:|--:|--:|--:|--:|--:|--:|\n|Cipedak  |  3|   3|  3|  3|  3|  3|  3|  3|  3|  3|\n|Gatot S. |  3|   3|  3|  3|  3|  3|  3|  3|  3|  3|\n\n </td>\n   <td> \n\n|Lokasi   |  r|J1 |J10 |J2 |J3 |J4 |J5 |J6 |J7 |J8 |J9 |\n|:--------|--:|:--|:---|:--|:--|:--|:--|:--|:--|:--|:--|\n|Cipedak  |  1|J1 |J10 |J2 |J3 |J4 |J5 |J6 |J7 |J8 |J9 |\n|Cipedak  |  2|J1 |J10 |J2 |J3 |J4 |J5 |J6 |J7 |J8 |J9 |\n|Cipedak  |  3|J1 |J10 |J2 |J3 |J4 |J5 |J6 |J7 |J8 |J9 |\n|Gatot S. |  1|J1 |J10 |J2 |J3 |J4 |J5 |J6 |J7 |J8 |J9 |\n|Gatot S. |  2|J1 |J10 |J2 |J3 |J4 |J5 |J6 |J7 |J8 |J9 |\n|Gatot S. |  3|J1 |J10 |J2 |J3 |J4 |J5 |J6 |J7 |J8 |J9 |\n\n </td>\n  </tr>\n</tbody>\n</table>\n:::\n:::\n\n\nHal tersebut dapat juga dilakukan dengan alternatif pengacakan dua fase:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(cbind(bagan1$book,bagan2$sketch))\n```\n\n::: {.cell-output-display}\n| plots|  r|Lokasi   |1   |2  |3   |4  |5  |6   |7  |8   |9   |10 |\n|-----:|--:|:--------|:---|:--|:---|:--|:--|:---|:--|:---|:---|:--|\n|     1|  1|Cipedak  |J2  |J5 |J10 |J3 |J8 |J1  |J9 |J6  |J7  |J4 |\n|     2|  2|Cipedak  |J1  |J3 |J4  |J9 |J2 |J8  |J7 |J10 |J6  |J5 |\n|     3|  1|Gatot S. |J6  |J2 |J1  |J9 |J7 |J10 |J8 |J3  |J4  |J5 |\n|     4|  2|Gatot S. |J10 |J4 |J7  |J2 |J6 |J5  |J9 |J8  |J3  |J1 |\n|     5|  3|Cipedak  |J6  |J9 |J1  |J5 |J4 |J8  |J3 |J10 |J2  |J7 |\n|     6|  3|Gatot S. |J3  |J4 |J2  |J9 |J7 |J1  |J6 |J5  |J10 |J8 |\n:::\n:::\n\n\n#### Pengacakan edibble\n\nUntuk split plot RAL, dapat dibuat dua unit di `set_units()`. Pertama adalah petak utama, dan anak petak berupa unit yang `nested_in()` petak utama. Taraf lokasi diacak ke petak utama `(lokasi~mainplot)`, dan jenis ke anak petak `(jenis~unit)`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(edibble)\n\ndesSPRAL<-design(name=\"Lokasi dan Jenis vs. Penyerapan Debu\") %>%\n  set_units(mainplot=2,\n            unit=nested_in(mainplot, 10)) %>%\n  set_trts(lokasi=Lokasi,\n           jenis=Jenis) %>%\n  allot_trts(lokasi~mainplot,\n             jenis~unit) %>%\n  assign_trts(\"random\", seed=420) %>% serve_table\n\nknitr::kable(head(desSPRAL,n=10))\n```\n\n::: {.cell-output-display}\n|mainplot  |unit   |lokasi   |jenis |\n|:---------|:------|:--------|:-----|\n|mainplot1 |unit1  |Gatot S. |J6    |\n|mainplot1 |unit2  |Gatot S. |J8    |\n|mainplot1 |unit3  |Gatot S. |J1    |\n|mainplot1 |unit4  |Gatot S. |J10   |\n|mainplot1 |unit5  |Gatot S. |J3    |\n|mainplot1 |unit6  |Gatot S. |J7    |\n|mainplot1 |unit7  |Gatot S. |J9    |\n|mainplot1 |unit8  |Gatot S. |J2    |\n|mainplot1 |unit9  |Gatot S. |J4    |\n|mainplot1 |unit10 |Gatot S. |J5    |\n:::\n:::\n\n\nPlot dari rancangan tersebut dapat dilihat:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndeggust::autoplot(desSPRAL)\n```\n\n::: {.cell-output-display}\n![](06-Bab6_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nEdibble juga dapat membuat rancangan split plot secara *default*:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspd<-takeout(menu_split(t1 = 2, t2 = 10, r = 1, seed=420))\nexamine_recipe(spd)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndesign(\"Split-Plot Design | Split-Unit Design\") %>%\n  set_units(mainplot = 2,\n             subplot = nested_in(mainplot, 10)) %>%\n  set_trts(trt1 = 2,\n           trt2 = 10) %>%\n  allot_trts(trt1 ~ mainplot,\n             trt2 ~ subplot) %>%\n  assign_trts(\"random\", seed = 420) %>%\n  serve_table()\n```\n:::\n:::\n\n\nDapat dilihat bahwa cara pembuatan rancangan sama dengan yang dibuat sebelumnya. Plot juga sama:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndeggust::autoplot(spd)\n```\n\n::: {.cell-output-display}\n![](06-Bab6_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n### ANOVA\n\nModel linear aditif bagi split plot RAL adalah:\n\n\n$$\ny_{ijk} = \\mu + \\alpha_i + \\delta_{k(i)} + \\beta_j + (\\alpha\\beta)_{ij} + \\epsilon_{ijk}\n$$\n\n\nDengan:\n\n1. $y_{ijk}$ adalah nilai pengamatan pada faktor A taraf ke-i dan faktor B taraf ke-j pada ulangan ke-k.\n2. $\\mu$ komponen aditif dari rataan umum.\n3. $\\alpha_i$ pengaruh utama faktor A. Diasumsikan $\\sum_{i=1}^a \\alpha_i=0$ bagi model tetap dan $\\alpha\\sim N(0,\\sigma_a^2)$ bagi model acak.\n4. $\\beta_{j}$ pengaruh utama faktor B. Diasumsikan $\\sum_{j=1}^b \\beta_j=0$ bagi model tetap dan $\\beta\\sim N(0,\\sigma_b^2)$ bagi model acak.\n5. $(\\alpha\\beta)_{ij}$ komponen interaksi faktor A dan faktor B. Diasumsikan $\\sum_{i=1}^p\\sum_{i=1}^t (\\alpha\\beta)_{ij}=0$ bagi model tetap dan $(\\alpha\\beta)_{ij}\\sim N(0,\\sigma_{ab}^2)$ bagi model acak.\n6. $\\delta_{k(i)}\\sim N(0,\\sigma_{\\delta}^2)$ komponen acak dari petak utama.\n7. $\\epsilon_{ijk}\\sim N(0,\\sigma^2)$ komponen acak anak petak.\n\nDan hipotesis pengaruh petak utama, anak petak, dan interaksi.\n\n$$\n\\begin{aligned}\n&\\text{Pengaruh petak utama (Faktor A)}:\\\\\nH_{0}&:\\alpha_{1}=\\ldots=\\alpha_{a}=0\\\\\n&\\text{ faktor A tidak berpengaruh pada respon}\\\\\nH_{1}&: \\text{Paling sedikit ada satu i di mana }\\alpha_{i}\\neq 0\\\\\n\\\\\n&\\text{Pengaruh anak petak (Faktor B)}:\\\\\nH_{0}&:\\beta_{1}=\\ldots=\\beta_{b}=0\\\\\n&\\text{ faktor B tidak berpengaruh pada respon}\\\\\nH_{1}&: \\text{Paling sedikit ada satu j di mana }\\beta_{j}\\neq 0\\\\\n\\\\\n&\\text{Pengaruh interaksi }:\\\\\nH_{0}&:(\\alpha\\beta)_{11}=(\\alpha\\beta)_{12}=\\ldots=(\\alpha\\beta)_{ab}=0\\\\\n& \\text{ interaksi tidak berpengaruh pada respon}\\\\\nH_{1}&: \\text{Paling sedikit ada sepasang ij di mana }(\\alpha\\beta)_{ij}\\neq 0\\\\\n\\end{aligned}\n$$\n\n\nDan tabel ANOVA:\n\n\n\n  | Sumber Keragaman| db| JK| KT| F-hit|F(dbP,dbG)|\n  |------------:|-----------:|------------:|------------:|------------:|------------:|\n  |          A|         a-1|          JKA| JKA/dbA | KTA/KTGA | |\n  |          Galat (a)|         a(r-1)|          JKGA| JKGA/dbGA | | |\n  |          B|         (b-1)|         JKB| JKB/dbB | KTB/KTGB | |\n  |          AB|         (a-1)(b-1)|         JKAB| JKAB/dbAB | KTAB/KTGB | |\n  |          Galat (b)|       a(b-1)(r-1)|         JKGB| JKGB/dbGB | | |\n  |          Total|         abr-1|          JKT| | | |\n\n\nJumlah kuadrat tersebut dihitung dengan:\n\n$$\n\\begin{aligned}\nFK&=\\frac{y^2_{...}}{abr}\\\\\nJKT&=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k=1}^r\\left(y_{ijk}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k=1}^r y_{ijk}^2-FK\\\\\nJKST&=\\sum_{i=1}^a\\sum_{k=1}^r\\left(\\bar{y}_{i.K}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{k=1}^r \\frac{y_{i.k}^2}{b}-FK\\\\\nJKA&=\\sum_{i=1}^a\\left(\\bar{y}_{i..}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a \\frac{y_{i..}^2}{br}-FK\\\\\nJKG_{a}&=JKST-JKA\\\\\nJKB&=\\sum_{j=1}^b\\left(\\bar{y}_{.j.}-\\bar{y}_{...}\\right)^2=\\sum_{j=1}^b \\frac{y_{.j.}^2}{ar}-FK\\\\\nJKP&=\\sum_{i=1}^a\\sum_{j=1}^b\\left(\\bar{y}_{ij.}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{j=1}^b \\frac{y_{ij.}^2}{r}-FK\\\\\nJKAB&=\\sum_{i=1}^a\\sum_{j=1}^b\\left(\\bar{y}_{ij.}-\\bar{y}_{i..}-\\bar{y}_{.j.}+\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{j=1}^b\\left(\\bar{y}_{ij.}-\\bar{y}_{...}\\right)^2-JKA-JKB\\\\\n&=JKP-JKB-JKA\\\\\nJKG_{b}&=JKT-JKP-JKG_{a}\n\\end{aligned}\n$$\n\n\n### Analisis menggunakan R\n\nAkses data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(googlesheets4)\nSPlot<-read_sheet(\"https://docs.google.com/spreadsheets/d/1CL0DZ8Ub_sTvDcj-jy_UR3P3KKY1vptEz1SapQ_yMpY/edit?usp=sharing\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n! Using an auto-discovered, cached token.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n  To suppress this message, modify your code or options to clearly consent to\n  the use of a cached token.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n  See gargle's \"Non-interactive auth\" vignette for more details:\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n  <https://gargle.r-lib.org/articles/non-interactive-auth.html>\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nℹ The googlesheets4 package is using a cached token for\n  'muh.ammarsahab@apps.ipb.ac.id'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ Reading from \"SplitPlots\".\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ Range 'Sheet1'.\n```\n:::\n\n```{.r .cell-code}\nknitr::kable(head(SPlot),n=10)\n```\n\n::: {.cell-output-display}\n| No|Lokasi  |Jenis | Ulangan| Konsentrasi debu|\n|--:|:-------|:-----|-------:|----------------:|\n|  1|Cipedak |J1    |       1|           0.0312|\n|  2|Cipedak |J1    |       2|           0.0317|\n|  3|Cipedak |J1    |       3|           0.0321|\n|  4|Cipedak |J2    |       1|           0.0270|\n|  5|Cipedak |J2    |       2|           0.0272|\n|  6|Cipedak |J2    |       3|           0.0277|\n:::\n:::\n\n\nAkan dilakukan dua hal untuk membersihkan data. Pertama, satuan respon akan dikalikan 1000 karena satuan awalnya relatif kecil. Jika dikalikan 1000 jumlah kuadrat dan kuadrat tengah akan terlihat lebih jelas:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSPlot$`Konsentrasi debu`<-SPlot$`Konsentrasi debu`*1000\n```\n:::\n\n\nLalu, pastikan semua faktor telah menjadi... faktor:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSPlot$Ulangan<-as.factor(SPlot$Ulangan)\nSPlot$Jenis<-as.factor(SPlot$Jenis)\nSPlot$Lokasi<-as.factor(SPlot$Lokasi)\n```\n:::\n\n\nLakukan ANOVA. Seperti di percobaan faktorial, sintaks $a*b$ akan menghasilkan pengaruh faktor dan interaksi secara bersamaan. Oleh karena itu, tulis saja sintaks tersebut tanpa harus menspesifikasi pengaruh tiap faktor. Terdapat sintaks yang berbeda, yaitu di Error(Ulangan:Lokasi). Pada dasarnya sintaks ini memerintahkan R untuk menghitung ANOVA bagi plot utama. Dihitung $JKG_{Lokasi}$ dan pengaruh lokasi diuji menggunakan kuantitas tersebut. Tabel ANOVA akan terbagi dua menjadi Error: Ulangan:Lokasi - di plot utama, dan Error: Within - di dalam plot utama, dalam kata lain di anak petak. Pastikan ulangan sudah merupakan faktor (jika belum, derajat bebas akan beda).\n\n\n::: {.cell}\n\n```{.r .cell-code}\naovSPlot1<-aov(`Konsentrasi debu`~Lokasi*Jenis+Error(Ulangan:Lokasi),data=SPlot)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in aov(`Konsentrasi debu` ~ Lokasi * Jenis + Error(Ulangan:Lokasi), :\nError() model is singular\n```\n:::\n\n```{.r .cell-code}\nsummary(aovSPlot1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nError: Ulangan:Lokasi\n          Df Sum Sq Mean Sq F value   Pr(>F)    \nLokasi     1 105404  105404   45587 2.89e-09 ***\nResiduals  4      9       2                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nError: Within\n             Df Sum Sq Mean Sq F value Pr(>F)    \nJenis         9 160762   17862  343631 <2e-16 ***\nLokasi:Jenis  9  20732    2304   44314 <2e-16 ***\nResiduals    36      2       0                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nTerbentuk tabel ANOVA yang mirip dengan Excel, dengan kesimpulan sama yaitu tolak $H_{0}$ bagi tiap pengaruh. Ini berarti lokasi, jenis, dan interaksi lokasi dengan jenis berpengaruh pada respon. ANOVA Split Plot RAL dapat juga dianalisis melalui package `lme4`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lme4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: Matrix\n```\n:::\n\n```{.r .cell-code}\naovSPlot2<-lmer(`Konsentrasi debu`~Lokasi*Jenis+(1|Ulangan:Lokasi),data=SPlot)\nknitr::kable(anova(aovSPlot2))\n```\n\n::: {.cell-output-display}\n|             | npar|     Sum Sq|   Mean Sq|   F value|\n|:------------|----:|----------:|---------:|---------:|\n|Lokasi       |    1|   2369.655|  2369.655|  45586.53|\n|Jenis        |    9| 160762.103| 17862.456| 343631.14|\n|Lokasi:Jenis |    9|  20731.646|  2303.516|  44314.17|\n:::\n:::\n\n\nNilai F dari ANOVA tersebut sama dengan sebelumnya. Karena setidaknya salah satu pengaruh jenis dan lokasi beda dari nol, dapat dibuat kontras sebagai uji lanjut:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncontrasts(SPlot$Jenis)<-cbind(c(1, -4, 1, 1, 1, 1, 1, 1, 1,-4), c(0, 1, 0, 0, 0, 0, 0, 0, 0, -1),\n                              c(1, 0, 1, 1, 1, -1, -1, -1, -1, 0), c(1, 0, 1, -1, -1, 0, 0, 0, 0, 0),\n                              c(1, 0, -1, 0, 0, 0, 0, 0, 0, 0), c(0, 0, 0, 1, -1, 0, 0, 0, 0, 0),\n                              c(0, 0, 0, 0, 0, 1, 1, -1, -1, 0), c(0, 0, 0, 0, 0, 1, -1, 0, 0, 0),\n                              c(0, 0, 0, 0, 0, 0, 0, 1, -1, 0))\nsummary(aovSPlot1,split=list(Jenis=list(\"Jarum vs Lainnya\"=1, \"J9 vs J10\"=2, \"Kecil vs Lebar\"=3, \"Licin vs Kasar (kecil)\"=4,\n           \"J1 vs J2 (kecil licin)\"=5, \"J3 vs J4 (kecil kasar)\"=6, \"licin vs kasar (lebar)\"=7,\n           \"J5 vs J6 (lebar licin)\"=8, \"J7 vs J8 (lebar kasar)\"=9)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nError: Ulangan:Lokasi\n          Df Sum Sq Mean Sq F value   Pr(>F)    \nLokasi     1 105404  105404   45587 2.89e-09 ***\nResiduals  4      9       2                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nError: Within\n                                       Df Sum Sq Mean Sq F value Pr(>F)    \nJenis                                   9 160762   17862  343631 <2e-16 ***\n  Jenis: Jarum vs Lainnya               1  24359   24359  468603 <2e-16 ***\n  Jenis: J9 vs J10                      1  29839   29839  574023 <2e-16 ***\n  Jenis: Kecil vs Lebar                 1   1048    1048   20168 <2e-16 ***\n  Jenis: Licin vs Kasar (kecil)         1   8740    8740  168142 <2e-16 ***\n  Jenis: J1 vs J2 (kecil licin)         1  25855   25855  497393 <2e-16 ***\n  Jenis: J3 vs J4 (kecil kasar)         1  11248   11248  216388 <2e-16 ***\n  Jenis: licin vs kasar (lebar)         1   9842    9842  189338 <2e-16 ***\n  Jenis: J5 vs J6 (lebar licin)         1  11025   11025  212095 <2e-16 ***\n  Jenis: J7 vs J8 (lebar kasar)         1  38806   38806  746532 <2e-16 ***\nLokasi:Jenis                            9  20732    2304   44314 <2e-16 ***\n  Lokasi:Jenis: Jarum vs Lainnya        1   3456    3456   66495 <2e-16 ***\n  Lokasi:Jenis: J9 vs J10               1   3680    3680   70799 <2e-16 ***\n  Lokasi:Jenis: Kecil vs Lebar          1     84      84    1618 <2e-16 ***\n  Lokasi:Jenis: Licin vs Kasar (kecil)  1   1301    1301   25021 <2e-16 ***\n  Lokasi:Jenis: J1 vs J2 (kecil licin)  1   3374    3374   64907 <2e-16 ***\n  Lokasi:Jenis: J3 vs J4 (kecil kasar)  1   1325    1325   25496 <2e-16 ***\n  Lokasi:Jenis: licin vs kasar (lebar)  1   1606    1606   30887 <2e-16 ***\n  Lokasi:Jenis: J5 vs J6 (lebar licin)  1   1960    1960   37697 <2e-16 ***\n  Lokasi:Jenis: J7 vs J8 (lebar kasar)  1   3946    3946   75908 <2e-16 ***\nResiduals                              36      2       0                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nSemua kontras menolak $H_{0}$. Ini berarti jenis berbeda yang hendak dibandingkan benar-benar beda dalam hal konsentrasi debu. Lalu, dapat dibuat plot interaksi:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nggplot2::ggplot(aes(x = Jenis, y = `Konsentrasi debu`, group = Lokasi, colour = Lokasi), data = SPlot) + geom_line()+ theme_bw()\n```\n\n::: {.cell-output-display}\n![](06-Bab6_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\nDapat dilihat bahwa garis tak sepenuhnya sejajar walaupun tak pernah berpotongan. Misal, ada kenaikan konsentrasi debu yang lebih besar di Gatot Subroto daripada Cipedak antara jenis tanaman yang sama (misal J5 vs. J6). Untuk memastikan bahwa RAL tepat, dapat dibuat facet per ulangan yang memisahkan plot menjadi per ulangan:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot2::ggplot(aes(x = Jenis, y = `Konsentrasi debu`, group = Lokasi, colour = Lokasi), data = SPlot) + geom_line() + \n  facet_wrap(~ Ulangan) + theme_bw()\n```\n\n::: {.cell-output-display}\n![](06-Bab6_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\nTerlihat bahwa pola interaksi relatif sama antara ulangan, sehingga dapat dianggap bahwa unit percobaan benar-benar homogen.\n\n## Split Plot RAK\n\nKondisi unit percobaan split plot belum tentu homogen. Oleh karena itu, dapat digunakan Split Plot RAK untuk mengatasi pengaruh keragaman yang muncul dari satu arah. Pengelompokan menjadi blok dilakukan di petak utama, dengan pengacakan anak petak relatif sama. Dalam pembahasan Split Plot RAK, akan digunakan kasus oats:\n\n> Produksi oat dari sebuah percobaan split-plot menggunakan tiga varietas dan empat taraf penggunaaan nitrogen. Percobaan dilaksanakan di enam blok yang berisi tiga petak utama yang dibagi menjadi empat anak petak. Varietas diaplikasikan di petak utama dan pemumupukan nitrogen diaplikasikan ke anak petak.\n\nPeubah-peubah dalam dataset oats adalah:\n\n1. B: Blok, dengan taraf I, II, III, IV, V dan VI.\n2. V: Varietas, 3 taraf.\n3. N: Perlakuan pupuk nitrogen. Taraf $0.0cwt$, $0.2cwt$, $0.4cwt$, dan $0.6cwt$.\n4. Y: Produksi di $1/4$ pound per sub-plot. Tiap sub-plot sebesar $1/80$ acre.\n\nData tersebut ada dalam package `MASS`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(oats, package = \"MASS\")\nstr(oats)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t72 obs. of  4 variables:\n $ B: Factor w/ 6 levels \"I\",\"II\",\"III\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ V: Factor w/ 3 levels \"Golden.rain\",..: 3 3 3 3 1 1 1 1 2 2 ...\n $ N: Factor w/ 4 levels \"0.0cwt\",\"0.2cwt\",..: 1 2 3 4 1 2 3 4 1 2 ...\n $ Y: int  111 130 157 174 117 114 161 141 105 140 ...\n```\n:::\n:::\n\n\n### Pengacakan\n\nPertama, ambil taraf-taraf dari varietas dan konsentrasi pupuk nitrogen:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nV<-levels(oats$V)\nN<-levels(oats$N)\n```\n:::\n\n\nPengacakan secara cepat dapat dilakukan dengan menggunakan design.split dari library agricolae. Dalam kasus ini, design berupa RCBD (randomized complete block design) jika menggunakan split plot RAK. Argumen fungsi diurutkan sebagai berikut karena varietas merupakan petak utama, nitrogen anak petak, dan ada tiga blok.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(agricolae)\n\nbagan2<-design.split(V, N,r=6, design=\"rcbd\",serie = 0,\n                     seed = 0, kinds = \"Super-Duper\",\n                     first=TRUE,randomization=TRUE) \n        #(utama, anak, ulangan)\nknitr::kable(head(bagan2$book),n=10)\n```\n\n::: {.cell-output-display}\n| plots|splots |block |V           |N      |\n|-----:|:------|:-----|:-----------|:------|\n|     1|1      |1     |Golden.rain |0.2cwt |\n|     1|2      |1     |Golden.rain |0.0cwt |\n|     1|3      |1     |Golden.rain |0.4cwt |\n|     1|4      |1     |Golden.rain |0.6cwt |\n|     2|1      |1     |Marvellous  |0.4cwt |\n|     2|2      |1     |Marvellous  |0.2cwt |\n:::\n\n```{.r .cell-code}\nnrow(bagan2$book)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 72\n```\n:::\n\n```{.r .cell-code}\nnrow(oats)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 72\n```\n:::\n:::\n\n\nJumlah baris di bagan sama dengan jumlah baris di data oats, yaitu $3\\times 4\\times 6=72$. Mirip dengan Split Plot RAL, pengacakan dapat dilakukan dengan algoritma:\n\n1. Pengacakan RAKL untuk plot utama.\n2. RAKL dengan $A\\times r$ blok, dengan $B$ unit percobaan di blok tersebut.\n\n$A$ adalah jumlah taraf faktor di plot utama dan $B$ adalah jumlah taraf faktor di anak petak.\n\n#### Pengacakan edibble\n\nUntuk split plot RAKL, dapat dibuat tiga unit di `set_units()`. Pertama adalah blok, lalu petak utama yang `nested_in(blok)`, dan anak petak yang `nested_in()` petak utama. Taraf varietas diacak ke petak utama `(V~mainplot)`, dan nitrogen ke anak petak `(jenis~subplot)`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(edibble)\n\ndesSPRAKL<-design(name=\"Oats\") %>%\n  set_units(blok=6,\n            mainplot=nested_in(blok,3),\n            subplot=nested_in(mainplot, 4)) %>%\n  set_trts(nitrogen=N,\n           varietas=V) %>%\n  allot_trts(varietas~mainplot,\n             nitrogen~subplot) %>%\n  assign_trts(\"random\", seed=420) %>% serve_table\n\nknitr::kable(head(desSPRAKL,n=10))\n```\n\n::: {.cell-output-display}\n|blok  |mainplot  |subplot   |nitrogen |varietas    |\n|:-----|:---------|:---------|:--------|:-----------|\n|blok1 |mainplot1 |subplot1  |0.0cwt   |Golden.rain |\n|blok1 |mainplot1 |subplot2  |0.6cwt   |Golden.rain |\n|blok1 |mainplot1 |subplot3  |0.2cwt   |Golden.rain |\n|blok1 |mainplot1 |subplot4  |0.4cwt   |Golden.rain |\n|blok1 |mainplot2 |subplot5  |0.2cwt   |Marvellous  |\n|blok1 |mainplot2 |subplot6  |0.6cwt   |Marvellous  |\n|blok1 |mainplot2 |subplot7  |0.0cwt   |Marvellous  |\n|blok1 |mainplot2 |subplot8  |0.4cwt   |Marvellous  |\n|blok1 |mainplot3 |subplot9  |0.4cwt   |Victory     |\n|blok1 |mainplot3 |subplot10 |0.2cwt   |Victory     |\n:::\n:::\n\n\nPlot dari rancangan tersebut dapat dilihat:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndeggust::autoplot(desSPRAKL)\n```\n\n::: {.cell-output-display}\n![](06-Bab6_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\nAgar plot tersebut terlihat lebih rapih, dapat digunakan `facet_wrap()` untuk memisahkan plot tersebut per blok atau per plot utama:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndeggust::autoplot(desSPRAKL)+facet_wrap(~blok)\n```\n\n::: {.cell-output-display}\n![](06-Bab6_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndeggust::autoplot(desSPRAKL)+facet_wrap(~mainplot)\n```\n\n::: {.cell-output-display}\n![](06-Bab6_files/figure-html/unnamed-chunk-26-2.png){width=672}\n:::\n:::\n\n\n### ANOVA\n\nModel linear aditif bagi split plot RAL adalah:\n\n$$\ny_{ijk} = \\mu + \\alpha_i + K_{k}+ \\delta_{k(i)} + \\beta_j + (\\alpha\\beta)_{ij} + \\epsilon_{ijk}\n$$\n\n\nDengan:\n\n1. $y_{ijk}$ adalah nilai pengamatan pada faktor A taraf ke-i dan faktor B taraf ke-j pada blok ke-k.\n2. $\\mu$ komponen aditif dari rataan umum.\n3. $\\alpha_i$ pengaruh utama faktor A. Diasumsikan $\\sum_{i=1}^a \\alpha_i=0$ bagi model tetap dan $\\alpha\\sim N(0,\\sigma_a^2)$ bagi model acak.\n4. $\\beta_{j}$ pengaruh utama faktor B. Diasumsikan $\\sum_{j=1}^b \\beta_j=0$ bagi model tetap dan $\\beta\\sim N(0,\\sigma_b^2)$ bagi model acak.\n5. $K_{k}$ pengaruh utama kelompok.\n6. $(\\alpha\\beta)_{ij}$ komponen interaksi faktor A dan faktor B. Diasumsikan $\\sum_{i=1}^p\\sum_{i=1}^t (\\alpha\\beta)_{ij}=0$ bagi model tetap dan $(\\alpha\\beta)_{ij}\\sim N(0,\\sigma_{ab}^2)$ bagi model acak.\n7. $\\delta_{k(i)}\\sim N(0,\\sigma_{\\delta}^2)$ komponen acak dari petak utama.\n8. $\\epsilon_{ijk}\\sim N(0,\\sigma^2)$ komponen acak anak petak.\n\nDan hipotesis pengaruh petak utama, anak petak, dan interaksi.\n\n$$\n\\begin{aligned}\n&\\text{Pengaruh petak utama (Faktor A)}:\\\\\nH_{0}&:\\alpha_{1}=\\ldots=\\alpha_{a}=0\\\\\n&\\text{ faktor A tidak berpengaruh pada respon}\\\\\nH_{1}&: \\text{Paling sedikit ada satu i di mana }\\alpha_{i}\\neq 0\\\\\n\\\\\n&\\text{Pengaruh anak petak (Faktor B)}:\\\\\nH_{0}&:\\beta_{1}=\\ldots=\\beta_{b}=0\\\\\n&\\text{ faktor B tidak berpengaruh pada respon}\\\\\nH_{1}&: \\text{Paling sedikit ada satu j di mana }\\beta_{j}\\neq 0\\\\\n\\\\\n&\\text{Pengaruh interaksi }:\\\\\nH_{0}&:(\\alpha\\beta)_{11}=(\\alpha\\beta)_{12}=\\ldots=(\\alpha\\beta)_{ab}=0\\\\\n&\\text{ interaksi tidak berpengaruh pada respon}\\\\\nH_{1}&: \\text{Paling sedikit ada sepasang ij di mana }(\\alpha\\beta)_{ij}\\neq 0\\\\\n\\\\\n&\\text{Pengaruh kelompok}:\\\\\nH_{0}&:K_{1}=\\ldots=K_{k}=0\\\\\n&\\text{ Kelompok tidak berpengaruh pada respon}\\\\\nH_{1}&: \\text{Paling sedikit ada satu k di mana }K_{k}\\neq 0\\\\\n\n\\end{aligned}\n$$\n\n\nDan tabel ANOVA:\n\n\n\n  | Sumber Keragaman| db| JK| KT| F-hit|F(dbP,dbG)|\n  |------------:|-----------:|------------:|------------:|------------:|------------:|\n  |          Blok|         r-1|          JKK| JKK/dbA | KTK/KTGA | |\n  |          A|         a-1|          JKA| JKA/dbA | KTA/KTGA | |\n  |          Galat (a)|         (a-1)(r-1)|          JKGA| JKGA/dbGA | | |\n  |          B|         (b-1)|         JKB| JKB/dbB | KTB/KTGB | |\n  |          AB|         (a-1)(b-1)|         JKAB| JKAB/dbAB | KTAB/KTGB | |\n  |          Galat (b)|       (a-1)(b-1)(r-1)|         JKGB| JKGB/dbGB | | |\n  |          Total|         abr-1|          JKT| | | |\n\n\nJumlah kuadrat tersebut dihitung dengan:\n\n$$\n\\begin{aligned}\nFK&=\\frac{y^2_{...}}{abr}\\\\\nJKT&=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k=1}^r\\left(y_{ijk}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k=1}^r y_{ijk}^2-FK\\\\\nJKST&=\\sum_{i=1}^a\\sum_{k=1}^r\\left(\\bar{y}_{i.k}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{k=1}^r \\frac{y_{i.k}^2}{b}-FK\\\\\nJKA&=\\sum_{i=1}^a\\left(\\bar{y}_{i..}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a \\frac{y_{i..}^2}{br}-FK\\\\\nJKK&=\\sum_{k=1}^r \\left(\\bar{y}_{..k}-\\bar{y}_{...}\\right)^2=\\sum_{k=1}^r \\frac{y_{..k}^2}{ab}-FK\\\\\nJKG_{a}&=JKST-JKA-JKK\\\\\nJKB&=\\sum_{j=1}^b\\left(\\bar{y}_{.j.}-\\bar{y}_{...}\\right)^2=\\sum_{j=1}^b \\frac{y_{.j.}^2}{ar}-FK\\\\\nJKP&=\\sum_{i=1}^a\\sum_{j=1}^b\\left(\\bar{y}_{ij.}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{j=1}^b \\frac{y_{ij.}^2}{r}-FK\\\\\nJKAB&=\\sum_{i=1}^a\\sum_{j=1}^b\\left(\\bar{y}_{ij.}-\\bar{y}_{i..}-\\bar{y}_{.j.}+\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{j=1}^b\\left(\\bar{y}_{ij.}-\\bar{y}_{...}\\right)^2-JKA-JKB\\\\\n&=JKP-JKB-JKA\\\\\nJKG_{b}&=JKT-JKP-JKG_{a}\n\\end{aligned}\n$$\n\n\n### Analisis menggunakan R\n\nSama seperti Split Plot RAL, perlu ditambah sintaks `Error(Blok:Utama)` di `aov`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\naovSPlotRAK1<-aov(Y~V*N+B+Error(B:V),data=oats)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in aov(Y ~ V * N + B + Error(B:V), data = oats): Error() model is\nsingular\n```\n:::\n\n```{.r .cell-code}\nsummary(aovSPlotRAK1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nError: B:V\n          Df Sum Sq Mean Sq F value Pr(>F)  \nV          2   1786     893   1.485 0.2724  \nB          5  15875    3175   5.280 0.0124 *\nResiduals 10   6013     601                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nError: Within\n          Df Sum Sq Mean Sq F value   Pr(>F)    \nN          3  20020    6673  37.686 2.46e-12 ***\nV:N        6    322      54   0.303    0.932    \nResiduals 45   7969     177                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nDapat juga digunakan `lme4`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lme4)\nfit.oats <- lmer(Y ~ B + V * N + (1 | B:V), data = oats)\nknitr::kable(anova(fit.oats))\n```\n\n::: {.cell-output-display}\n|    | npar|     Sum Sq|   Mean Sq|    F value|\n|:---|----:|----------:|---------:|----------:|\n|B   |    5|  4675.0427|  935.0085|  5.2800486|\n|V   |    2|   526.0578|  263.0289|  1.4853399|\n|N   |    3| 20020.5000| 6673.5000| 37.6856497|\n|V:N |    6|   321.7500|   53.6250|  0.3028236|\n:::\n:::\n\n\nNilai F dan derajat bebas dari kedua tabel ANOVA sama, tetapi jumlah kuadrat berbeda. Fungsi `sp.plot` dari library `agricolae` juga dapat digunakan untuk menghitung tabel ANOVA tersebut. Sintaks metode tersebut adalah `with(data, sp.plot(blok, petak utama, anak petak, Y))`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(oats,sp.plot(block=B, pplot=V, splot=N, Y=Y))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nANALYSIS SPLIT PLOT:  Y \nClass level information\n\nV \t:  Victory Golden.rain Marvellous \nN \t:  0.0cwt 0.2cwt 0.4cwt 0.6cwt \nB \t:  I II III IV V VI \n\nNumber of observations:  72 \n\nAnalysis of Variance Table\n\nResponse: Y\n    Df  Sum Sq Mean Sq F value    Pr(>F)    \nB    5 15875.3  3175.1     NaN       NaN    \nV    2  1786.4   893.2  1.4853    0.2724    \nEa  10  6013.3   601.3     NaN       NaN    \nN    3 20020.5  6673.5 37.6856 2.458e-12 ***\nV:N  6   321.8    53.6  0.3028    0.9322    \nEb  45  7968.7   177.1     NaN       NaN    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\ncv(a) = 23.6 %, cv(b) = 12.8 %, Mean = 103.9722 \n```\n:::\n:::\n\n\nJumlah kuadrat dan kuadrat tengah galat sama, tetapi metode tersebut tidak dapat menguji pengaruh blok.\n\nKarena setidaknya salah satu pengaruh konsentrasi pupuk nitrogen beda dari nol dan taraf faktor tersebut kuantitatif dengan jarak sama, dapat digunakan polinomial orthogonal sebagai uji lanjut. Polinomial orthogonal dapat dimasukkan dengan manual atau dengan `contr.poly`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#contr.poly:\ncontrasts(oats$N)<-contr.poly(levels(oats$N))\naovSPlotRAK1<-aov(Y~V*N+B+Error(B:V),data=oats)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in aov(Y ~ V * N + B + Error(B:V), data = oats): Error() model is\nsingular\n```\n:::\n\n```{.r .cell-code}\nsummary(aovSPlotRAK1,split=list(N=list(\"Linear\"=1, \"Kuadratik\"=2,\n                                    \"Kubik\"=3)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nError: B:V\n          Df Sum Sq Mean Sq F value Pr(>F)  \nV          2   1786     893   1.485 0.2724  \nB          5  15875    3175   5.280 0.0124 *\nResiduals 10   6013     601                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nError: Within\n                 Df Sum Sq Mean Sq F value   Pr(>F)    \nN                 3  20020    6674  37.686 2.46e-12 ***\n  N: Linear       1  19536   19536 110.323 1.09e-13 ***\n  N: Kuadratik    1    480     480   2.713    0.106    \n  N: Kubik        1      4       4   0.020    0.887    \nV:N               6    322      54   0.303    0.932    \n  V:N: Linear     2    168      84   0.475    0.625    \n  V:N: Kuadratik  2     11       6   0.031    0.969    \n  V:N: Kubik      2    142      71   0.402    0.671    \nResiduals        45   7969     177                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nTerlihat bahwa pengaruh konsentrasi pupuk nitrogen linear setelah diuji melalui polinomial orthogonal.\n\n## Latihan Soal\n\n1. Petani John. Sumber: ANOVA and Mixed Models: A Short Intro Using R (Lukas Meier, 2018)\n\nPetani John memiliki delapan petal tanah yang berbeda. Dia mengacak dan menerapkan dua \"skema\" pemupukan (\"kontrol\" dan \"baru\") dengan cara yang seimbang ke delapan plot. Selain itu, setiap plot dibagi menjadi empat subplot. Di setiap plot, empat varietas stroberi yang berbeda diacak ke subplot. John tertarik pada efek skema pemupukan dan varietas stroberi pada massa buah. Per subplot, ia mencatat massa buah setelah jangka waktu tertentu. Buat bagan percobaan dan analisis datanya!\n\nData dapat diakses dengan sintaks R berikut:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbook.url <- \"http://stat.ethz.ch/~meier/teaching/book-anova\"\njohn <- readRDS(url(file.path(book.url, \"data/john.rds\")))\nsummary(john)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      plot     fertilizer variety      mass      \n 1      :4   control:16   A:8     Min.   : 7.70  \n 2      :4   new    :16   B:8     1st Qu.:11.57  \n 3      :4                C:8     Median :14.30  \n 4      :4                D:8     Mean   :13.94  \n 5      :4                        3rd Qu.:16.75  \n 6      :4                        Max.   :20.60  \n (Other):8                                       \n```\n:::\n:::\n\n\n2. [Benih](https://docs.google.com/spreadsheets/d/1ZyhrLc3NhN1I-7DEoM4gi9Jf0Qfpk9v4jIDYJVgmVCM/edit?usp=sharing)\n\nDalam suatu percobaan tanaman, seorang petani menggunakan percobaan 2 faktor untuk melihat bagaimana kedua faktor tersebut mempunyai pengaruh terhadap pertumbuhan serta hasil tanaman, Untuk faktor pertama petani menggunakan (Takaran pupuk kandang: K1, K2, K3) diletakkan sebagai petak utama, sedangkan untuk faktor kedua (Jumlah benih per lubang: J1, J2, J3) dianggap sebagai anak petak. Setiap perlakuan diulang sebanyak 3 kali, dan unit-unit percobaan diasumsikan homogen.\n\nBuat bagan dan analisis datanya!\n\n3. Buat plot interaksi untuk data oats! Pisahkan plot tersebut menjadi *facet* untuk tiap blok.",
    "supporting": [
      "06-Bab6_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}