{
  "hash": "cc8812b6d6e89b5852f232464c72963d",
  "result": {
    "markdown": "# Percobaan Faktor Tunggal\nBab ini akan membahas percobaan faktor tunggal dalam RAL, RAK, dan RBSL. Oleh karena itu, **keragaman yang disebabkan perlakuan merupakan level-level dari satu faktor** tertentu saja. Kita akan memulai dengan menjelaskan rancangan-rancangan pengendalian lingkungan secara garis besar. Inti dari bab ini adalah penjelasan dan implementasi tiap rancangan. Di akhir bab, akan ada pengayaan berupa rancangan Greko-Latin dan *Balanced Incomplete Block Designs*.\n\n## Pengendalian lingkungan secara garis besar\nDalam meneliti efek suatu peubah pada peubah lainnya, sering muncul sumber keragaman lain - kita dapat sebut hal ini sebagai faktor **penganggu**. Ada beberapa faktor penganggu yang kita tidak dapat observasi dan tidak dapat kendalikan. Dampak faktor-faktor tersebut diatasi oleh pengacakan. Ada beberapa faktor penganggu yang dapat diobservasi, tapi tidak dapat dikendalikan. ANCOVA, yang akan dipelajari di sesi UAS, mengatasi masalah tersebut. Terakhir, penganggu yang dapat dikendalikan diatasi dengan rancangan pengendalian lingkungan (*local control*).\n\n### RAL: unit percobaan homogen\nRancangan Acak Lengkap digunakan jika semua satuan percoban homogen. Karena tidak ada sumber keragaman, perlakuan diacak langsung ke unit percobaan.\n\n### Rancangan yang melakukan pengendalian lingkungan\nJika satuan percobaan heterogen, ada beberapa rancangan yang dapat mengendalikan faktor penganggu tersebut. Rancangan yang dipakai tergantung **jumlah arah keragaman**, yang sama saja dengan **jumlah faktor penganggu yang dapat dikontrol**. Misal, dua arah keragaman berarti ada dua faktor penganggu yang dapat dikendalikan. Rancangan-rancangan tersebut adalah:\n\n- Rancangan Acak Kelompok Lengkap (RAKL) - **keragaman satu arah**\n    - Perlakuan diacak di tiap kelompok\n    - Syarat: setiap perlakuan muncul sekali dalam setiap kelompok\n- Rancangan Bujur Sangkar Latin (RBSL) - **keragaman dua arah**\n    - Pengelompokan per baris dan kolom\n    - Syarat: setiap perlakuan hanya muncul sekali pada arah baris dan hanya muncul sekali pada arah kolom\n- Rancangan Greko Latin - **keragaman tiga arah**\n    - Dua Bujur Sangkar Latin digabung: bujur sangkar pertama memiliki perlakuan berhuruf Latin, bujur sangkar kedua memiliki huruf Yunani\n    - Syarat: tiap huruf Yunani hanya muncul sekali bersama dengan tiap huruf Latin.\n- Rancangan lain yang lebih kompleks, tetapi rancangan tersebut di luar cakupan mata kuliah ini.\n\n## RAL \nSetelah melihat penurunan ANOVA untuk Rancangan Acak Lengkap, atau dapat disebut Rancangan Teracak Lengkap (RTL), atau *Completely Randomized Design* (CRD). Karakteristik RAL (selain karakteristik umum percobaan faktor tunggal di awal bab) adalah:\n\n1. Kondisi unit percobaan yang digunakan relatif homogen\n2. Karena unit percobaan harus homogen, umumnya percobaan dilakukan di laboratorium atau lingkungan yang dapat dikendalikan\n3. Karena lingkungan percobaan terbatas, unit percobaan tidak cukup besar dan jumlah perlakuan terbatas\n\nDari karakteristik tersebut, kelebihan dalam menggunakan RAL adalah sebagai berikut:\n\n1. Analisis yang digunakan sederhana karena hanya dihitung pengaruh satu faktor\n2. Bagan rancangan percobaan lebih mudah karena pengacakan langsung dilakukan ke unit percobaan\n3. Banyaknya ulangan bisa berbeda antar perlakuan\n4. Banyaknya perlakuan dan ulangan hanya dibatasi oleh banyaknya unit percobaan yang tersedia\n\nNamun, RAL juga memiliki beberapa kekurangan, antara lain:\n\n1. Informasi karena data yang hilang relatif kecil dibanding rancangan lainnya\n2. Jika ada faktor penganggu, sering kali kurang efisien karena pengacakan tidak dibatasi\n3. Jika jumlah ulangan sedikit dan unit percobaan tidak benar-benar homogen, pengulangan akan tidak konsisten\n4. Galat percobaan mencakup seluruh keragaman antar unit percobaan kecuali yang disebabkan oleh perlakuan\n\nKekurangan tersebut menunjukkan kelemahan asumsi unit percobaan relatif homogen di RAL. Sesuai (2) dan (4), galat percobaan menjadi lebih besar jika ada sumber keragaman antar unit percobaan yang tidak disebabkan perlakuan. Walaupun keragaman itu dapat diatasi oleh pengulangan, dibutuhkan beberapa ulangan untuk mengatasi keragaman.\n\n### Pengacakan\n\nPenerapan perlakuan pada unit percobaan RAL dilakukan secara acak lengkap terhadap seluruh unit percobaan. Setiap perlakuan mempunyai peluang yang sama besar untuk diterapkan di tiap unit percobaan. Pengacakan dapat dilakukan dengan bantuan sistem lotere/undian, tabel bilangan acak, kalkulator, atau *software* komputer. Tiap pengacakan akan memiliki hasil berbeda. Salah satu cara pengacakan di software komputer (misal Excel) dapat dilakukan adalah sebagai berikut:\n\n1. Semua perlakuan disusun secara sistematik (semuanya terurut - r baris pertama adalah r ulangan perlakuan 1, dan seterusnya.)\n2. Berikan label nomor 1 sampai n (banyaknya unit percobaan)\n3. Bangkitkan bilangan acak sebanyak n, bisa menggunakan fungsi =RAND() di Excel\n4. Urutkan perlakuan berdasarkan bilangan acaknya dari terbesar ke terkecil\n\nPengacakan menggunakan software R akan digambarkan melalui studi kasus tersebut:\n\n> Suatu Lembaga Penelitian Padi melakukan percobaan untuk mengetahui pengaruh penggunaan berbagai pestisida cair terhadap produksi padi. Percobaan dilakukan pada satu hamparan sawah yang mempunyai tingkat kesuburan atau kandungan bahan organik yang relatif sama. Masing-masing perlakuan diberikan pada lahan seluas 4 x 5 $\\text{m}^2$. Perlakuan yang dicobakan ada 7, yaitu Dol-Mix (1 kg), Dol-Mix (2 kg), DDT + $\\gamma-$BHC, Azodrin, Dimecron-Boom, Dimecron-Knap, dan tanpa pestisida (sebagai kontrol), masing-masing diulang 4 kali. Respon yang diukur adalah produksi gabah per kg/ha. Hasil dari setiap petakan dikonversi ke dalam kg/ha.\n>\n> --- Mattjik dan Sumertajaya (2002)\n\nTotal perlakuan adalah 28. Akan digunakan fungsi design.crd dari library agricolae di R. Lihat dulu argumen-argumen fungsi tersebut:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(agricolae)\n#cek fungsi design.\nstr(design.crd)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nfunction (trt, r, serie = 2, seed = 0, kinds = \"Super-Duper\", randomization = TRUE)  \n```\n:::\n:::\n\n\nArgumen trt akan diisi perlakuan, r akan diisi ulangan. Randomization pasti TRUE karena kita ingin pengacakan dilakukan. Serie merupakan argumen yang berkaitan dengan skema penomoran unit percobaan - jika serie=2, penomoran mulai dari 101. Kita memilih seed=0 agar penomoran berurutan logis (mulai dari 0). Lalu, kita lakukan pengacakan dengan fungsi tersebut:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#masukkan perlakuan\nperlakuan<-c(\"DolMix1\",\"DolMix2\",\"DDT\",\"Azodrin\",\"DimecronB\",\"DimecronK\",\"Kontrol\")\n\n#buat bagan\nbaganRAL<-design.crd(trt=perlakuan,r=4,seed=16,serie=0)\n\n#akses output -> hasil design.crd$book\nknitr::kable(head(baganRAL$book,n=10))\n```\n\n::: {.cell-output-display}\n| plots|  r|perlakuan |\n|-----:|--:|:---------|\n|     1|  1|Kontrol   |\n|     2|  1|DimecronB |\n|     3|  2|Kontrol   |\n|     4|  1|DimecronK |\n|     5|  2|DimecronK |\n|     6|  1|DDT       |\n|     7|  2|DimecronB |\n|     8|  3|DimecronB |\n|     9|  1|DolMix2   |\n|    10|  2|DolMix2   |\n:::\n:::\n\n\nHanya ditunjukkan 10 unit percobaan pertama agar tabel tidak terlalu panjang, tetapi jumlah tersebut seharusnya sudah dapat menggambarkan hasil pengacakan bagan percobaan RAL.\n\n#### Pengacakan - edibble\n\nPercobaan juga dapat dirancang dengan package edibble. Package ini memudahkan pengguna untuk membuat suatu bagan dari suatu konteks (misal, sebuah cerita), dan memudahkan pengguna mengetahui konteks dari suatu rancangan. Untuk install package tersebut, install package simulate terlebih dahulu.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nremotes::install_github(\"emitanaka/simulate\")\n```\n:::\n\n\nLalu install package edibble, dan install deggust untuk membantu visualiasi bagan percobaan:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"edibble\")\nremotes::install_github(\"emitanaka/deggust\")\n```\n:::\n\n\nMisal, lihat kembali soal cerita:\n\n> Suatu Lembaga Penelitian Padi melakukan percobaan untuk mengetahui pengaruh penggunaan berbagai pestisida cair terhadap produksi padi. Percobaan dilakukan pada satu hamparan sawah yang mempunyai tingkat kesuburan atau kandungan bahan organik yang relatif sama. Masing-masing perlakuan diberikan pada lahan seluas 4 x 5 $\\text{m}^2$. Perlakuan yang dicobakan ada 7, yaitu Dol-Mix (1 kg), Dol-Mix (2 kg), DDT + $\\gamma-$BHC, Azodrin, Dimecron-Boom, Dimecron-Knap, dan tanpa pestisida (sebagai kontrol), masing-masing diulang 4 kali. Respon yang diukur adalah produksi gabah per kg/ha. Hasil dari setiap petakan dikonversi ke dalam kg/ha.\n>\n> --- Mattjik dan Sumertajaya (2002)\n\nPembangunan suatu rancangan percobaan akan diawali dengan `design`. Dalam fungsi `design` ada argumen `name` yang berisi nama percobaan yang ingin dilakukan. Oleh karena itu, awali dengan menulis `design(name=\"nama percobaan\")`. Lalu, logika operasi edibble menggunakan operator pipa. Hasil dari operasi sebelumnya dilanjutkan ke operasi setelahnya. Untuk membuat unit percobaan, tuliskan `set_unit`. Ada $7\\cdot 4=28$ unit percobaan berupa sawah, sehingga tulis `set_unit(sawah=28)`. Lalu lanjutkan dengan membuat perlakuan, dengan fungsi `set_trts`. Perlakuan merupakan level dari satu taraf, yaitu pestisida. Level tersebut telah dimasukkan ke vektor perlakuan sebelumnya, jadi tulis `set_trts(pestisida=perlakuan)`.\n\nLalu, alokasikan perlakuan ke unit. Gunakan fungsi `allot_trts(perlakuan ~ unit)` sehingga tuliskan `allot_trts(pestisida~sawah)`. Tentu perlakuan diberikan secara acak sehingga tulis `assign_trts(\"random\")`. Gunakan fungsi `serve_table` untuk melihat bagan percobaan:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(edibble)\n\ndesRAL<-design(name=\"Pengaruh pestisida cair pada produksi padi\") %>%\n  set_units(sawah=28) %>%\n  set_trts(pestisida=perlakuan) %>%\n  allot_trts(pestisida ~ sawah) %>%\n  assign_trts(\"random\", seed=420) %>% serve_table\n\nknitr::kable(head(desRAL,n=10))\n```\n\n::: {.cell-output-display}\n|sawah   |pestisida |\n|:-------|:---------|\n|sawah1  |Kontrol   |\n|sawah2  |DolMix1   |\n|sawah3  |DimecronB |\n|sawah4  |Kontrol   |\n|sawah5  |Azodrin   |\n|sawah6  |DimecronB |\n|sawah7  |Azodrin   |\n|sawah8  |DimecronB |\n|sawah9  |DolMix2   |\n|sawah10 |DimecronK |\n:::\n:::\n\n\nLalu, plot dengan library deggust:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndeggust::autoplot(desRAL)\n```\n\n::: {.cell-output-display}\n![](02-Bab2_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nTerlihat bahwa tiap perlakuan mendapat 4 unit percobaan. Umumnya, RAL dengan 7 perlakuan dan 28 ulangan dapat dibuat dengan fungsi `takeout`. Ambil `menu_crd`, dengan `t=7, n=28`. Lalu, lakukan `examine_recipe` untuk melihat cara membangun RAL tersebut\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncrd <- takeout(menu_crd(t = 7, n=28, seed = 420), )\nexamine_recipe(crd)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndesign(\"Completely Randomised Design\") %>%\n  set_units(unit = 28) %>%\n  set_trts(trt = 7) %>%\n  allot_trts(trt ~ unit) %>%\n  assign_trts(\"random\", seed = 420) %>%\n  serve_table()\n```\n:::\n:::\n\n\nCara pembangunannya sama, begitu juga untuk plot:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndeggust::autoplot(crd)\n```\n\n::: {.cell-output-display}\n![](02-Bab2_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nPeneliti juga dapat menuliskan respon yang diinginkan dengan fungsi `set_rcrds`. Perlu dituliskan unit pengamatan respon tersebut, dengan sintaks `set_rcrds(respon = unit)`. Dalam kasus ini tentu diamati hasil produksi dari tiap petakan sawah:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndesRAL %>% set_rcrds(produksi = sawah)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Pengaruh pestisida cair pada produksi padi \n# An edibble: 28 x 3\n        sawah pestisida produksi\n   <unit(28)>  <trt(7)>   <rcrd>\n 1    sawah1  Kontrol          o\n 2    sawah2  DolMix1          o\n 3    sawah3  DimecronB        o\n 4    sawah4  Kontrol          o\n 5    sawah5  Azodrin          o\n 6    sawah6  DimecronB        o\n 7    sawah7  Azodrin          o\n 8    sawah8  DimecronB        o\n 9    sawah9  DolMix2          o\n10    sawah10 DimecronK        o\n# … with 18 more rows\n# ℹ Use `print(n = ...)` to see more rows\n```\n:::\n:::\n\n\nLalu, record tersebut dapat diberi batasan nilainya. Misal, tidak mungkin produksi negatif, dengan fungsi `expect_rcrds(kondisi respon)`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndesRAL %>% set_rcrds(produksi = sawah) %>%  expect_rcrds(produksi >= 0)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Pengaruh pestisida cair pada produksi padi \n# An edibble: 28 x 3\n        sawah pestisida produksi\n   <unit(28)>  <trt(7)>   <rcrd>\n 1    sawah1  Kontrol          o\n 2    sawah2  DolMix1          o\n 3    sawah3  DimecronB        o\n 4    sawah4  Kontrol          o\n 5    sawah5  Azodrin          o\n 6    sawah6  DimecronB        o\n 7    sawah7  Azodrin          o\n 8    sawah8  DimecronB        o\n 9    sawah9  DolMix2          o\n10    sawah10 DimecronK        o\n# … with 18 more rows\n# ℹ Use `print(n = ...)` to see more rows\n```\n:::\n:::\n\n\nIni dapat membantu tabulasi data. Jika ada data yang di luar ekspektasi setelah dicatat, unit percobaan tersebut dapat diteliti kembali.\n\n### Model\n\nSetelah memberikan perlakuan-perlakuan kepada unit percobaan, dibutuhkan model untuk menduga pengaruh perlakuan-perlakuan tersebut. Model untuk RAL adalah sebagai berikut:\n\n\n$$\n\\begin{equation}\ny_{ij}=\\mu+\\tau_{i}+\\varepsilon_{ij}\n\\begin{cases}\ni=1,2,...,t\\\\\nj=1,2,...,r\n\\end{cases}\n\\end{equation}\n$$\n\nDalam model ini, $y_{ij}$ adalah observasi peubah respon di perlakuan (t) ke-i dan ulangan (r) ke-j. Diasumsikan bahwa $\\mu$ adalah rata-rata umum nilai peubah respon. $\\tau_{i}$ adalah efek perlakuan tertentu. $\\mu_{i}$ adalah rata-rata peubah respon di amatan yang mendapat perlakuan ke-i. Di model tetap, dapat disusun rata-rata perlakuan $\\mu_{i}$ dari $\\mu$ dan $\\tau_{i}$:\n\n$$\n\\begin{equation}\n\\mu_{i}=\\mu+\\tau_{i}\n\\end{equation}\n$$\n\nDan, anggap bahwa:\n\n$$\n\\begin{equation}\n\\frac{\\sum_{i=1}^t\\mu_{i}}{t}=\\mu\n\\end{equation}\n$$\n\nSebagai konsekuensi dari asumsi tersebut,\n\n$$\n\\begin{align}\n\\frac{\\sum_{i=1}^t\\mu_{i}}{t}&=\\frac{\\sum_{i=1}^t \\left(\\mu+\\tau_{i}\\right)}{t}\\\\\n\\mu&=\\frac{t\\mu}{t}+\\frac{\\sum_{i=1}^t\\tau_{i}}{t}=\\mu+\\frac{\\sum_{i=1}^t\\tau_{i}}{t}\\\\\n\\frac{\\sum_{i=1}^t\\tau_{i}}{t}&=0\n\\end{align}\n$$\n\nYang berarti $\\sum_{i=1}^t \\tau_{i}=0$. Maka dari itu, asumsi bahwa jumlah dari rata-rata perlakuan dibagi jumlah perlakuan adalah rata-rata keseluruhan memiliki implikasi bahwa jumlah efek tiap perlakuan nol. Asumsi tersebut tidak akan benar jika jumlah ulangan tiap perlakuan tidak sama^[Anggap ada tiga perlakuan dengan rata-rata 1, 2, 3, masing-masing diulang 2,3, dan 3 kali. Rata-rata umum adalah $\\frac{1+1+2+2+2+3+3+3}{8}=\\frac{2+6+9}{8}=\\frac{17}{8}$. Namun, jumlah rata-rata perlakuan dibagi jumlah perlakuan adalah $\\frac{6}{3}=2.$]. Oleh karena itu, **asumsi bahwa $\\sum_{i=1}^t \\tau_{i}=0$** yang dituliskan di beberapa teks, seperti Mattjik dan Sumertajaya (2002), sebenarnya **sama dengan asumsi bahwa semua perlakuan mendapat ulangan sama**. \n\nSuplemen untuk Montgomery (2017) mengatakan bahwa dalam kasus umum, rata-rata keseluruhan dapat didefinisikan sebagai $\\sum_{i=1}^tw_{i}\\mu_{i}=\\mu$, dengan $\\sum_{i=1}^tw_{i}=1$. Dalam kata lain, jumlah terboboti dari rata-rata kelompok adalah rata-rata keseluruhan. Definisi tersebut memberi implikasi bahwa $\\sum_{i=1}^t w_{i}\\tau_{i}=0$, yang diturunkan dengan prosedur sama seperti sebelumnya. Dalam kasus ulangan sama, bobot tiap perlakuan sama, yaitu $\\frac{1}{t}$^[Jika kita masukkan bobot tersebut, $\\frac{\\sum_{i=1}^t \\mu_{i}}{t}=\\mu$. Ini berarti jika ulangan sama asumsi jumlah efek perlakuan nol terpenuhi]. Secara umum, jika $N$ adalah total unit percobaan dan $r_{i}$ ulangan perlakuan ke-i, bobot memiliki formulasi $w_{i}=\\frac{r_{i}}{N}$ (ini seharusnya intuitif karena kita memboboti sesuai proporsi perlakuan tersebut dari seluruh unit percobaan).\n\nAsumsi yang analog untuk model acak adalah $\\tau_{i}\\sim N(0,\\sigma^2 \\tau)$. \n\n$\\varepsilon_{ij}$ adalah komponen galat acak yang merupakan semua sumber keragaman lain. Sumber tersebut, misal, adalah pengukuran, perbedaan antara satuan percobaan, efek dari lingkungan, dan lain-lain. Galat tersebut diasumsikan memiliki nilai harapan nol. Secara matematis:\n\n$$\n\\begin{equation}\nE\\left(\\varepsilon_{ij}\\right)=0\n\\end{equation}\n$$\n\n\n### Statistik\nSetelah melihat model, ada beberapa statistik dari peubah respon yang akan digunakan dalam ANOVA. $y_{i.}$ adalah total nilai peubah respon dari seluruh unit percobaan dengan perlakuan ke-i. Dalam kata lain, di perlakuan ke-i, nilai peubah respon dari r ulangan ditambah. $\\bar{y}_{i}$ adalah rata-rata nilai peubah respon dari seluruh observasi dengan perlakuan ke-i. Sedangkan, $y_{..}$ adalah total nilai peubah respon dari seluruh observasi, dengan rata-ratanya dinotasikan $\\bar{y}_{..}$. Rumus-rumus statistik tersebut adalah:\n\n$$\n\\begin{align}\ny_{i.}&=\\sum_{j=1}^ry_{ij}&\\bar{y}_{i.}&=\\frac{y_{i.}}{r} & i=1,2,...,t\\\\\ny_{..}&=\\sum_{i=1}^t\\sum_{j=1}^ry_{ij}&\\bar{y}_{..}&=\\frac{y_{..}}{tr}& \n\\end{align}\n$$\n\nKita dapat mengatakan bahwa $tr=N$, atau jumlah total unit percobaan.\n\n### Dekomposisi Jumlah Kuadrat\nANOVA adalah singkatan dari *analysis of variance*. Analisis ini berkaitan dengan keragaman karena tujuannya adalah mempartisi keragaman menjadi beberapa bagian. Ukuran keragaman total adalah **jumlah kuadrat total** ($JK_{T}$), dengan rumus:\n\n$$\n\\begin{align}\nJK_{T}&=\\sum_{i=1}^t\\sum_{j=1}^r\\left(y_{ij}-\\bar{y}_{..}\\right)^2=\\sum_{i=1}^t\\sum_{j=1}^r \\left(y_{ij}-\\bar{y}_{i.}\\right)^2+r\\sum_{i=1}^t \\left(\\bar{y}_{i.}-\\bar{y}_{..}\\right)^2\\\\\n&=JK_{G}+JK_{P}\n\\end{align}\n$$\n\n\nJumlah kuadrat tersebut dapat dihitung menggunakan:\n\n$$\n\\begin{align}\nFK&=\\frac{y_{..}^2}{tr}\\\\\nJK_{T}&=\\sum_{i=1}^t \\sum_{j=1}^r\\left(y_{ij}-\\bar{y}_{..}\\right)^2=\\sum_{i=1}^t \\sum_{j=1}^r y_{ij}^2-FK\\\\\nJK_{P}&=r\\sum_{i=1}^t \\left(\\bar{y}_{i.}-\\bar{y}_{..}\\right)^2=\\sum_{i=1}^t  \\frac{y_{i.}^2}{r}-FK\\\\\nJK_{G}&=JK_{T}-JK_{P}\n\\end{align}\n$$\n\n\nJika percobaan memiliki ulangan sama. Jika percobaan memiliki ulangan tak sama, jumlah ulangan r harus diubah menjadi $r_{i}$, jumlah ulangan perlakuan ke-i. Oleh karena penyesuaian tersebut, rumus-rumus jumlah kuadrat sebagai berikut:\n\n\n$$\n\\begin{align}\nFK&=\\frac{y_{..}^2}{\\sum_{i=1}^t r_{i}}\\\\\nJK_{T}&=\\sum_{i=1}^t \\sum_{j=1}^{r_{i}}\\left(y_{ij}-\\bar{y}_{..}\\right)^2=\\sum_{i=1}^t \\sum_{j=1}^{r_{i}} y_{ij}^2-FK\\\\\nJK_{P}&=\\sum_{i=1}^t\\sum_{j=1}^{r_{i}} \\left(\\bar{y}_{i.}-\\bar{y}_{..}\\right)^2=\\sum_{i=1}^t  \\frac{y_{i.}^2}{r_{i}}-FK\\\\\nJK_{G}&=JK_{T}-JK_{P}\n\\end{align}\n$$\n\n\n### Asumsi Galat\n\nDari jumlah kuadrat, dapat ditemukan kuadrat tengah. Kuadrat tengah adalah jumlah kuadrat dibagi derajat bebasnya. Kuadrat tengah galat merupakan penduga bagi ragam $\\sigma^2$, di mana $E\\left(KT_{G}\\right)=\\sigma^2$ dan jika semua $\\tau_{i}=0$ kuadrat tengah perlakuan juga merupakan penduga ragam (nilai harapannya akan sama dengan $\\sigma^2$. Hasil ini didapat dari dua asumsi. Asumsi pertama adalah mengenai ragam galat:\n\n$$\n\\begin{align}\nVar\\left(\\varepsilon_{ij}\\right)=E\\left[\\{\\varepsilon_{ij}-E(\\varepsilon_{ij})\\}^2\\right]=E\\left(\\varepsilon_{ij}^2\\right)=\\sigma^2\n\\end{align}\n$$\n\nKarena nilai harapan $E(\\varepsilon_{ij}$ sama dengan 0. Selain itu, terdapat asumsi mengenai kebebasan galat:\n\n\n$$\n\\begin{align}\nCov\\left(\\varepsilon_{ij}\\varepsilon_{ik}\\right)&=E\\left[\\left(\\varepsilon_{ij}-E\\left[\\varepsilon_{ij}\\right]\\right)\\left(\\varepsilon_{ik}-E\\left[\\varepsilon_{ik}\\right]\\right)\\right]\\\\\n&=E\\left(\\varepsilon_{ij}\\varepsilon_{ik}\\right)=0\n\\end{align}\n$$\n\n\n### Hipotesis dan ujinya\n\nDinyatakan bahwa $E\\left(KT_{P}\\right)=E\\left(KT_{G}\\right)$ saat perlakuan tidak memiliki efek. Secara formal, ini dinyatakan sebagai:\n\n\n$$\n\\begin{align}\nH_{0}&=\\tau_{1}=...=\\tau_{t}=0\\\\\nH_{1}&=\\text{ Setidaknya ada satu i dengan }\\tau_{i}\\neq0\n\\end{align}\n$$\n\nIni sama dengan menyatakan:\n\n$$\n\\begin{align}\nH_{0}&=\\mu_{1}=...=\\mu_{t}=\\mu\\\\\nH_{1}&=\\text{ Setidaknya ada satu i dengan }\\mu_{i}\\neq \\mu\n\\end{align}\n$$\n\n\nUji hipotesis ini dilakukan dengan uji F. Ini dikarenakan $JK_{G}/\\sigma^2$ dan $JK_{P}/\\sigma^2$ menyebar chi-kuadrat secara bebas. Jika dilakukan pembagian dua peubah chi-kuadrat saling bebas, dibagi dengan rasio derajat bebas kedua peubah tersebut, akan muncul peubah yang menyebar F. $\\sigma^2$ akan hilang karena saling terbagi. Selain itu, kuadrat tengah merupakan jumlah kuadrat dibagi derajat bebas sehingga $KT_{G}$ dan $KT_{P}$ menyebar F.\n\n### Review MKT\n\nMKT pada dasarnya adalah mencari nilai penduga yang meminumkan jumlah kuadrat galat $\\sum_{i=1}^t\\sum_{j=1}^r \\hat{\\varepsilon}_{ij}^2=\\sum_{i=1}^t \\sum_{j=1}^r \\left(y_{ij}-\\hat{\\mu}-\\hat{\\tau}_{i}\\right)^2$. Diketahui dari Kalkulus bahwa mencari nilai ekstrim suatu fungsi (minimum atau maksimum) dilakukan dengan mencari nilai yang menghasilkan turunan pertama nol. Karena ada banyak rumus, akan digunakan turunan parsial:\n\n$$\n\\begin{align}\n\\frac{\\delta L}{\\delta \\mu}&=0\\\\\n\\frac{\\delta L}{\\delta \\tau_{i}}&=0, i=1,2,..,t\\\\\n\\end{align}\n$$\n\nPenurunan, dan asumsi bahwa $\\sum_{i=1}^t \\tau_{i}=0$ akan menghasilkan:\n\n$$\ntr\\hat{\\mu}+r\\left(\\sum_{i=1}^t \\hat{\\tau}_{i}\\right)=tr\\hat{\\mu}=y_{..}\n$$\n\nOleh karena itu, penduga bagi $\\mu$, $\\hat{\\mu}$ adalah $y_{..}/tr=\\bar{y}_{..}$. Selain itu, dapat ditemukan bahwa:\n\n$$\n\\begin{align}\nr\\bar{y}_{..}+r\\hat{\\tau}_{i}&=y_{i.}\\\\\nr\\hat{\\tau_{i}}&=y_{i.}-r\\bar{y}_{..}\\\\\n\\hat{\\tau}_{i}&=\\bar{y}_{i.}-\\bar{y}_{..}\n\\end{align}\n$$\n\nOleh karena itu, kita telah menemukan penduga-penduga tersebut. Terakhir, ternyata hasil penurunan akan mengharuskan:\n\n$$\n\\sum_{i=1}^t \\sum_{j=1}^r \\left(y_{ij}-\\mu-\\tau_{i}\\right)=0\n$$\n\n\nIni berarti rata-rata penduga galat juga akan 0, yang memenuhi salah satu asumsi ANOVA. Sebagai tambahan, dalam model acak penduga bagi ragam pengaruh perlakuan adalah:\n\n$$\n\\hat{\\sigma}_{\\tau}^2=\\frac{KTP-KTG}{r}\n$$\n\n\n### Review Asumsi-Asumsi\n\nDapat disimpulkan bahwa asumsi-asumsi yang dibutuhkan dalam penurunan uji F adalah:\n1. $E\\left(\\varepsilon_{ij}\\right)=E\\left(\\varepsilon_{i.}\\right)=E\\left(\\varepsilon_{..}\\right)=0$ yang terpenuhi melalui metode MKT.\n2. $\\sum_{i=1} \\tau_{i}=0$, yang terpenuhi dari jumlah ulangan sama di satu perlakuan, serta digunakan sebagai batasan dalam MKT. Ada bentuk umum jika asumsi tersebut tidak terpenuhi.\n3. $E\\left(\\varepsilon_{ij}^2\\right)=\\sigma^2$ yang dibutuhkan untuk memastikan kuadrat tengah dapat menduga ragam secara tak bias.\n4. $Cov(\\varepsilon_{ij}\\varepsilon_{kl})=0$, atau galat saling bebas, juga untuk memastikan ketidakbiasan.\n5. $\\varepsilon_{ij} \\sim N(0,\\sigma^2)$ agar dapat dilakukan Uji-F.\n\n### Tabel ANOVA\n\nUji-F dilakukan dengan membangun tabel ANOVA. Tabel ANOVA untuk RAL ulangan sama sebagai berikut:\n\n\n\n  | Sumber Keragaman| db| JK| KT| F-hit|F(dbP,dbG)|\n  |------------:|-----------:|------------:|------------:|------------:|------------:|\n  |          Perlakuan|         t-1|          JKP| JKP/dbP | KTP/KTG | |\n  |          Galat|         t(r-1)|         JKG| JKG/dbG | | |\n  |          Total|         tr-1|          JKT| | | |\n\n\nDan untuk ulangan tak sama derajat bebas galat menjadi $\\sum_{i=1}^t \\left(r-{i}-1\\right)$ dan derajat bebas total $\\sum_{i=1}^t r_{1}$.\n\n#### Aplikasi: Lengkapi Tabel ANOVA!\n\nTerdapat sebuah percobaan ulangan sama dengan empat perlakuan dan tiga ulangan. Lengkapi tabel ANOVA tersebut, jika diketahui $JK_{P}$ dan $JK_{T}$! \n\n\n\n  | Sumber Keragaman| db| JK| KT| F-hit|F(dbP,dbG)|\n  |------------:|-----------:|------------:|------------:|------------:|------------:|\n  |          Perlakuan|         t-1|          120| JKP/dbP | KTP/KTG | |\n  |          Galat|         t(r-1)|         JKG| JKG/dbG | | |\n  |          Total|         tr-1|          170| | | |\n\n\nUntuk ulangan tak sama, tuliskan tabel ANOVA jika percobaan tersebut memiliki 3 ulangan pada perlakuan pertama dan terakhir, dan 2 ulangan pada perlakuan kedua, serta 4 ulangan pada perlakan ketiga! Jumlah $JK_{P}$ dan $JK_{T}$ tetap sama.\n\n### Praktek menggunakan R\n\nSetelah membuat bagan percobaan, kita akan melakukan ANOVA. Kasus yang dipakai akan berbeda, yaitu:\n\n> Karantina Tumbuhan ingin mengetahui pengaruh fumigan *Methyl Bromide* \\left(CH_{3}Br\\right) sebagai pembasmi serangga gudang terhadap daya tumbuh benih kacang hijau. Untuk itu, dilakukan percobaan sebagai berikut: benih kacang hijau diberi fumigan dengan dosis 0 (kontrol), 16 $gr/m^2$, 32 $gr/m^2$, 48 $gr/m^2$, 64 $gr/m^2$. Fumigasi dilakukan selama 2 jam. Benih kacang hijau yang sudah difumigasi dikecambahkan dengan metode kertas hisp (*blotter test*). Benih yang dikecambahkan diasumsikan homogen. Setelah 7 hari diperoleh hasil [sebagai berikut](https://docs.google.com/spreadsheets/d/1Bzm_R2Zd4Zbij7BO7LGDJW83DU6T3Wh7R38NN5DHCBs/edit?usp=sharing).\n\nAnalisis dimulai dari mengambil data tersebut:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(googlesheets4)\n#baca sheet\n\nDataRAL<-read_sheet(\"https://docs.google.com/spreadsheets/d/1Bzm_R2Zd4Zbij7BO7LGDJW83DU6T3Wh7R38NN5DHCBs/edit?usp=sharing\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n! Using an auto-discovered, cached token.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n  To suppress this message, modify your code or options to clearly consent to\n  the use of a cached token.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n  See gargle's \"Non-interactive auth\" vignette for more details:\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n  <https://gargle.r-lib.org/articles/non-interactive-auth.html>\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nℹ The googlesheets4 package is using a cached token for\n  'muh.ammarsahab@apps.ipb.ac.id'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ Reading from \"DataRAL\".\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ Range 'Sheet1'.\n```\n:::\n\n```{.r .cell-code}\nknitr::kable(DataRAL)\n```\n\n::: {.cell-output-display}\n| Dosis|   1|   2|   3|   4|   5|   6|   7|   8|\n|-----:|---:|---:|---:|---:|---:|---:|---:|---:|\n|     0| 100| 100| 100| 100| 100| 100| 100| 100|\n|    16| 100| 100| 100| 100| 100| 100| 100| 100|\n|    32|  90|  88|  92|  94|  90|  88|  86|  94|\n|    48|  80|  80|  82|  78|  84|  76|  82|  78|\n|    64|  90|  80|  92|  78|  82|  88|  94|  76|\n:::\n:::\n\nAkan dilakukan beberapa modifikasi terhadap data tersebut. Pertama, data ditransformasi menjadi bentuk *long*. Ini dikarenkan tabulasi data yang mencatat tiap ulangan dalam satu kolom kurang cocok untuk analisis. Tabulasi tersebut akan diubah sehingga data peubah respon semua ulangan dan perlakuan berada di satu kolom:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(reshape2)\n\nRALMelt<- melt(DataRAL,\n               #variabel yang membedakan tiap baris di tabulasi asli:\n               id.vars=c(\"Dosis\"),\n               #kolom yang ingin digabung jadi 1:\n               measured.vars=as.character(seq(1,8)),\n               value.name=\"Perkecambahan\")\n\ncolnames(RALMelt)[2]<-\"Ulangan\"\nknitr::kable(head(RALMelt,n=10))\n```\n\n::: {.cell-output-display}\n| Dosis|Ulangan | Perkecambahan|\n|-----:|:-------|-------------:|\n|     0|1       |           100|\n|    16|1       |           100|\n|    32|1       |            90|\n|    48|1       |            80|\n|    64|1       |            90|\n|     0|2       |           100|\n|    16|2       |           100|\n|    32|2       |            88|\n|    48|2       |            80|\n|    64|2       |            80|\n:::\n:::\n\n\nTanpa mengubah nama kolom, nama kolom Ulangan akan secara default menjadi \"variable\". Jika opsi value.name tidak diberi di fungsi melt, kolom Perkecambahan akan menjadi \"value\". Lalu, kita buat dosis menjadi sebuah faktor:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nRALMelt$Dosis<-as.factor(RALMelt$Dosis)\n```\n:::\n\n\nSetelah itu, dapat langsung dilakukan ANOVA. \n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_RAL <- aov(Perkecambahan ~ Dosis, data = RALMelt)\nsummary(aov_RAL)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value  Pr(>F)    \nDosis        4 2556.4   639.1   51.36 3.6e-14 ***\nResiduals   35  435.5    12.4                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nHasil ANOVA yang lebih rapih dapat ditunjukkan dengan `broom::tidy`. Pada intinya, fungsi ini mengubah output anova menjadi suatu *tibble*, mirip data.frame, sehingga dapat dibuat tabel:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbroom::tidy(aov_RAL) |> knitr::kable()\n```\n\n::: {.cell-output-display}\n|term      | df|  sumsq|    meansq| statistic| p.value|\n|:---------|--:|------:|---------:|---------:|-------:|\n|Dosis     |  4| 2556.4| 639.10000|   51.3628|       0|\n|Residuals | 35|  435.5|  12.44286|        NA|      NA|\n:::\n:::\n\n\nP-value statistik-F tersebut sangat kecil. Ini berarti kemungkinan menemukan nilai F sama atau lebih dari statistik F yang kita temukan sangat kecil, jika $H_{0}$ benar dan tidak ada efek perlakuan. Oleh karena itu, memakai $\\alpha$ 0.001 dan selebihnya (jika dianggap bahwa kemungkinan sekecil tersebut sudah cukup untuk menolak $H_{0}$), disimpulkan bahwa perlakuan memiliki efek pada respon. \n\n### Analisis Percobaan di Python\n\nSelain menggunakan R dan secara manual, software *open-source* lain yang dapat digunakan untuk Perancangan Percobaan adalah Python. Kita akan menggunakan modul pandas dan doe dari Python. Modul doe memerlukan tabulasi data dengan bentuk berbeda dari R. Tiap kolom harus mengandung data tiap perlakuan. Ini merupakan kebalikan dari tabulasi asli, yaitu tiap baris mengandung data perlakuan dan tiap kolom mengandung data ulangan.\n\nOleh karena itu, kita mulai dengan membaca data melalui pd.read_csv().Di python, ubah saja tautan google sheets `https://docs.google.com/spreadsheets/d/tautan/edit?usp=sharing` menjadi `https://docs.google.com/spreadsheets/d/tautan/export?gid=0&format=csv`. Bagian terakhir setelah tautan diubah menjadi `export?gid=0&format=csv`,\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport pandas as pd\n\nRALData=pd.read_csv(\"https://docs.google.com/spreadsheets/d/1Bzm_R2Zd4Zbij7BO7LGDJW83DU6T3Wh7R38NN5DHCBs/export?gid=0&format=csv\")\nRALData\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Dosis    1    2    3    4    5    6    7    8\n0      0  100  100  100  100  100  100  100  100\n1     16  100  100  100  100  100  100  100  100\n2     32   90   88   92   94   90   88   86   94\n3     48   80   80   82   78   84   76   82   78\n4     64   90   80   92   78   82   88   94   76\n```\n:::\n:::\n\n\nReshaping dapat dilakukan sehingga sama seperti tabulasi data R. Agar reshaping tersebut dapat dilakukan, perlu dibuat suatu list yang angka dari satu sampai delapan untuk menandakan ulangan. Anggota list tersebut harus berbentuk karakter. Oleh karena itu, fungsi `range(1,9)` digunakan untuk membuat suatu deret angka dari $1$ sampai $9-1=8$. Lalu, numerik-numerik tersebut diubah menjadi karakter dan dimasukkan ke dalam list.\n\nFungsi untuk mengubah numerik ke karakter adalah `str`. Cara mengaplikasikan fungsi tersebut ke sejumlah suatu deret hasil fungsi `range` atau list pada umumnya adalah `map(fungsi, ranve)`, atau `fungsi(x) for x in range`. Lalu, `list()` mengubah objek menjadi list, atau dapat juga dilakukan dengan `[ isi list ]`. Hasil kedua kode ini sama:\n\n\n::: {.cell}\n\n```{.python .cell-code}\nlist(map(str,range(1,9)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n['1', '2', '3', '4', '5', '6', '7', '8']\n```\n:::\n\n```{.python .cell-code}\n[str(x) for x in range(1,9)]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n['1', '2', '3', '4', '5', '6', '7', '8']\n```\n:::\n:::\n\n\nLalu melt data tersebut:\n\n\n::: {.cell}\n\n```{.python .cell-code}\nRALMeltpy=pd.melt(RALData, id_vars=['Dosis'], value_vars=[str(x) for x in range(1,9)])\n\nRALMeltpy.head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Dosis variable  value\n0      0        1    100\n1     16        1    100\n2     32        1     90\n3     48        1     80\n4     64        1     90\n```\n:::\n:::\n\n\nNama kolom pertama dan kedua perlu diubah, menggunakan fungsi `rename`. Fungsi tersebut diaplikasikan ke suatu dataset dengan `dataset.rename()`. Lalu kolom-kolom yang diubah namanya dapat dispesifikasi dengan `columns= {'kolomlama:kolombaru', 'kolomlama:kolombaru'}`. `inplace=True` akan mengubah dataset secara langsung, sedangkan `inplace=False` akan membuat suatu objek baru:\n\n\n::: {.cell}\n\n```{.python .cell-code}\nRALMeltpy.rename(columns = {'variable':'Ulangan', 'value':'Produksi'}, inplace = True)\n\nRALMeltpy.head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Dosis Ulangan  Produksi\n0      0       1       100\n1     16       1       100\n2     32       1        90\n3     48       1        80\n4     64       1        90\n```\n:::\n:::\n\n\nLalu gunakan statsmodels untuk ANOVA. OLS digunakan untuk membangun suatu model linear. Sintaksnya relatif mirip dengan R, yaitu `ols('respon ~ peubah')` dengan `C(Peubah)` menandakan suatu peubah kategorik. Hasil model tersebut diakses dengan `model.fit()`:\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport statsmodels.api as sm\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nC:\\Users\\Acer\\AppData\\Local\\R\\win-library\\4.2\\reticulate\\python\\rpytools\\loader.py:39: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n  module = _import(\nC:\\Users\\Acer\\AppData\\Local\\Programs\\Python\\PYTHON~2\\lib\\site-packages\\statsmodels\\compat\\pandas.py:65: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n  from pandas import Int64Index as NumericIndex\n```\n:::\n\n```{.python .cell-code}\nfrom statsmodels.formula.api import ols\n\nRALlm= ols('Produksi ~ C(Dosis)',data=RALMeltpy)\nfitRAL=RALlm.fit()\n```\n:::\n\n\nLalu, lakukan ANOVA dari objek fit tersebut:\n\n\n::: {.cell}\n\n```{.python .cell-code}\ntable = sm.stats.anova_lm(fitRAL) \nprint(table)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            df  sum_sq     mean_sq          F        PR(>F)\nC(Dosis)   4.0  2556.4  639.100000  51.362801  3.597935e-14\nResidual  35.0   435.5   12.442857        NaN           NaN\n```\n:::\n:::\n\n\nHasil sama dengan R.\n\n## RAKL\n\nRancangan Acak Kelompok Lengkap (RAKL) dapat juga disebut sebagai Rancangan Kelompok Teracak Lengkap (RKTL) atau *Randomized Complete Block Design* (RCBD). Karakteristik RAKL adalah:\n\n1. Kondisi unit percobaan tidak homogen. Keheterogenan unit percobaan berasal dari satu sumber keragaman. Ketidakhomogenan dapat dikendalikan dengan pengelompokan sehingga RAKL memungkinkan pengendalian ragam satu arah.\n2. Faktor di luar perlakuan dan kelompok relatif homogen.\n3. Keragaman antarkelompok tinggi, tetapi di dalam kelompok kecil.\n\nOleh karena karakteristik pertama, RAKL cocok digunakan di lapangan, yang memiliki perubahan kondisi (seperti kelembaban, suhu, dsb). Karena RAKL masih dalam satu faktor, perlakuan merupakan level-level dari satu faktor tertentu.\n\nKelebihan dalam menggunakan RAKL adalah sebagai berikut:\n\n1. Analisis statistik yang relatif sederhana bahkan dengan data hilang.\n2. Galat percobaan akan berkurang sehingga perbandingan antar perlakuan meningkat, dengan kata lain akan memberikan hasil yang lebih akurat daripada RAL karena pengelompokan.\n3. Mengizinkan perhitungan kesalahan yang tidak bias untuk perlakuan tertentu.\n4. Fleksibilitas penuh, bisa memiliki sejumlah perlakuan dan kelompok.\n\nKekurangan dalam menggunakan RAKL adalah sebagai berikut.\n\n1. Tidak cocok untuk jumlah perlakuan besar karena kelompok jadi semakin besar.\n2. Interaksi antara kelompok dan perlakuan meningkatkan kesalahan **di model tetap**.\n3. Ragam besar antara unit percobaan dalam kelompok dapat menghasilkan galat yang besar. Jika ada data hilang, RAKL mungkin kurang efisien daripada RAL.\n\nPoin kedua relatif penting - kita ingin perlakuan dan kelompok tidak memengaruhi satu sama lain. Efek semua perlakuan tetap sama di semua kelompok, dan sebaliknya. Namun, asumsi tanpa interaksi ini dapat dilanggar jika menggunakan model di mana kelompok dipilih secara acak.\n\n### Pengacakan\n\nPengacakan RAKL dilakukan di tiap kelompok. Algoritme pengacakan RAKL adalah sebagai berikut:\n\n1. Buat pemisalan nomor perlakuan 1,2,...,t.\n2. Beri nomor tersebut di setiap kelompok 1,2,...,t.\n3. Secara acak mengalokasikan perlakuan t ke unit percobaan di setiap kelompok. Pengacakan dilakukan pada masing-masing kelompok dan setiap perlakuan hanya muncul sekali dalam setiap kelompok.\n\nImplementasi di R memakai library agricolae akan menggunakan contoh berikut:\n\n> Percobaan lain pada Balai Penelitian Padi tersebut adalah ingin mengetahui pengaruh kerapatan benih terhadap produksi padi (kg/ha) pada varietas IR8. Kerapatan benih yang dicobakan adalah 25 kg benih/ha, 50 kg benih/ha, 75 kg benih/ha, 100 kg benih/ha, 125 kg benih/ha, 150 kg benih/ha. Lahan yang digunakan di perbuktin (lereng bukit), sehingga tingkat kesuburan tidak sama. Untuk itu petak dibagi jadi 4 kelompok. Masing-masing benih ditebarkan pada lahan seluas 5 x 5 $\\text{m}^2$ serta hasilnya dikonversi ke satuan kg/ha.\n\nAda enam perlakuan, dan empat kelompok. Akan ada 24 unit percobaan.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(agricolae)\nstr(design.rcbd)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nfunction (trt, r, serie = 2, seed = 0, kinds = \"Super-Duper\", first = TRUE, \n    continue = FALSE, randomization = TRUE)  \n```\n:::\n:::\n\n\nArgumen r dalam kasus ini akan menjadi jumlah kelompok. Maka dari itu, kita dapat lakukan pembuatan bagan:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nperlakuanRAK<-c(as.character(seq(25,150,25)))\nperlakuanRAK<-paste(perlakuanRAK, \"kg/ha\", sep=\" \")\nbaganRAK<-design.rcbd(perlakuanRAK,4,seed=78)\nknitr::kable(baganRAK$sketch)\n```\n\n::: {.cell-output-display}\n|         |          |          |          |          |          |\n|:--------|:---------|:---------|:---------|:---------|:---------|\n|50 kg/ha |75 kg/ha  |100 kg/ha |150 kg/ha |25 kg/ha  |125 kg/ha |\n|75 kg/ha |50 kg/ha  |150 kg/ha |25 kg/ha  |125 kg/ha |100 kg/ha |\n|75 kg/ha |125 kg/ha |25 kg/ha  |100 kg/ha |50 kg/ha  |150 kg/ha |\n|25 kg/ha |75 kg/ha  |50 kg/ha  |150 kg/ha |125 kg/ha |100 kg/ha |\n:::\n:::\n\n\nPerhatikan bahwa satu perlakuan hanya muncul sekali di tiap baris, sesuai konsep pengacakan RAKL yang dilakukan di dalam tiap baris.\n\n#### Pengacakan edibble\n\nDalam RAK, ada satuan kelompok. Di tiap kelompok, terdapat 6 petak sesuai dengan perlakuan. Maka dari itu, masukkan kelompok dan petak di `set_units`. Gunakan `nested_in(blok, jml unit)` untuk menandakan bahwa petak di dalam kelompok. Selebihnya sama saja. Kerapatan dialokasikan ke petak secara acak:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(edibble)\n\ndesRAKL<-design(name=\"Pengaruh kerapatan benih pada produksi padi\") %>%\n  set_units(kelompok=4,\n            petak=nested_in(kelompok, 6)) %>%\n  set_trts(kerapatan=perlakuanRAK) %>%\n  allot_trts(kerapatan ~ petak) %>%\n  assign_trts(\"random\", seed=420) %>% serve_table\n\nknitr::kable(head(desRAKL,n=10))\n```\n\n::: {.cell-output-display}\n|kelompok  |petak   |kerapatan |\n|:---------|:-------|:---------|\n|kelompok1 |petak1  |150 kg/ha |\n|kelompok1 |petak2  |75 kg/ha  |\n|kelompok1 |petak3  |125 kg/ha |\n|kelompok1 |petak4  |25 kg/ha  |\n|kelompok1 |petak5  |50 kg/ha  |\n|kelompok1 |petak6  |100 kg/ha |\n|kelompok2 |petak7  |100 kg/ha |\n|kelompok2 |petak8  |75 kg/ha  |\n|kelompok2 |petak9  |125 kg/ha |\n|kelompok2 |petak10 |150 kg/ha |\n:::\n:::\n\n\nPlot rancangan tersebut:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndeggust::autoplot(desRAKL)\n```\n\n::: {.cell-output-display}\n![](02-Bab2_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\nRancangan yang dibuat dapat dibandingkan dengan default RCBD dari edibble:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrcbd <- takeout(menu_rcbd(t = 6, r = 4,seed=420))\nexamine_recipe(rcbd)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndesign(\"Randomised Complete Block Design\") %>%\n  set_units(block = 4,\n            unit = nested_in(block, 6)) %>%\n  set_trts(trt = 6) %>%\n  allot_trts(trt ~ unit) %>%\n  assign_trts(\"random\", seed = 420) %>%\n  serve_table()\n```\n:::\n:::\n\n\nKode yang dibuat relatif mirip. Ada unit yang *nested in* blok, lalu perlakuan diberikan ke unit. Plot juga akan sama:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndeggust::autoplot(rcbd)\n```\n\n::: {.cell-output-display}\n![](02-Bab2_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n### Model Linear Aditif\n\n$$\ny_{ij}=\\mu+\\tau_{i}+\\beta_{j}+\\varepsilon_{ij}\n$$\n\n\nModel linear aditif tersebut relatif sama dengan RAL. $y_{ij}$ merupakan nilai peubah respon di perlakuan ke-i dan kelompok ke-j, $\\tau_{i}$ merupakan efek pengaruh ke-i, dengan $\\sum_{i=1}^t \\tau_{i}=0$, dan $\\varepsilon_{ij}\\sim N(0,\\sigma^2)$ adalah pengaruh acak di perlakuan ke-i dan kelompok ke-j.  Aspek yang berbeda di model tersebut adalah $\\beta_{j}$, atau efek dari kelompok ke-j. Sama seperti efek perlakuan, diasumsikan $\\sum_{j=1}^r \\beta_{j}=0$ untuk model tetap dan $\\beta_{j}\\sim N(0,\\sigma_{\\beta}^2)$. \n\nOleh karena itu, ada dua hipotesis. Hipotesis pertama, seperti RAL, adalah mengenai **pengaruh perlakuan**:\n\n$$\n\\begin{align}\nH_{0}&:\\tau_{1}=...=\\tau_{t}=0\\\\\nH_{1}&:\\text{ Setidaknya ada satu i di mana } \\tau_{i}\\neq 0\n\\end{align}\n$$\n\nYaitu, bahwa semua perlakuan tidak berpengaruh atau sebaliknya, terdapat sedikitnya satu perlakuan yang berpengaruh. Selain itu, ada hipotesis mengenai **pengaruh kelompok**:\n\n\n$$\n\\begin{align}\nH_{0}&:\\beta_{1}=...=\\beta_{r}=0\\\\\nH_{1}&:\\text{ Setidaknya ada satu j di mana } \\beta_{j}\\neq 0\n\\end{align}\n$$\n\n\nUji hipotesis kelompok tidak selalu dapat dilakukan. Montgomery (2017) mengatakan bahwa jika asumsi normalitas tidak dipenuhi, uji-F bukan cara yang baik untuk menguji efek pengelompokan. Namun, format uji tersebut masih dapat dilakukan sebagai perkiraan. $KT_{B}/KT_{G}$ belum tentu dapat dibandingkan dengan sebaran tertentu, tetapi masih dapat dilihat besarnya secara *common sense*.\n\nDari MKT, penduga bagi $\\beta_{j}$ adalah $\\bar{y}_{j.}-\\bar{y}_{..}$. Ini dikarenakan:\n\n$$\n\\begin{align}\n\\mu_{j}=\\mu+\\beta_{j}\\\\\n\\hat{\\mu}_{j}=\\bar{y}_{j.}=\\bar{y}_{..}+\\hat{\\beta}_{j}\n\\end{align}\n$$\n\n\n### ANOVA\n\nJumlah kuadrat yang dihitung sama dengan RAL, dengan tambahan $JK_{B}$ (baris/kelompok) yang memiliki rumus $\\sum_{j=1}^r \\left(\\bar{y}_{.j}-\\bar{y}_{..}\\right)^2$. Oleh karena itu, di RAKL dihitung:\n\n\n$$\n\\begin{align}\nFK&=\\frac{y_{..}^2}{tr}\\\\\nJK_{T}&=\\sum_{i=1}^t \\sum_{j=1}^r\\left(y_{ij}-\\bar{y}_{..}\\right)^2=\\sum_{i=1}^t \\sum_{j=1}^r y_{ij}^2-FK\\\\\nJK_{P}&=r\\sum_{i=1}^t \\left(\\bar{y}_{i.}-\\bar{y}_{..}\\right)^2=\\sum_{i=1}^t  \\frac{y_{i.}^2}{r}-FK\\\\\nJK_{B}&=t\\sum_{j=1}^r\\left(\\bar{y}_{.j}-\\bar{y}_{..}\\right)^2=\\sum_{j=1}^r \\frac{y_{.j}^2}{t}-FK\\\\\nJK_{G}&=JK_{T}-JK_{P}-JK_{B}\n\\end{align}\n$$\n\n\nSehingga konstruksi tabel ANOVA sebagai berikut:\n\n\n  | Sumber Keragaman| db| JK| KT| F-hit|F(dbP,dbG)|\n  |------------:|-----------:|------------:|------------:|------------:|------------:|\n  |          Perlakuan|         t-1|          JKP| JKP/dbP | KTP/KTG | |\n  |          Blok|         r-1|          JKB| JKB/dbB | KTB/KTG | |\n  |          Galat|         (t-1)(r-1)|         JKG| JKG/dbG | | |\n  |          Total|         tr-1|          JKT| | | |\n\n\nJumlah derajat bebas perlakuan, blok, dan total intuitif - mereka berturut-turut merupakan jumlah perlakuan dikurangi satu, blok dikurangi satu, dan unit percobaan dikurangi satu. Derajat bebas galat ditemukan dengan $tr-1-(t-1)-(r-1)=tr-t-r+1=\\left(t-1\\right)\\left(r-1\\right)$. \n\n### Analisis dengan R dan Python\n\nUntuk menunjukkan analisis data RAKL di R, akan dipakai studi kasus ini:\n\n> Untuk melihat keefektifan pengaruh pemupukan terhadap produksi suatu varietas padi dilakuakn percobaan di rumah kaca sebagai berikut: 9 kombinasi perlakuan yang dicobakan dengan pupuk K dan P dengan komposisi 2:1 (K2P1), 2:2 (K2P2), ..., 3:4 (K3P4) ditambah sebuah kontrol (K0P0). Setiap perlakuan diulang dalam 3 blok (timur, tengah, barat). Data pengamatannya diperoleh [sebagai berikut](https://docs.google.com/spreadsheets/d/1uFi_Njharot8G8-DvHWPhNLLqJ72ym5EuuOqgeFA0hY/edit?usp=sharing)\n\nUntungnya, data memiliki format yang mudah untuk dianalisis. Oleh karena itu, load data tersebut:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(googlesheets4)\nDataRAKL<-read_sheet(\"https://docs.google.com/spreadsheets/d/1uFi_Njharot8G8-DvHWPhNLLqJ72ym5EuuOqgeFA0hY/edit?usp=sharing\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ Reading from \"RAKL_P2 Rancob\".\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ Range 'Sheet1'.\n```\n:::\n\n```{.r .cell-code}\nDataRAKL$Produksi<-as.numeric(DataRAKL$Produksi)\n\n#pastikan perlakuan dan kelompok berbentuk faktor\nDataRAKL$Kelompok<-as.factor(DataRAKL$Kelompok)\nDataRAKL$Perlakuan<-as.factor(DataRAKL$Perlakuan)\nknitr::kable(DataRAKL)\n```\n\n::: {.cell-output-display}\n|Perlakuan |Kelompok | Produksi|\n|:---------|:--------|--------:|\n|Kontrol   |1        |    10.19|\n|Kontrol   |2        |     9.26|\n|Kontrol   |3        |    12.73|\n|K2P1      |1        |    32.02|\n|K2P1      |2        |    25.76|\n|K2P1      |3        |    19.72|\n|K2P2      |1        |    23.91|\n|K2P2      |2        |    21.99|\n|K2P2      |3        |    21.42|\n|K2P3      |1        |    17.15|\n|K2P3      |2        |    15.66|\n|K2P3      |3        |    10.37|\n|K2P4      |1        |    10.35|\n|K2P4      |2        |    13.31|\n|K2P4      |3        |    14.31|\n|K3P1      |1        |    21.98|\n|K3P1      |2        |    19.43|\n|K3P1      |3        |    16.16|\n|K3P2      |1        |    18.08|\n|K3P2      |2        |    13.50|\n|K3P2      |3        |    18.32|\n|K3P3      |1        |    18.07|\n|K3P3      |2        |    14.01|\n|K3P3      |3        |    14.39|\n|K3P4      |1        |    12.37|\n|K3P4      |2        |    16.32|\n|K3P4      |3        |    10.20|\n:::\n:::\n\n\nDan langsung lakukan analisis:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelRAKL<-aov(Produksi~Perlakuan+Kelompok,DataRAKL)\nsummary(modelRAKL)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value  Pr(>F)    \nPerlakuan    8  586.0   73.25   8.297 0.00019 ***\nKelompok     2   39.2   19.61   2.221 0.14090    \nResiduals   16  141.3    8.83                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nAtau, di python:\n\n::: {.cell}\n\n```{.python .cell-code}\nimport pandas as pd\n\nRAKLpy=pd.read_csv(\"https://docs.google.com/spreadsheets/d/e/2PACX-1vTi9yO_OJZ5pHMmPRlPqPxK9TydeVWI--rXAYfFfwj2v6ee-vUrQGYUGYb5zgguZ5mgu9IDhwB-dIwl/pub?gid=0&single=true&output=csv\")\nRAKLpy\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Perlakuan  Kelompok  Produksi\n0    Kontrol         1     10.19\n1    Kontrol         2      9.26\n2    Kontrol         3     12.73\n3       K2P1         1     32.02\n4       K2P1         2     25.76\n5       K2P1         3     19.72\n6       K2P2         1     23.91\n7       K2P2         2     21.99\n8       K2P2         3     21.42\n9       K2P3         1     17.15\n10      K2P3         2     15.66\n11      K2P3         3     10.37\n12      K2P4         1     10.35\n13      K2P4         2     13.31\n14      K2P4         3     14.31\n15      K3P1         1     21.98\n16      K3P1         2     19.43\n17      K3P1         3     16.16\n18      K3P2         1     18.08\n19      K3P2         2     13.50\n20      K3P2         3     18.32\n21      K3P3         1     18.07\n22      K3P3         2     14.01\n23      K3P3         3     14.39\n24      K3P4         1     12.37\n25      K3P4         2     16.32\n26      K3P4         3     10.20\n```\n:::\n:::\n\n\nData sudah dalam format yang tepat untuk fungsi `ols`:\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport statsmodels.api as sm\nfrom statsmodels.formula.api import ols\n\nRAKLlm= ols('Produksi ~ C(Perlakuan)+ C(Kelompok)',data=RAKLpy)\nfitRAKL=RAKLlm.fit()\n```\n:::\n\n\nLalu, lakukan ANOVA dari objek fit tersebut:\n\n\n::: {.cell}\n\n```{.python .cell-code}\ntable = sm.stats.anova_lm(fitRAKL) \nprint(table)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                df      sum_sq    mean_sq         F    PR(>F)\nC(Perlakuan)   8.0  586.039763  73.254970  8.297279  0.000190\nC(Kelompok)    2.0   39.210696  19.605348  2.220615  0.140898\nResidual      16.0  141.260704   8.828794       NaN       NaN\n```\n:::\n:::\n\n\nHasil ANOVA tersebut relatif sama. Peluang menemukan nilai F yang sama atau lebih besar jika tak ada efek perlakuan sangat kecil - 0.0002 (0.02 persen). Namun, peluang menemukan nilai F yang sama atau lebih besar jika tak ada efek kelompok kira-kira 0.15 (15 persen). Kita mungkin lebih nyaman menyimpulkan bahwa perlakuan berpengaruh daripada bahwa kelompok berpengaruh. Misal, jika kita memakai $\\alpha=5\\%$ di kedua kasus, kita akan menolak $H_{0}$ untuk perlakuan tapi taktolak $H_{0}$ untuk kelompok.\n\n\n### Topik-topik tambahan\n\n#### Efisiensi relatif\n\nEfisiensi relatif RAKL dengan RAL tanpa penyesuaian dihitung sebagai berikut:\n\n$$\nER_{0}=\\frac{\\hat{\\sigma}_{r}^2}{\\hat{\\sigma_{b}^2}}\n$$\n\nLalu, $\\hat{\\sigma}_{b}^2$ adalah penduga ragam galat RAK, yang merupakan KTG.\n\nPenduga ragam galat RAL sedikit lebih kompleks:\n\n$$\n\\begin{align}\n\\sigma_{r}^2&=\\frac{(r-1)KTB+r(t-1)KTG}{tr-1}\\\\\n\\end{align}\n$$\n\nPenduga ini diturunkan dengan mencari nilai harapan kuadrat tengah dari semua kombinasi rancangan. Pada dasarnya, nilai harapan penduga tersebut akan menjadi KTG RAL. Namun, perbandingan ragam galat tersebut tidak dapat dilakukan secara naif. Sebaran Student t (yang akan digunakan di perbandingan berganda) tidak stabil saat derajat bebas kecil, khususnya di bawah 20. Nilai t kritis akan menurun relatif besar dalam situasi tersebut sehingga probabilitas menemukan perbedaan yang signifikan antara rata-rata perlakuan berfluktuasi. Oleh karena itu, rumus efisiensi relatif memiliki penyesuaian sebagai berikut:   \n\n$$\n\\begin{align}\nER&=\\frac{\\left(db_{g[RAK]}+1\\right)\\left(db_{g[RAL]}+3\\right)}{\\left(db_{g[RAK]}+3\\right)\\left(db_{g[RAL]}+1\\right)}\\cdot \\frac{\\hat{\\sigma}_{r}^2}{\\hat{\\sigma_{b}^2}}\\\\\n\\end{align}\n$$\n\n\nDi mana $db_{g(RAK)}$ dan $db_{g(RAL)}$ adalah db galat RAK dan RAL. Derajat bebas tersebut diperoleh dengan memakai rumus db galat RAL pada hasil RAK yang kita punya. Dalam contoh sebelumnya, diketahui bahwa db galat adalah 16, dengan 9 perlakuan dan 3 kelompok $(t-1)(r-1)=8\\cdot 2=16$. Derajat bebas galat RAL memiliki rumus $t(r-1)=9\\cdot 2=18$. Atau, dapat memakai rumus $db_{g(RAL)}=db_{g(RAK)}+db_{b}=(t-1)(r-1)+(r-1)=t(r-1)$. Untuk mengimplementasikan metode tersebut, buat data frame dari hasil aov terlebih dahulu. Summary aov merupakan sebuah *list*, dan elemen pertama dari elemen pertama list tersebut merupakan tabel ANOVA:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#ambil elemen 1 [1]; ambil elemen 1 dari elemen 1 [1][[1]]\nTabelANOVA<-as.data.frame(summary(modelRAKL)[1][[1]])\nknitr::kable(TabelANOVA)\n```\n\n::: {.cell-output-display}\n|          | Df|   Sum Sq|   Mean Sq|  F value|    Pr(>F)|\n|:---------|--:|--------:|---------:|--------:|---------:|\n|Perlakuan |  8| 586.0398| 73.254970| 8.297279| 0.0001896|\n|Kelompok  |  2|  39.2107| 19.605348| 2.220614| 0.1408977|\n|Residuals | 16| 141.2607|  8.828794|       NA|        NA|\n:::\n:::\n\n\nLalu, ambil nilai-nilai derajat bebas dan penduga ragam yang diinginkan:\n\n::: {.cell}\n\n```{.r .cell-code}\n#Ambil derajat bebas\ndbg<-TabelANOVA$Df[3]\ndbkel<-TabelANOVA$Df[2]\ndbp<-TabelANOVA$Df[1]\nr<-dbkel+1\ndbg_RAL<-dbg+dbkel\n\n#Ambil kuadrat tengah\nKTG<-TabelANOVA$`Mean Sq`[3]\nKTB<-TabelANOVA$`Mean Sq`[2]\n\n#hitung penduga ragam RAL\nsigmaRAL<-(dbkel*KTB+r*dbp*KTG)/(dbg+dbkel+dbp)\n```\n:::\n\n\nSetelah semua nilai terhitung, hitung efisiensi relatif:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkoreksi<-((dbg+1)*(dbg_RAL+3))/((dbg+3)*(dbg_RAL+1))\nRE<-koreksi*(sigmaRAL/KTG)\n```\n:::\n\n\nSemua input tersebut dapat digabung menjadi suatu fungsi:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nefisiensiRAKL<-function(aovariance){\n  TabelANOVA<-as.data.frame(summary(aovariance)[1][[1]])\n  #Ambil derajat bebas\n  dbg<-TabelANOVA$Df[3]\n  dbkel<-TabelANOVA$Df[2]\n  dbp<-TabelANOVA$Df[1]\n  r<-dbkel+1\n  dbg_RAL<-dbg+dbkel\n\n  #Ambil kuadrat tengah\n  KTG<-TabelANOVA$`Mean Sq`[3]\n  KTB<-TabelANOVA$`Mean Sq`[2]\n\n  #hitung penduga ragam RAL\n  sigmaRAL<-(dbkel*KTB+r*dbp*KTG)/(dbg+dbkel+dbp)\n\n  #hitungRE\n  koreksi<-((dbg+1)*(dbg_RAL+3))/((dbg+3)*(dbg_RAL+1))\n  RE<-koreksi*(sigmaRAL/KTG)\n  return(RE)\n}\nefisiensiRAKL(modelRAKL)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.081773\n```\n:::\n:::\n\n\nInterpretasi dari efisiensi relatif tersebut adalah perlu ulangan sebesar RE kali di RAL untuk mencapai performa sama di uji. Dalam kasus ini, perlu 1.08 kali ulangan agar RAL memliki performa sama dengan RAKL.\n\n#### Plot interaksi {#plot-interaksi}\n\nSalah satu asumsi RAKL dengan model tetap adalah tidak adanya interaksi antara perlakuan dan kelompok. Plot interaksi dapat dibuat sebagai berikut:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(DataRAKL,interaction.plot(Kelompok, Perlakuan, Produksi))\n```\n\n::: {.cell-output-display}\n![](02-Bab2_files/figure-html/unnamed-chunk-40-1.png){width=672}\n:::\n:::\n\n\nAtau, jika ingin menggunakan ggplot agar plot lebih rapi:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nggplot(DataRAKL, aes(x = Perlakuan, y = Produksi, colour = Kelompok)) + \n    geom_point(data = DataRAKL, aes(y = Produksi)) +\n    geom_line(data = DataRAKL, aes(y = Produksi, group = Kelompok)) + \n    theme_bw()\n```\n\n::: {.cell-output-display}\n![](02-Bab2_files/figure-html/unnamed-chunk-41-1.png){width=672}\n:::\n:::\n\n\nPlot interaksi juga dapat dibuat di python. Pastikan data frame RAKLpy sudah di-load terlebih dahulu sebelum melakukan plotting:\n\n::: {.cell}\n\n```{.python .cell-code}\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\ng=sns.pointplot(x = \"Perlakuan\",\n              y = \"Produksi\",\n              hue= \"Kelompok\",\n              data = RAKLpy)\n# show the plot\nplt.show()\n```\n\n::: {.cell-output-display}\n![](02-Bab2_files/figure-html/unnamed-chunk-42-1.png){width=672}\n:::\n:::\n\n\nTerlihat beberapa perbedaan antara pola per kelompok, khususnya setelah K3P1 di kedua plot. Pola-pola tersebut menandakan ada kemungkinan interaksi yang perlu diuji lebih lanjut.\n\n#### Pendugaan Data Hilang\n\nData hilang diduga dengan MKT. Nilai data hilang dicari sehingga meminumkan JKG. Oleh karena itu, rumus adalah:\n\n$$\ny_{ij}=\\frac{ty_{i.}^{'}+ry_{.j}^{'}-y_{..}^{'}}{(t-1)(r-1)}\n$$\n\nDengan t adalah jumlah perlakuan, $y_{i.}^{'}$ total data perlakuan data hilang tesebut, r jumlah kelompok, $y_{.j}^{'}$ total data suatu kelompok. Package R yang memiliki fitur estimasi data hilang adalah st4gi. Package tersebut tidak bisa didapat melalui *command* install.packages sehingga cara instalasi package sebagai berikut:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::install_github(\"reyzaguirre/st4gi\")\n```\n:::\n\n\nDevtools digunakan untuk menginstalasi dari GitHub. Seperti agricolae, package st4gi juga menyediakan pembuatan bagan percobaan, dengan command cr.rcbd. Pembuatan bagan percobaan dengan st4gi adalah sebagai berikut:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(st4gi)\ndfrakl<-cr.rcbd(geno=levels(DataRAKL$Perlakuan), #perlakuan\n             nb=3 #jumlah kelompok\n             )\ndfrakl<-dfrakl$book #data frame dari bagan percobaan\nknitr::kable(head(dfrakl,n=10))\n```\n\n::: {.cell-output-display}\n| plot.num| block| row| col|geno    |\n|--------:|-----:|---:|---:|:-------|\n|        1|     1|   1|   1|Kontrol |\n|        2|     1|   1|   2|K2P2    |\n|        3|     1|   1|   3|K3P4    |\n|        4|     1|   2|   3|K3P3    |\n|        5|     1|   2|   2|K2P3    |\n|        6|     1|   2|   1|K2P1    |\n|        7|     1|   3|   1|K2P4    |\n|        8|     1|   3|   2|K3P1    |\n|        9|     1|   3|   3|K3P2    |\n|       10|     2|   1|   1|K2P2    |\n:::\n:::\n\n\nArgumen geno (genotipe) digunakan karena package st4gi digunakan dalam implementasi riset genetik. Data frame yang dibuat dari bagan percobaan akan digunakan sebagai input estimasi data hilang. Sebelumnya, telah dicoba input estimasi data hilang menggunakan DataRAKL asli yang tidak dibuat dari bagan percobaan st4gi, tetapi gagal. Oleh karena itu, input data dari DataRAKL ke dfr (hasil st4gi). Harus dipastikan bahwa data tersebut memiliki urutan sama dengan sorting. Sorting tersebut dimulai dari kelompok, lalu perlakuan:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndforder<-dfrakl[order(dfrakl$block, dfrakl$geno),] #order data frame hasil st4gi\nRAKLorder<-DataRAKL[order(DataRAKL$Kelompok, DataRAKL$Perlakuan),] #order data frame RAKL\nknitr::kable(head(dforder,n=12))\n```\n\n::: {.cell-output-display}\n|   | plot.num| block| row| col|geno    |\n|:--|--------:|-----:|---:|---:|:-------|\n|6  |        6|     1|   2|   1|K2P1    |\n|2  |        2|     1|   1|   2|K2P2    |\n|5  |        5|     1|   2|   2|K2P3    |\n|7  |        7|     1|   3|   1|K2P4    |\n|8  |        8|     1|   3|   2|K3P1    |\n|9  |        9|     1|   3|   3|K3P2    |\n|4  |        4|     1|   2|   3|K3P3    |\n|3  |        3|     1|   1|   3|K3P4    |\n|1  |        1|     1|   1|   1|Kontrol |\n|15 |       15|     2|   2|   1|K2P1    |\n|10 |       10|     2|   1|   1|K2P2    |\n|13 |       13|     2|   2|   3|K2P3    |\n:::\n:::\n\n\nBandingkan dengan RAKL order:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(head(RAKLorder,n=12))\n```\n\n::: {.cell-output-display}\n|Perlakuan |Kelompok | Produksi|\n|:---------|:--------|--------:|\n|K2P1      |1        |    32.02|\n|K2P2      |1        |    23.91|\n|K2P3      |1        |    17.15|\n|K2P4      |1        |    10.35|\n|K3P1      |1        |    21.98|\n|K3P2      |1        |    18.08|\n|K3P3      |1        |    18.07|\n|K3P4      |1        |    12.37|\n|Kontrol   |1        |    10.19|\n|K2P1      |2        |    25.76|\n|K2P2      |2        |    21.99|\n|K2P3      |2        |    15.66|\n:::\n:::\n\n\nKedua data frame tersebut memiliki urutan mirip. Masukkan data dari hasil percobaan ke bagan percobaan st4gi dan hilangkan suatu data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndforder$y<-RAKLorder$Produksi #input data respon hasil sort\ndforder[12,'y']<-NA #buat salah satu data NA\n```\n:::\n\n\nLalu, cek data hilang tersebut. Urutan argumen fungsi adalah peubah respon, perlakuan, kelompok, dan data frame:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncek<-ck.rcbd('y', 'geno', 'block', dforder) #peubah respon, perlakuan, kelompok, df\nknitr::kable(cek$tfr)\n```\n\n::: {.cell-output-display}\n|        |  1|  2|  3|\n|:-------|--:|--:|--:|\n|K2P1    |  1|  1|  1|\n|K2P2    |  1|  1|  1|\n|K2P3    |  1|  0|  1|\n|K2P4    |  1|  1|  1|\n|K3P1    |  1|  1|  1|\n|K3P2    |  1|  1|  1|\n|K3P3    |  1|  1|  1|\n|K3P4    |  1|  1|  1|\n|Kontrol |  1|  1|  1|\n:::\n:::\n\n\nData hilang berada di perlakuan K2P3 dan kelompok 2. Kita akan bandingkan hasil perhitungan manual dengan fungsi R. Pertama, cari $y_{i.}^{'}$ dan $y_{.j}^{'}$. Buat tabel total perlakuan dengan dplyr. Operator `%>%` merupakan pipa yang melanjutkan output suatu fungsi ke fungsi sebelumnya. Misal `dforder %>%` berarti data.frame dforder menjadi input fungsi selanjutnya, yaitu pengelompokan `group_by(geno)`. Lalu hasilnya dibuatkan tabel simpulan, yaitu dengan sum: \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:edibble':\n\n    as_data_frame\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nTotalPerlakuan<-dforder %>%\n  group_by(geno) %>%\n  summarise(Freq = sum(y,na.rm=T))\nknitr::kable(TotalPerlakuan)\n```\n\n::: {.cell-output-display}\n|geno    |  Freq|\n|:-------|-----:|\n|K2P1    | 77.50|\n|K2P2    | 67.32|\n|K2P3    | 27.52|\n|K2P4    | 37.97|\n|K3P1    | 57.57|\n|K3P2    | 49.90|\n|K3P3    | 46.47|\n|K3P4    | 38.89|\n|Kontrol | 32.18|\n:::\n:::\n\n\nDan buat tabel total kelompok:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTotalKelompok<-dforder %>%\n  group_by(block) %>%\n  summarise(Freq = sum(y,na.rm=T))\nknitr::kable(TotalKelompok)\n```\n\n::: {.cell-output-display}\n| block|   Freq|\n|-----:|------:|\n|     1| 164.12|\n|     2| 133.58|\n|     3| 137.62|\n:::\n:::\n\n\nAmbil total perlakuan K2P3, total kelompok 2, dan total nilai peubah respon:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTotal<-sum(dforder$y,na.rm=T)\nTotalK2P3<-TotalPerlakuan$Freq[3]\nTotal2<-TotalKelompok$Freq[2]\n(9*TotalK2P3+3*Total2-Total)/16\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 13.31875\n```\n:::\n:::\n\n\nBandingkan dengan estimasi menggunakan fungsi R. Urutan argumen sama dengan argumen saat pengecekan nilai hilang di RAKL (respon, perlakuan, kelompok, data frame):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(mve.rcbd('y','geno','block',dforder)[12,])\n```\n\n::: {.cell-output-display}\n|   |geno | block|  y|    y.est|\n|:--|:----|-----:|--:|--------:|\n|13 |K2P3 |     2| NA| 13.31875|\n:::\n:::\n\n\nDapat dilihat bahwa hasil pengisian nilai hilang sama dengan hasil penghitungan manual.\n\n#### Koefisien Keragaman\n\nKoefisien Keragaman merupakan ukuran keheterogenan unit percobaan. Rumus koefisien tersebut cukup sederhana, yaitu penduga simpangan baku dibagi penduga nilai harapan. Karena penduga ragam adalah KTG, penduga simpangan baku adalah akar dari KTG. Rumus tersebut menjadi:\n\n$$\nKK=\\frac{\\hat{\\sigma}}{\\bar{y}_{..}}\\cdot 100\\%=\\frac{\\sqrt{KTG}}{\\bar{y}_{..}}\\cdot 100\\%\n$$\n\nUntuk menghitung KK dari data RAKL relatif sederhana. Note bahwa dalam prosedur estimasi nilai hilang sudah ditemukan KTG, jadi KTG hanya perlu dipanggil. Jika belum ditemukan, ikuti prosedur yang ada di bagian estimasi nilai hilang:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsqrt(KTG)/mean(DataRAKL$Produksi)*100\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 17.78923\n```\n:::\n:::\n\n\nNilai tersebut memiliki interpretasi besar simpangan baku contoh adalah 17 persen dari besar rata-rata contoh.\n\n#### Jumlah ulangan \nJumlah kelompok dalam RAKL dihitung menggunakan beberapa kaidah:\n\n1. Minimal 2\n2. Minimal derajat bebas galat 12\n3. Formula perbedaan rataan maksimal\n\nKaidah menggunakan db galat dapat diturunkan sebagai berikut:\n\n$$\n\\begin{align}\ndb_{g}&=(t-1)(r-1)\\geq 12\\\\\nr-1&\\geq\\frac{12}{t-1}\\\\\nr&\\geq\\frac{12}{t-1}+1\n\\end{align}\n$$\n\nDan implementasi rumus tersebut di R diperlihatkan di bawah:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt<-9 #nilai t dapat disesuaikan\nceiling((12/(t-1))+1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3\n```\n:::\n:::\n\n\nSeperti di bab pertama, ceiling digunakan karena pembulatan biasa dapat menghasilkan nilai yang lebih kecil dari hasil rumus. Pembulatan ke atas mencegah hal tersebut. Maka, dibutuhkan minimal 3 kelompok dalam percobaan ini.\n\nFormula perhitungan jumlah kelompok adalah\n\n$$\nr\\geq\\frac{2\\cdot t_{\\alpha/2;dbg}^2 \\cdot \\sigma^2}{\\delta^2}\n$$\n\nAsal dari formula tersebut adalah BNT. Formula tersebut menyatakan jumlah kelompok yang dibutuhkan untuk mendeteksi perbedaan sebesar $\\delta$ antara rata-rata dua perlakuan di tingkat signifikasi $\\alpha \\%$. $\\sigma^2$ menandakan ragam, dan $t_{\\alpha/2;dbg}^2$ berkaitan dengan sebaran t yang digunakan di BNT. Alternatif formula tersebut adalah:\n\n$$\nr\\geq\\frac{2\\cdot t_{\\alpha/2;dbg}^2 \\cdot kk^2}{q^2}\n$$\n\nDi mana KK adalah koefisien keragaman dan q afalah ukuran perbedaan yang dinyatakan dalam persentase. Perhitungan formula tersebut relatif mudah diimplementasikan di R. Oleh karena itu, hanya akan ditunjukkan cara mendapatkan tabel-t dari R. Lower.tail dibuat FALSE agar nilai tabel t tidak minus.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqt(p=0.025,df=16,lower.tail=F) #alpha atau alpha/2, dbg\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.119905\n```\n:::\n:::\n\n\n## RBSL\n\nRBSL merupakan rancangan yang memungkinkan adanya dua faktor penganggu. Di luar faktor penganggu tersebut dan perlakuan, unit percobaan dianggap homogen. RBSL memiliki batasan yaitu jumlah perlakuan = baris = lajur. Ini berarti, taraf-taraf dari faktor penganggu juga harus sama dengan taraf faktor perlakuan. Oleh karena itu, aplikasi RBSL relatif terbatas saat jumlah faktor-faktor tersebut dapat bervariasi. \n\nLalu, satu perlakuan hanya muncul sekali di satu baris dan lajur. Oleh karena hal tersebut dan batasan jumlah perlakuan, baris, dan lajur pada RBSL, terdapat $r^2$ unit percobaan, dengan r adalah jumlah perlakuan, baris, atau lajur. Ini berbeda dengan perlakuan diulang di semua kombinasi baris dan lajur.  Jika perlakuan diulang di semua kombinasi baris dan lajur, perlu $r^2\\cdot t$ unit percobaan.\n\nJumlah unit percobaan tersebut akan menjadi sangat besar jika perlakuan hendak ditambah. Dengan $r$ kelompok atau ulangan, hanya perlu $r$ unit percobaan tambahan untuk menambah satu perlakuan. Sedangkan, di RBSL, $(r+1)^2-r^2=r^2+2r+1-r^2=2r+1$, perlu $2r+1$ unit percobaan tambahan. Jumlah tersebut akan menjadi sangat besar jika perlakuan makin banyak.\n\nSelain itu, rumus derajat bebas galat bagi RBSL adalah $(r-1)(r-2)$. Ini memiliki beberapa implikasi. Pertama, jumlah minimal perlakuan adalah dua karena jika tidak derajat bebas galat akan nol. KTG akan menjadi tak terdefinsi. Dalam kasus perlakuan lebih dari dua, tetapi masih sedikit, db galat akan kecil.\n\nSelain itu, analisis akan kompleks jika ada data hilang atau salah penempatan baris. Diperlukan juga asumsi **tidak ada interaksi**. Pengaruh baris, perlakuan, dan lajur sama saja bagaimanapun kombinasinya.\n\nAkan dianlisis kasus RBSL sebagai berikut:\n\n>Percobaan tentang pengaruh pemberian pupuk dengan dosis yang berbeda (100, 200, 300, 400) dilakukan di daerah lereng pegunungan. Sumber keragaman unit percobaan secara garis besar dapat diklasifikasikan menjadi dua, yaitu kemiringan lahan dan arah irigasi. Kemiringan lahan dan arah irigasi dapat dikelompokkan masing-masing menjadi empat kelompok.\n\n### Pengacakan\n\nAlgoritme pengacakan RBSL sebagai berikut:\n\n1. Susun perlakuan pada arah diagonal secara acak.\n2. Acak penempatan baris.\n3. Acak penempatan lajur.\n\nAlgoritme tersebut dapat diterapkan di R menggunakan package agricolae atau package st4gi. Penerapan agricolae sebaga berikut:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(agricolae)\nperlakuanBSL<-seq(100,400,100)\nbaganBSL<-design.lsd(trt=perlakuanBSL) #masukkan perlakuan\nknitr::kable(baganBSL$sketch)\n```\n\n::: {.cell-output-display}\n|    |    |    |    |\n|:---|:---|:---|:---|\n|400 |200 |300 |100 |\n|200 |400 |100 |300 |\n|300 |100 |200 |400 |\n|100 |300 |400 |200 |\n:::\n:::\n\n\nSedangkan, penerapan st4gi sebagai berikut:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(st4gi)\nbaganBSL2<-cr.lsd(geno=perlakuanBSL) #geno=perlakuan\nknitr::kable(baganBSL2$book)\n```\n\n::: {.cell-output-display}\n| plot.num| row| col| geno|\n|--------:|---:|---:|----:|\n|        1|   1|   1|  300|\n|        2|   1|   2|  400|\n|        3|   1|   3|  100|\n|        4|   1|   4|  200|\n|        5|   2|   4|  300|\n|        6|   2|   3|  200|\n|        7|   2|   2|  100|\n|        8|   2|   1|  400|\n|        9|   3|   1|  200|\n|       10|   3|   2|  300|\n|       11|   3|   3|  400|\n|       12|   3|   4|  100|\n|       13|   4|   4|  400|\n|       14|   4|   3|  300|\n|       15|   4|   2|  200|\n|       16|   4|   1|  100|\n:::\n:::\n\n\nJika dilihat, perlakuan hanya muncul sekali di tiap baris dan di tiap lajur, sesuai batasan pengacakan yang dijelaskan sebelumnya.\n\n#### Pengacakan edibble\n\nDalam RBSL, ada lajur dan baris. Dalam kasus ini lajur dan baris adalah kemiringan dan lahan. Lalu, tiap petak berada di antara suatu kombinasi kemiringan dan lahan. Oleh karena itu, gunakan `crossed_by(kemiringan,lahan)` dalam pendefinisian petak.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(edibble)\n\ndesRBSL<-design(name=\"Pengaruh dosis pupuk di lereng\") %>%\n  set_units(kemiringan=4,\n            irigasi=4,\n            petak=crossed_by(kemiringan,irigasi)) %>%\n  set_trts(dosis=perlakuanBSL) %>%\n  allot_trts(dosis ~ petak) %>%\n  assign_trts(\"random\", seed=420) %>% serve_table\n\nknitr::kable(head(desRBSL,n=10))\n```\n\n::: {.cell-output-display}\n|kemiringan  |irigasi  |petak   |dosis |\n|:-----------|:--------|:-------|:-----|\n|kemiringan1 |irigasi1 |petak1  |100   |\n|kemiringan2 |irigasi1 |petak2  |200   |\n|kemiringan3 |irigasi1 |petak3  |400   |\n|kemiringan4 |irigasi1 |petak4  |300   |\n|kemiringan1 |irigasi2 |petak5  |400   |\n|kemiringan2 |irigasi2 |petak6  |300   |\n|kemiringan3 |irigasi2 |petak7  |100   |\n|kemiringan4 |irigasi2 |petak8  |200   |\n|kemiringan1 |irigasi3 |petak9  |200   |\n|kemiringan2 |irigasi3 |petak10 |400   |\n:::\n:::\n\n\nHasil pengacakan dapat digambarkan:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndeggust::autoplot(desRBSL)\n```\n\n::: {.cell-output-display}\n![](02-Bab2_files/figure-html/unnamed-chunk-59-1.png){width=672}\n:::\n:::\n\n`\nBandingkan dengan `menu_lsd`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlsd <- takeout(menu_lsd(t = 4,seed=420))\nexamine_recipe(lsd)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndesign(\"Latin Square Design\") %>%\n  set_units(row = 4,\n            col = 4,\n            unit = crossed_by(row, col)) %>%\n  set_trts(trt = 4) %>%\n  allot_trts(trt ~ unit) %>%\n  assign_trts(\"random\", seed = 420) %>%\n  serve_table()\n```\n:::\n:::\n\n\nPembuatan rancangan sama. Plot juga sama:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndeggust::autoplot(lsd)\n```\n\n::: {.cell-output-display}\n![](02-Bab2_files/figure-html/unnamed-chunk-61-1.png){width=672}\n:::\n:::\n\n\n### Model\n\nModel linier aditif dari RBSL adalah:\n\n\n$$\nY_{ij(k)}=\\mu+\\alpha_{i}+\\beta_{j}+\\tau{k}+\\varepsilon_{ij(k)} \n$$\n\n\ndengan keterangan: \t$i = 1,2,…,r$  ;  $j = 1,2,…,r$  ; $k = 1,2,…,r$  (dalam kata lain, jumlah perlakuan, lajur, dan baris sama) ;  $\\varepsilon_{ij(k)}\\sim N(0, \\sigma^2)$, dan:\n\n1. $Y_{ij(k)}$ \t= nilai pengamatan pada perlakuan ke-k dalam baris ke-i, lajur ke-j\n2.$\\mu$= rataan umum\n3.$\\alpha_{i}$= pengaruh baris ke-i \n4.$\\beta_{j}$= pengaruh lajur ke-j \n5.$\\tau_{(k)}$= pengaruh perlakuan ke-k dalam baris ke-i, lajur ke-j\n6.$\\varepsilon_{ij(k)}$= pengaruh acak pada perlakuan ke-k dalam baris ke-i, lajur ke-j\n\nAsumsi sama seperti RAKL, ditambah $\\sum_{i=1}^t \\alpha_{i}=0$ untuk model tetap dan $\\alpha_{i}\\sim N(0,\\sigma_{\\alpha}^2)$ untuk model acak. $\\alpha_{i}$ diduga $\\bar{y}_{i.(.)}-\\bar{y}_{..(.)}$ dari hasil penurunan MKT.\n\n### ANOVA\n\nHipotesis yang diuji sama dengan RAKL, dengan tambahan hipotesis mengenai pengaruh baris. Hipotesis pertama adalah mengenai **pengaruh perlakuan**:\n\n$$\n\\begin{align}\nH_{0}&:\\tau_{1}=...=\\tau_{r}=0\\\\\nH_{1}&:\\text{ Setidaknya ada satu i di mana } \\tau_{i}\\neq 0\n\\end{align}\n$$\n\nYaitu, bahwa semua perlakuan tidak berpengaruh atau sebaliknya, terdapat sedikitnya satu perlakuan yang berpengaruh. Lalu, itu, ada hipotesis mengenai **pengaruh lajur**, atau kelompok:\n\n$$\n\\begin{align}\nH_{0}&:\\beta_{1}=...=\\beta_{r}=0\\\\\nH_{1}&:\\text{ Setidaknya ada satu j di mana } \\beta_{j}\\neq 0\n\\end{align}\n$$\n\nDengan interpretasi yang sama seperti hipotesis sebelumnya. Hipotesis yang ditambah RBSL adalah pengaruh baris:\n\n$$\n\\begin{align}\nH_{0}&: \\alpha_{1}=...=\\alpha_{r}=0\\\\\nH_{1}&: \\text{ Setidaknya ada satu i di mana }\\alpha_{i}\\neq 0\n\\end{align}\n$$\n\n\nHipotesis tersebut diuji dengan uji-F, yang disimpulkan di tabel sidik ragam:\n\n::: {.cell}\n\n```{.r .cell-code}\n  cat('\n  | Sumber Keragaman| db| JK| KT| F-hit|F(dbP,dbG)|\n  |------------:|-----------:|------------:|------------:|------------:|------------:|\n  |          Perlakuan|         r-1|          JKP| JKP/dbP | KTP/KTG | |\n  |          Baris|         r-1|          JKB| JKB/dbB | KTB/KTG | |\n  |          Lajur|         r-1|          JKL| JKL/dbL | KTL/KTG | |\n  |          Galat|         (r-1)(r-2)|         JKG| JKG/dbG | | |\n  |          Total|         r*r-1|          JKT| | | |')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  | Sumber Keragaman| db| JK| KT| F-hit|F(dbP,dbG)|\n  |------------:|-----------:|------------:|------------:|------------:|------------:|\n  |          Perlakuan|         r-1|          JKP| JKP/dbP | KTP/KTG | |\n  |          Baris|         r-1|          JKB| JKB/dbB | KTB/KTG | |\n  |          Lajur|         r-1|          JKL| JKL/dbL | KTL/KTG | |\n  |          Galat|         (r-1)(r-2)|         JKG| JKG/dbG | | |\n  |          Total|         r*r-1|          JKT| | | |\n```\n:::\n:::\n\nRumus-rumus jumlah kuadrat di tabel sidik ragam tersebut adalah:\n\n$$\n\\begin{align}\nFK&=\\frac{y_{..}^2}{r^2}\\\\\nJK_{T}&=\\sum_{i=1}^r \\sum_{j=1}^r\\sum_{k=1}^r\\left[y_{ij(k)}-\\bar{y}_{..(.)}\\right]^2=\\sum_{i=1}^r \\sum_{j=1}^r \\sum_{k=1}^r y_{ij(k)}^2-FK\\\\\nJK_{P}&=\\sum_{i=1}^r \\sum_{j=1}^r\\sum_{k=1}^r\\left[\\bar{y}_{..(k)}-\\bar{y}_{..(.)}\\right]^2=\\sum_{k=1}^r \\frac{y_{..(k)}^2}{r}-FK\\\\\nJK_{B}&=\\sum_{i=1}^r \\sum_{j=1}^r\\sum_{k=1}^r\\left[\\bar{y}_{i.(.)}-\\bar{y}_{..(.)}\\right]^2=\\sum_{i=1}^r \\frac{y_{i.(.)}^2}{r}-FK\\\\\nJK_{L}&=\\sum_{i=1}^r \\sum_{j=1}^r\\sum_{k=1}^r\\left[\\bar{y}_{.j(.)}-\\bar{y}_{..(.)}\\right]^2=\\sum_{j=1}^r \\frac{y_{.j(.)}^2}{r}-FK\\\\\nJK_{G}&=JK_{T}-JK_{P}-JK_{B}-JK_{L}\n\\end{align}\n$$\n\nPada intinya, jumlah kuadrat tiap faktor (perlakuan, baris, atau lajur) dihitung dengan mencari total semua observasi dengan taraf-taraf tertentu dari faktor tersebut. Lalu, total tersebut dikuadratkan dan dibagi jumlah perlakuan, baris, atau lajur, dan hasil tersebut dijumlahkan sesuai jumlah tersebut.\n\n### Implementasi R dan Python\n\nRelatif jelas bahwa rancangan yang tepat digunakan adalah RBSL. [Data](https://docs.google.com/spreadsheets/d/1c9dvm4p747hX9nS3y6mMSCgGSoJMQCQiVXyz3g7R7IE/edit?usp=sharing) ditautkan. Analisis dimulai dengan membaca data tersebut:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(googlesheets4)\ndataRBSL<-read_sheet(\"https://docs.google.com/spreadsheets/d/1c9dvm4p747hX9nS3y6mMSCgGSoJMQCQiVXyz3g7R7IE/edit?usp=sharing\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ Reading from \"RBSL_P2 Rancob\".\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ Range 'Sheet1'.\n```\n:::\n\n```{.r .cell-code}\nknitr::kable(dataRBSL)\n```\n\n::: {.cell-output-display}\n|Miring |Irigasi |Pupuk | Produksi|\n|:------|:-------|:-----|--------:|\n|M1     |I1      |P1    |      5.6|\n|M1     |I2      |P3    |      4.3|\n|M1     |I3      |P2    |      4.8|\n|M1     |I4      |P4    |      5.3|\n|M2     |I1      |P2    |      5.9|\n|M2     |I2      |P1    |      6.0|\n|M2     |I3      |P4    |      5.8|\n|M2     |I4      |P3    |      5.2|\n|M3     |I1      |P3    |      4.3|\n|M3     |I2      |P4    |      4.9|\n|M3     |I3      |P1    |      4.8|\n|M3     |I4      |P2    |      5.2|\n|M4     |I1      |P4    |      3.9|\n|M4     |I2      |P2    |      4.9|\n|M4     |I3      |P3    |      3.8|\n|M4     |I4      |P1    |      4.7|\n:::\n:::\n\n\nSetelah memastikan perlakuan, lajur, dan baris berbentuk faktor, tinggal dilakukan anova. Penambahan faktor baru di ANOVA relatif mudah, yaitu dengan +.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataRBSL$Miring<-as.factor(dataRBSL$Miring)\ndataRBSL$Irigasi<-as.factor(dataRBSL$Irigasi)\ndataRBSL$Pupuk<-as.factor(dataRBSL$Pupuk)\nRBSLAoV<-aov(Produksi~Miring+Irigasi+Pupuk,dataRBSL) #respon~perlakuan+baris+lajur,dataset\nsummary(RBSLAoV)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value  Pr(>F)   \nMiring       3  4.062  1.3542  12.897 0.00502 **\nIrigasi      3  0.203  0.0675   0.643 0.61504   \nPupuk        3  1.882  0.6275   5.976 0.03106 * \nResiduals    6  0.630  0.1050                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nGunakan statsmodels untuk analisis di python:\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport pandas as pd\nimport statsmodels.api as sm\nfrom statsmodels.formula.api import ols\n\nRBSLpy=pd.read_csv(\"https://docs.google.com/spreadsheets/d/e/2PACX-1vQySAMPOlmbObWHA9ZQS80gwsjJCILoRPIOfZDn1KWRu8FkR5XlL1G7hDI7uA5i_T8TwNJ1FIcwuuDD/pub?gid=0&single=true&output=csv\")\nRBSLlm= ols('Produksi ~ C(Irigasi)+C(Miring)+C(Pupuk)',data=RBSLpy).fit() #C=peubah kategorik\ntable = sm.stats.anova_lm(RBSLlm, typ=2) # Type 2 ANOVA DataFrame\nprint(table)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            sum_sq   df          F    PR(>F)\nC(Irigasi)  0.2025  3.0   0.642857  0.615037\nC(Miring)   4.0625  3.0  12.896825  0.005020\nC(Pupuk)    1.8825  3.0   5.976190  0.031062\nResidual    0.6300  6.0        NaN       NaN\n```\n:::\n:::\n\n\nAnalisis diawali dengan membaca CSV melalui pandas. C(faktor) digunakan agar faktor dalan percobaan dianggap peubah kategorik. Hasil dari ANOVA tersebut menunjukkan bahwa Pupuk memiliki p-value sekitar $3\\%$, yang berarti kemungkinan menemukan nilai-F tersebut jika $H_{0}$ benar sebesar $3\\%$. Jika digunakan $\\alpha=5\\%$, $H_{0}$ akan ditolak dan setidaknya salah satu pengaruh perlakuan (Pupuk) tidak nol. P-value kemiringan lebih kecil lagi. Dengan prosedur sama, dapat diinterpretasikan bahwa setidaknya salah satu pengaruh kemiringan tidak nol. Namun, belum cukup bukti untuk menyatakan bahwa setidaknya salah satu pengaruh irigasi tidak nol.\n\n### Topik Tambahan\n\n#### Pendugaan Nilai Hilang\nRumus pendugaan nilai hilang di RBSL adalah sebagai berikut:\n\n$$\n\\hat{y}_{ij(k)}=\\frac{p(y_{i.}+y_{.j}+T_{(k)})-2y_{..}}{(p-1)(p-2)}\n$$\n\nNilai-nilai yang diperlukan dapat diekstrak manual dan dihitung, sama seperti sebelumnya.\n\n#### Plot interaksi\nPlot interaksi dapat dibuat dengan cara sama seperti RAKL.",
    "supporting": [
      "02-Bab2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}