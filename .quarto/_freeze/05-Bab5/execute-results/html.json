{
  "hash": "42a92c7516a17366b6b901e89a338755",
  "result": {
    "markdown": "# Rancangan Faktorial\n\nDi kebanyakan aplikasi percangan percobaan, ada lebih dari satu faktor yang memengaruhi respon tertentu. Misal, produksi suatu petak tanah ditentukan oleh pemupukan, varietas yang ditanam, irigasi, dan lain-lain. Bahkan, pengujian pengaruh satu faktor belum tentu valid jika level faktor-faktor lain berbeda. Misal, dalam kondisi irigasi yang cukup, varietas yang berbeda akan memiliki produktivitas berbeda. Namun, irigasi yang tidak cukup akan menyebabkan semua varietas mati kekurangan air sehingga produksi semua varietas sama-sama nol. Contoh tersebut cukup ekstrim, tetapi intinya adalah respon merupakan akibat dari berbagai faktor secara simultan, tidak terpisah (**interaksi**). Belum tentu, misal, tambahan pemumpukan 1 $kg$ selalu menambah produktivitas 1 $kg/ha$ - efek tersebut mungkin lebih besar di kondisi tertentu (varietas yang reseptif pada pupuk, irigasi baik). Oleh karena itu, perlu rancangan percobaan dengan lebih dari satu faktor untuk beberapa aplikasi tertentu. Selain itu, semua **kombinasi** taraf faktor harus dicobakan, karena pengaruh taraf suatu faktor dapat berbeda-beda jika dipasangkan dengan taraf faktor lain yang berbeda.\n\nNote, hal ini berarti faktor-faktor harus bersilang, tidak bersarang. Jika level faktor tertentu hanya muncul saat faktor memiliki level tertentu juga, tidak dapat diuji semua kombinasi perlakuan. Jika saat kerapatan tanaman tinggi, misal, varietas tertentu tidak dapat ditanam, tidak mungkin dilakukan rancangan faktorial.\n\n## Faktorial RAL\n\n### Pembuatan bagan percobaan\n\nKarena perlakuan di suatu percobaan faktorial merupakan semua kombinasi taraf faktor yang diteliti, pembuatan bagan percobaan diawali dengan penjabaran taraf-taraf faktor tersebut. Lalu digunakan fungsi expand.grid dari package data.table untuk mengkombinasikan taraf-taraf faktor:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(data.table)\ntrt1<-c(\"A\",\"B\",\"C\")\ntrt2<-c(\"D\",\"E\",\"F\")\nperlakuan<-data.frame(expand.grid(trt1,trt2)) #buat kombinasi\ncolnames(perlakuan)<-c(\"Faktor 1\", \"Faktor 2\") #penamaan faktor, berupa kosmetik\nknitr::kable(perlakuan)\n```\n\n::: {.cell-output-display}\n|Faktor 1 |Faktor 2 |\n|:--------|:--------|\n|A        |D        |\n|B        |D        |\n|C        |D        |\n|A        |E        |\n|B        |E        |\n|C        |E        |\n|A        |F        |\n|B        |F        |\n|C        |F        |\n:::\n:::\n\n\nTerlihat bahwa tiap baris merupakan kombinasi unik dari taraf faktor satu dan dua. Jumlah baris juga tepat, yaitu $3 \\times 3=9$. Lalu, kode bagi tiap kombinasi tersebut dapat diekstraksi dan dibuat. Tiap kombinasi dapat dikodekan dengan angka, atau dengan teks yang merupakan gabungan dari nama taraf faktor pertama dan kedua.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nperlakuan$kode<-seq(1,nrow(perlakuan)) #angka\nperlakuan$kode2<-paste(perlakuan$`Faktor 1`,perlakuan$`Faktor 2`,sep=\"\") #gabungan nama taraf; sep=pemisah -> \"\" berarti tak ada pemisah\nknitr::kable(perlakuan)\n```\n\n::: {.cell-output-display}\n|Faktor 1 |Faktor 2 | kode|kode2 |\n|:--------|:--------|----:|:-----|\n|A        |D        |    1|AD    |\n|B        |D        |    2|BD    |\n|C        |D        |    3|CD    |\n|A        |E        |    4|AE    |\n|B        |E        |    5|BE    |\n|C        |E        |    6|CE    |\n|A        |F        |    7|AF    |\n|B        |F        |    8|BF    |\n|C        |F        |    9|CF    |\n:::\n:::\n\n\nLalu, buat saja bagan tersebut melalui design.crd (RAL) di library agricolae. Masukkan jumlah ulangan yang diinginkan juga. Akan ditunjukkan sepuluh unit percobaan pertama sebagai ilustrasi:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(agricolae)\nbaganFRAL<-design.crd(trt=perlakuan$kode2,r=4,seed=16,serie=0)\n\n#akses output -> hasil design.crd$book\nknitr::kable(head(baganFRAL$book,n=10))\n```\n\n::: {.cell-output-display}\n| plots|  r|perlakuan$kode2 |\n|-----:|--:|:---------------|\n|     1|  1|AF              |\n|     2|  1|CD              |\n|     3|  1|BD              |\n|     4|  1|CE              |\n|     5|  1|CF              |\n|     6|  1|AE              |\n|     7|  2|AF              |\n|     8|  3|AF              |\n|     9|  2|CD              |\n|    10|  2|CE              |\n:::\n:::\n\n\nDapat diverifikasi bahwa jumlah unit percobaan merupakan $9 \\times 4=36$.\n\n::: {.cell}\n\n```{.r .cell-code}\nnrow(baganFRAL$book)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 36\n```\n:::\n:::\n\n\n#### Pengacakan edibble\n\nKarena rancangan pengendalian lingkungan berupa RAL, hanya ada satu jenis unit. Lalu, ada dua perlakuan di `set_trts` yang semuanya dialokasikan ke unit secara bersamaan. Oleh karena itu, tulis `c(P1.,P2.)` untuk menggabungkan kedua perlakuan, lalu `allot_trts(c(P1.,P2.)~unit)` untuk mengalokasikan semua kombinasi perlakuan tersebut ke unit.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(edibble)\n\ndesFaktRAL<-design(name=\"Faktorial RAL\") %>%\n  set_units(unit=36) %>%\n  set_trts(P1.=trt1,\n           P2.=trt2) %>%\n  allot_trts(c(P1.,P2.) ~unit) %>%\n  assign_trts(\"random\", seed=420) %>% serve_table\n\nknitr::kable(head(desFaktRAL,n=10))\n```\n\n::: {.cell-output-display}\n|unit   |P1. |P2. |\n|:------|:---|:---|\n|unit1  |C   |E   |\n|unit2  |B   |D   |\n|unit3  |A   |E   |\n|unit4  |C   |F   |\n|unit5  |A   |D   |\n|unit6  |C   |F   |\n|unit7  |A   |D   |\n|unit8  |B   |D   |\n|unit9  |B   |F   |\n|unit10 |A   |E   |\n:::\n:::\n\n\nLalu, plot-kan:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndeggust::autoplot(desFaktRAL)\n```\n\n::: {.cell-output-display}\n![](05-Bab5_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nBandingkan dengan default edibble:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfac <- takeout(menu_factorial(trt = c(3, 3), r=4, seed=420))\nexamine_recipe(fac)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndesign(\"Factorial Design\") %>%\n  set_units(unit = 36) %>%\n  set_trts(trt1 = 3,\n           trt2 = 3) %>%\n  allot_trts(~unit) %>%\n  assign_trts(\"random\", seed = 420) %>%\n  serve_table()\n```\n:::\n\n```{.r .cell-code}\ndeggust::autoplot(fac)\n```\n\n::: {.cell-output-display}\n![](05-Bab5_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nCara pembuatan dan plot sama di kedua kasus.\n\n### Model Linear Aditif\n\nModel bagi faktorial RAL adalah sebagai berikut:\n\n$$\ny_{ijk}=\\mu+\\alpha_i+\\beta_j+(\\alpha\\beta)_{ij}+\\varepsilon_{ijk}\n$$\n\n\nDengan:\n\n1. $Y_{ijk}$ adalah nilai pengamatan pada faktor A taraf ke-i dan faktor B taraf ke-j pada ulangan ke-k.\n2. $\\mu$ adalah komponen aditif dari rataan umum.\n3. $\\alpha_i$ adalah komponen aditif dari pengaruh faktor A pada taraf ke-i.\n4. $\\beta_j$ adalah komponen aditif dari pengaruh faktor B pada taraf ke-j.\n5. $(\\alpha\\beta)_{ij}$ adalah komponen interaksi faktor A dan faktor B.\n6. $\\varepsilon_{ijk}\\sim N(0,\\sigma_\\varepsilon^2)$ adalah komponen acak pada tiap pengamatan\n\nOleh karena itu, terdapat tiga hipotesis yang diuji, yaitu hipotesis mengenai pengaruh faktor A, pengaruh faktor B, dan pengaruh interaksi:\n\n\n$$\n\\begin{aligned}\n&\\textbf{Pengaruh faktor A:}\\\\\nH_0&: \\alpha_1=\\cdots=\\alpha_a=0 \\\\\n&\\text{ (faktor A tidak berpengaruh pada respon yang diamati)}\\\\\nH_1&: \\text{paling sedikit ada satu i di mana }\\alpha_i\\neq0\\\\\n\\\\\n&\\textbf{Pengaruh faktor B:}\\\\\nH_0&: \\beta_1=\\cdots=\\beta_b=0 \\\\\n& \\text{ (faktor B tidak berpengaruh pada respon yang diamati)}\\\\\nH_1&: \\text{paling sedikit ada satu j di mana }\\beta_j\\neq0\\\\\n\\\\\n&\\textbf{Pengaruh interaksi:}\\\\\nH_0&: (\\alpha\\beta)_{11}=(\\alpha\\beta)_{12}=\\cdots=(\\alpha\\beta)_{ab}=0 \\\\\n& \\text{ (Interaksi faktor A dan B tidak berpengaruh pada respon yang diamati)}\\\\\nH_1&: \\text{paling sedikit ada sepasang } (i,j) \\text{ di mana }(\\alpha\\beta)_{ij}\\neq0\n\n\\end{aligned}\n$$\n\n\nHipotesis tersebut diuji dengan uji-F, yang disimpulkan di tabel sidik ragam:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n  cat('\n  | Sumber Keragaman| db| JK| KT| F-hit|F(dbP,dbG)|\n  |------------:|-----------:|------------:|------------:|------------:|------------:|\n  |         A|         a-1|          JKA| JKP/dbA | KTA/KTG | |\n  |         B|         b-1|          JKB| JKB/dbB | KTB/KTG | |\n  |         A*B|         (a-1)(b-1)|          JKAB| JKAB/dbAB | KTAB/KTG | |\n  |          Galat|         ab(r-1)|         JKG| JKG/dbG | | |\n  |          Total|         abr-1|          JKT| | | |')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  | Sumber Keragaman| db| JK| KT| F-hit|F(dbP,dbG)|\n  |------------:|-----------:|------------:|------------:|------------:|------------:|\n  |         A|         a-1|          JKA| JKP/dbA | KTA/KTG | |\n  |         B|         b-1|          JKB| JKB/dbB | KTB/KTG | |\n  |         A*B|         (a-1)(b-1)|          JKAB| JKAB/dbAB | KTAB/KTG | |\n  |          Galat|         ab(r-1)|         JKG| JKG/dbG | | |\n  |          Total|         abr-1|          JKT| | | |\n```\n:::\n:::\n\n\nDi mana jumlah kuadrat tersebut dihitung dengan:\n\n$$\n\\begin{align*}\nFK&=\\frac{y^2_{...}}{abr}\\\\\nJKT&=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k=1}^r\\left(y_{ijk}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k=1}^r y_{ijk}^2-FK\\\\\nJKA&=\\sum_{i=1}^a\\left(\\bar{y}_{i..}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a \\frac{y_{i..}^2}{br}-FK\\\\\nJKB&=\\sum_{j=1}^b\\left(\\bar{y}_{.j.}-\\bar{y}_{...}\\right)^2=\\sum_{j=1}^b \\frac{y_{.j.}^2}{ar}-FK\\\\\nJKP&=\\sum_{i=1}^a\\sum_{j=1}^b\\left(\\bar{y}_{ij.}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{j=1}^b \\frac{y_{ij.}^2}{r}-FK\\\\\nJKAB&=\\sum_{i=1}^a\\sum_{j=1}^b\\left(\\bar{y}_{ij.}-\\bar{y}_{i..}-\\bar{y}_{.j.}+\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{j=1}^b\\left(\\bar{y}_{ij.}-\\bar{y}_{...}\\right)^2-JKA-JKB\\\\\n&=JKP-JKB-JKA\\\\\nJKG&=JKP-JKT\n\\end{align*}\n$$\n\n\n### ANOVA dengan R\n\nAkan digunakan kasus berikut dari Mattjik dan Sumertajaya:\n\n> Balai Karantina ingin mengetahui pengaruh pemberian fumigasi dengan berbagai dosis (0, 16, 32, 48, 64; $g/m^3$) dengan lama fumigasi yang berbeda (2 dan 4 jam) terhadap daya kecambah benih tomat. Metode perkecambahan yang digunakan adalah *Growing on Test*. Unit percobaan diasumsikan homogen.\n\nPertama, baca data terlebih dahulu:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(googlesheets4)\n\nFact<-read_sheet(\"https://docs.google.com/spreadsheets/d/1HuYXEBHlpJCXY2v-XJfmiUoFSN05plULDE1T7E1vnPo/edit?usp=sharing\")\nknitr::kable(Fact)\n```\n\n::: {.cell-output-display}\n| LamaFumigasi| Ulangan| Dosis Fumigan| ...4| ...5| ...6| ...7|\n|------------:|-------:|-------------:|----:|----:|----:|----:|\n|           NA|      NA|             0|   16|   32|   48|   64|\n|            2|       1|            96|   92|   92|   74|   50|\n|            2|       2|            98|   88|   94|   74|   50|\n|            2|       3|            94|   90|   84|   68|   54|\n|            4|       1|            90|   88|   78|    0|    0|\n|            4|       2|            94|   92|   82|    0|    0|\n|            4|       3|            92|   94|   74|    0|    0|\n:::\n:::\n\n\nTerlihat bahwa baris pertama merupakan taraf-taraf dari faktor dosis. Oleh karena itu, baris tersebut sebaiknya dihilangkan. Selain itu, kolom ketiga sampai terakhir hendak diberi nama sesuai dosis diberikan.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFact<-read_sheet(\"https://docs.google.com/spreadsheets/d/1HuYXEBHlpJCXY2v-XJfmiUoFSN05plULDE1T7E1vnPo/edit?usp=sharing\")[-1,]\ncolnames(Fact)[seq(3,ncol(Fact))]<-seq(0,64,16)\n```\n:::\n\n\nLalu, data tersebut dirubah ke format *long* di mana tiap baris menunjukkan unit percobaan individu, bukan kombinasi nama ulangan dan dosis fumigasi. Seperti biasa, id.vars merupakan pembeda individu di format wide awal (dalam kasus ini, tiap individu adalah kombinasi LamaFumigasi dan Ulangan). Lalu, value.vars merupakan kolom-kolom yang digabung menjadi satu, dalam kasus ini dosis-dosis dari 0 sampai 64.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(reshape2)\n\nFact2<-melt(Fact,\n               #variabel yang membedakan tiap baris di tabulasi asli:\n               id.vars=c(\"LamaFumigasi\",\"Ulangan\"),\n               value.vars=seq(0,64,16),\n               value.name=\"Perkecambahan\")\ncolnames(Fact2)[3]<-\"Dosis\" #kolom ketiga akan disebut \"variable\"\n```\n:::\n\n\nSetelah tabulasi data benar, pastikan tiap faktor sudah dibuat menjadi objek data yang benar; lakukan ANOVA dan lihat hasil:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFact2$LamaFumigasi<-as.factor(Fact2$LamaFumigasi)\nFact2$Dosis<-as.factor(Fact2$Dosis)\naovFact<-aov(Perkecambahan~LamaFumigasi+Dosis+LamaFumigasi:Dosis,Fact2)\nsummary(aovFact)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   Df Sum Sq Mean Sq F value   Pr(>F)    \nLamaFumigasi        1   5713    5713   691.1  < 2e-16 ***\nDosis               4  25459    6365   769.9  < 2e-16 ***\nLamaFumigasi:Dosis  4   6258    1565   189.3 1.37e-15 ***\nResiduals          20    165       8                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\nAnalisis di python dapat dilakukan dengan membaca CSV dan mengambil row ke-2 sampai akhir. Note bahwa indeks di Python dimulai dari 0, sehingga baris ke-2 dinotasikan dengan 1.\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport pandas as pd\n\nfum=pd.read_csv(\"https://docs.google.com/spreadsheets/d/1HuYXEBHlpJCXY2v-XJfmiUoFSN05plULDE1T7E1vnPo/export?gid=0&format=csv\")\nfumn=fum.iloc[1:]\n```\n:::\n\n\nLalu, ubah nama kolom:\n\n\n::: {.cell}\n\n```{.python .cell-code}\nprint(fumn.columns)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nIndex(['LamaFumigasi', 'Ulangan', 'Dosis Fumigan', 'Unnamed: 3', 'Unnamed: 4',\n       'Unnamed: 5', 'Unnamed: 6'],\n      dtype='object')\n```\n:::\n:::\n\n\nAmbil elemen pertama dan kedua (0, 1) - indexing di Python dimulai dari 0 dan berakhir di elemen $n-1$ sehingga ambil elemen [0:2]. Elemen tersebut diubah menjadi list. Lalu tambahkan angka 0, 16, 32, 48, 64 kepada list tersebut. Lalu masukkan list tersebut ke kolom-kolom dataset:\n\n\n::: {.cell}\n\n```{.python .cell-code}\nfumn.columns=list(fumn.columns[0:2])+[str(x) for x in range(0,80,16)]\nfumn.head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   LamaFumigasi  Ulangan   0  16  32  48  64\n1           2.0      1.0  96  92  92  74  50\n2           2.0      2.0  98  88  94  74  50\n3           2.0      3.0  94  90  84  68  54\n4           4.0      1.0  90  88  78   0   0\n5           4.0      2.0  94  92  82   0   0\n```\n:::\n:::\n\n\nMelt data:\n\n\n::: {.cell}\n\n```{.python .cell-code}\nFaktRALMelt=pd.melt(fumn, id_vars=['LamaFumigasi','Ulangan'], value_vars=[str(x) for x in range(0,80,16)])\n```\n:::\n\n\nLakukan ANOVA. Gunakan `*` untuk mendapat interaksi, dan `C()` untuk membuat peubah kategorik:\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport statsmodels.api as sm\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nC:\\Users\\Acer\\AppData\\Local\\R\\win-library\\4.2\\reticulate\\python\\rpytools\\loader.py:39: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n  module = _import(\nC:\\Users\\Acer\\AppData\\Local\\Programs\\Python\\PYTHON~2\\lib\\site-packages\\statsmodels\\compat\\pandas.py:65: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n  from pandas import Int64Index as NumericIndex\n```\n:::\n\n```{.python .cell-code}\nfrom statsmodels.formula.api import ols\n\nFaktRALlm= ols('value ~ C(LamaFumigasi)*C(variable)',data=FaktRALMelt)\nfitRAL=FaktRALlm.fit()\n\ntable = sm.stats.anova_lm(fitRAL) \nprint(table)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                               df        sum_sq  ...           F        PR(>F)\nC(LamaFumigasi)               1.0   5713.200000  ...  691.112903  5.527620e-17\nC(variable)                   4.0  25459.200000  ...  769.935484  1.367358e-21\nC(LamaFumigasi):C(variable)   4.0   6258.133333  ...  189.258065  1.370943e-15\nResidual                     20.0    165.333333  ...         NaN           NaN\n\n[4 rows x 5 columns]\n```\n:::\n:::\n\n\n\n### Tabel dan Plot Interaksi\n\nSekarang, dapat dicari rata-rata pengaruh perlakuan di tiap kombinasi faktor A dan B. Fungsi yang akan digunakan adalah aggregate dari base R. Argumen pertama merupakan fungsi agregasi yang ingin dilakukan - sintaks ini mirip dengan aov atau lm (respon~perlakuan), argumen kedua merupakan faktor, dan argumen terakhir merupakan fungsi agregasi yang dipakai (dalam kasus ini, mean):\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(aggregate(Perkecambahan~Dosis+LamaFumigasi,data=Fact2,FUN=mean))\n```\n\n::: {.cell-output-display}\n|Dosis |LamaFumigasi | Perkecambahan|\n|:-----|:------------|-------------:|\n|0     |2            |      96.00000|\n|16    |2            |      90.00000|\n|32    |2            |      90.00000|\n|48    |2            |      72.00000|\n|64    |2            |      51.33333|\n|0     |4            |      92.00000|\n|16    |4            |      91.33333|\n|32    |4            |      78.00000|\n|48    |4            |       0.00000|\n|64    |4            |       0.00000|\n:::\n:::\n\n\nLalu, buat tiap baris menjadi taraf faktor A (Lama Fumigasi), dan tiap kolom menjadi taraf faktor B. Gunakan fungsi dcast, dengan sintaks dcast(tabel, fungsi: baris~kolom, peubah respon).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSumTab<-reshape2::dcast(aggregate(Perkecambahan~Dosis+LamaFumigasi,data=Fact2,FUN=mean),LamaFumigasi~Dosis,value.var=\"Perkecambahan\") #(tabel: agregasi, fungsi: baris~kolom)\nknitr::kable(SumTab)\n```\n\n::: {.cell-output-display}\n|LamaFumigasi |  0|       16| 32| 48|       64|\n|:------------|--:|--------:|--:|--:|--------:|\n|2            | 96| 90.00000| 90| 72| 51.33333|\n|4            | 92| 91.33333| 78|  0|  0.00000|\n:::\n:::\n\n\nLalu, tambahkan rerata tiap baris (rowMeans). Namun, kolom pertama (lama fumigasi) tidak merupakan peubah respon dan tidak diperhitungkan:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSumTab$Rerata<-rowMeans(SumTab[,-1])\nknitr::kable(SumTab)\n```\n\n::: {.cell-output-display}\n|LamaFumigasi |  0|       16| 32| 48|       64|   Rerata|\n|:------------|--:|--------:|--:|--:|--------:|--------:|\n|2            | 96| 90.00000| 90| 72| 51.33333| 79.86667|\n|4            | 92| 91.33333| 78|  0|  0.00000| 52.26667|\n:::\n:::\n\n\nLalu, tambahkan rerata per kolom:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSumTab<-rbind(SumTab,colMeans(SumTab[,-1]))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in rbind(deparse.level, ...): number of columns of result, 7, is not a\nmultiple of vector length 6 of arg 2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in `[<-.factor`(`*tmp*`, ri, value = 94): invalid factor level, NA\ngenerated\n```\n:::\n\n```{.r .cell-code}\nknitr::kable(SumTab)\n```\n\n::: {.cell-output-display}\n|LamaFumigasi |        0|       16| 32|       48|       64|   Rerata|\n|:------------|--------:|--------:|--:|--------:|--------:|--------:|\n|2            | 96.00000| 90.00000| 90| 72.00000| 51.33333| 79.86667|\n|4            | 92.00000| 91.33333| 78|  0.00000|  0.00000| 52.26667|\n|NA           | 90.66667| 84.00000| 36| 25.66667| 66.06667| 94.00000|\n:::\n:::\n\n\nTabel rata-rata perlakuan telah terbentuk. Tabel ini dapat digunakan untuk pembuatan plot interaksi secara manual. Di R, plot interaksi dibuat dengan:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninteraction.plot(Fact2$Dosis, Fact2$LamaFumigasi, Fact2$Perkecambahan) #(faktor 1, faktor 2, respon)\n```\n\n::: {.cell-output-display}\n![](05-Bab5_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\nAtau, dapat dibuat plot interaksi melalui library phia. Library phia hanya menerima input berupa lm - ubah olah data menggunakan lm terlebih dahulu. Phia menyediakan tabel rata-rata perlakuan, serta dapat di-plotkan menjadi plot interaksi.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(phia)\nmod<-lm(Perkecambahan~LamaFumigasi+Dosis+LamaFumigasi:Dosis,data=Fact2)\nim=interactionMeans(mod)\nknitr::kable(im) # tabel\n```\n\n::: {.cell-output-display}\n|LamaFumigasi |Dosis | adjusted mean| std. error|\n|:------------|:-----|-------------:|----------:|\n|2            |0     |      96.00000|   1.659987|\n|4            |0     |      92.00000|   1.659987|\n|2            |16    |      90.00000|   1.659987|\n|4            |16    |      91.33333|   1.659987|\n|2            |32    |      90.00000|   1.659987|\n|4            |32    |      78.00000|   1.659987|\n|2            |48    |      72.00000|   1.659987|\n|4            |48    |       0.00000|   1.659987|\n|2            |64    |      51.33333|   1.659987|\n|4            |64    |       0.00000|   1.659987|\n:::\n\n```{.r .cell-code}\nplot(im) # plot\n```\n\n::: {.cell-output-display}\n![](05-Bab5_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n### Uji lanjut\n\nUji lanjut dapat dilakukan dengan library emmeans. Pada dasarnya, emmeans menghasilkan output yang mirip dengan uji lanjut seperti TukeyHSD:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(emmeans)\nmarginal = emmeans(mod,~ LamaFumigasi:Dosis)\nknitr::kable(head(pairs(marginal,adjust=\"Tukey\"),n=5))\n```\n\n::: {.cell-output-display}\n|contrast                                    | estimate|       SE| df|  t.ratio|   p.value|\n|:-------------------------------------------|--------:|--------:|--:|--------:|---------:|\n|LamaFumigasi2 Dosis0 - LamaFumigasi4 Dosis0 |        4| 2.347576| 20| 1.703885| 0.1038913|\n:::\n\n```{.r .cell-code}\nknitr::kable(head(TukeyHSD(aovFact, conf.level=.95)$`LamaFumigasi:Dosis`),n=5) #metode tukey, tapi bisa saja cara lain seperti bonferroni\n```\n\n::: {.cell-output-display}\n|         |       diff|       lwr|        upr|     p adj|\n|:--------|----------:|---------:|----------:|---------:|\n|4:0-2:0  |  -4.000000| -12.31302|   4.313018| 0.7813125|\n|2:16-2:0 |  -6.000000| -14.31302|   2.313018| 0.2987279|\n|4:16-2:0 |  -4.666667| -12.97968|   3.646352| 0.6158480|\n|2:32-2:0 |  -6.000000| -14.31302|   2.313018| 0.2987279|\n|4:32-2:0 | -18.000000| -26.31302|  -9.686982| 0.0000082|\n|2:48-2:0 | -24.000000| -32.31302| -15.686982| 0.0000001|\n:::\n:::\n\n\nUrutan pengurangannya berbeda saja, sehingga hasil emmeans memiliki beda positif dan TukeyHSD memiliki beda negatif. Library multcomp memiliki output yang lebih rapi, yaitu langsung berupa pengelompokan:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(multcomp)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: mvtnorm\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: survival\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: TH.data\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: MASS\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'TH.data'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:MASS':\n\n    geyser\n```\n:::\n\n```{.r .cell-code}\nknitr::kable(cld(marginal,\nalpha=0.05,\nLetters=letters, \nadjust=\"tukey\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: adjust = \"tukey\" was changed to \"sidak\"\nbecause \"tukey\" is only appropriate for one set of pairwise comparisons\n```\n:::\n\n::: {.cell-output-display}\n|   |LamaFumigasi |Dosis |   emmean|       SE| df| lower.CL|  upper.CL|.group |\n|:--|:------------|:-----|--------:|--------:|--:|--------:|---------:|:------|\n|8  |4            |48    |  0.00000| 1.659987| 20| -5.21784|   5.21784|a      |\n|10 |4            |64    |  0.00000| 1.659987| 20| -5.21784|   5.21784|a      |\n|9  |2            |64    | 51.33333| 1.659987| 20| 46.11549|  56.55117|b      |\n|7  |2            |48    | 72.00000| 1.659987| 20| 66.78216|  77.21784|c      |\n|6  |4            |32    | 78.00000| 1.659987| 20| 72.78216|  83.21784|c      |\n|3  |2            |16    | 90.00000| 1.659987| 20| 84.78216|  95.21784|d      |\n|5  |2            |32    | 90.00000| 1.659987| 20| 84.78216|  95.21784|d      |\n|4  |4            |16    | 91.33333| 1.659987| 20| 86.11549|  96.55117|d      |\n|2  |4            |0     | 92.00000| 1.659987| 20| 86.78216|  97.21784|d      |\n|1  |2            |0     | 96.00000| 1.659987| 20| 90.78216| 101.21784|d      |\n:::\n:::\n\n\nSelain itu, dapat diuji kontras orthogonal dari data ini. Karena hanya ada dua taraf untuk lama fumigasi, kontras hanya dapat dibuat untuk dosis. Misal dibuat kontras untuk membandingkan pengaruh ada dosis (dosis 0 vs lainnya), dosis rendah vs tinggi (16,32 vs 48,64), serta perbandingan antara dosis 16 vs 32 dan 48 vs 64:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlevels(Fact2$Dosis)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"0\"  \"16\" \"32\" \"48\" \"64\"\n```\n:::\n\n```{.r .cell-code}\ncontrasts(Fact2$Dosis)<- cbind(c(1, -1/4, -1/4, -1/4,-1/4), c(0, 1/2,1/2, -1/2, -1/2), \n                              c(0, 1,-1, 0, 0), c(0,0,0,1,-1))\ncontrasts(Fact2$Dosis)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    [,1] [,2] [,3] [,4]\n0   1.00  0.0    0    0\n16 -0.25  0.5    1    0\n32 -0.25  0.5   -1    0\n48 -0.25 -0.5    0    1\n64 -0.25 -0.5    0   -1\n```\n:::\n\n```{.r .cell-code}\naovFact1<-aov(Perkecambahan~LamaFumigasi+Dosis+LamaFumigasi:Dosis,Fact2)\nsummary.aov(aovFact1,split=list(Dosis=list(\"0 vs ada\"=1,\"16,32 vs 48,64\"=2,\"16 vs 32\"=3,\"48 vs 64\"=4)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                     Df Sum Sq Mean Sq F value   Pr(>F)    \nLamaFumigasi                          1   5713    5713  691.11  < 2e-16 ***\nDosis                                 4  25459    6365  769.93  < 2e-16 ***\n  Dosis: 0 vs ada                     1   5852    5852  707.91  < 2e-16 ***\n  Dosis: 16,32 vs 48,64               1  19154   19154 2316.96  < 2e-16 ***\n  Dosis: 16 vs 32                     1    133     133   16.13 0.000678 ***\n  Dosis: 48 vs 64                     1    320     320   38.75 4.43e-06 ***\nLamaFumigasi:Dosis                    4   6258    1565  189.26 1.37e-15 ***\n  LamaFumigasi:Dosis: 0 vs ada        1   1044    1044  126.33 4.28e-10 ***\n  LamaFumigasi:Dosis: 16,32 vs 48,64  1   4760    4760  575.83 3.25e-16 ***\n  LamaFumigasi:Dosis: 16 vs 32        1    133     133   16.13 0.000678 ***\n  LamaFumigasi:Dosis: 48 vs 64        1    320     320   38.75 4.43e-06 ***\nResiduals                            20    165       8                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nDapat juga dibuat polinomial orthogonal, dengan koefisien-koefisien sesuai yang ditentukan saat taraf faktor tersebut 4.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncontrasts(Fact2$Dosis) <- cbind(c(-2, -1, 0, 1, 2), c(2, -1, -2, -1, 2),\n                                c(-1, 2, 0, -2, 1), c(1, -4, 6, -4, 1))\ncontrasts(Fact2$Dosis)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   [,1] [,2] [,3] [,4]\n0    -2    2   -1    1\n16   -1   -1    2   -4\n32    0   -2    0    6\n48    1   -1   -2   -4\n64    2    2    1    1\n```\n:::\n\n```{.r .cell-code}\naovFact2<-aov(Perkecambahan~LamaFumigasi+Dosis+LamaFumigasi:Dosis,Fact2)\nsummary.aov(aovFact2,split=list(Dosis=list(\"Linear\"=1,\"Kuadratik\"=2,\"Kubik\"=3,\"Kuartik\"=4)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                Df Sum Sq Mean Sq  F value   Pr(>F)    \nLamaFumigasi                     1   5713    5713  691.113  < 2e-16 ***\nDosis                            4  25459    6365  769.935  < 2e-16 ***\n  Dosis: Linear                  1  21965   21965 2657.065  < 2e-16 ***\n  Dosis: Kuadratik               1   1312    1312  158.733 5.72e-11 ***\n  Dosis: Kubik                   1   1009    1009  122.008 5.79e-10 ***\n  Dosis: Kuartik                 1   1173    1173  141.937 1.54e-10 ***\nLamaFumigasi:Dosis               4   6258    1565  189.258 1.37e-15 ***\n  LamaFumigasi:Dosis: Linear     1   4234    4234  512.129 1.01e-15 ***\n  LamaFumigasi:Dosis: Kuadratik  1     27      27    3.318   0.0835 .  \n  LamaFumigasi:Dosis: Kubik      1   1480    1480  179.040 1.94e-11 ***\n  LamaFumigasi:Dosis: Kuartik    1    517     517   62.545 1.39e-07 ***\nResiduals                       20    165       8                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Faktorial RAKL\n\nJika kondisi unit percobaan tidak sepenuhnya homogen, dapat digunakan Faktorial RAKL. Sama seperti RAKL pada kasus satu faktor, tiap perlakuan diacak dan diulang sekali di tiap kelompok.\n\n### Pengacakan\n\nPertama, buat tiap kombinasi perlakuan:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(data.table)\n\nvari<-c(\"V1\",\"V2\",\"V3\")\npupu<-c(\"N0\",\"N1\",\"N2\",\"N3\")\nKLperlakuan<-expand.grid(vari,pupu) #buat kombinasi\ncolnames(KLperlakuan)<-c(\"Varietas\",\"Pupuk\") #ubah nama kolom\nknitr::kable(KLperlakuan)\n```\n\n::: {.cell-output-display}\n|Varietas |Pupuk |\n|:--------|:-----|\n|V1       |N0    |\n|V2       |N0    |\n|V3       |N0    |\n|V1       |N1    |\n|V2       |N1    |\n|V3       |N1    |\n|V1       |N2    |\n|V2       |N2    |\n|V3       |N2    |\n|V1       |N3    |\n|V2       |N3    |\n|V3       |N3    |\n:::\n:::\n\n\nLalu, beri penomoran bagi tiap kombinasi perlakuan tersebut:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nKLperlakuan$Nomor<-paste(KLperlakuan$Varietas,KLperlakuan$Pupuk,sep=\"\")\nknitr::kable(KLperlakuan)\n```\n\n::: {.cell-output-display}\n|Varietas |Pupuk |Nomor |\n|:--------|:-----|:-----|\n|V1       |N0    |V1N0  |\n|V2       |N0    |V2N0  |\n|V3       |N0    |V3N0  |\n|V1       |N1    |V1N1  |\n|V2       |N1    |V2N1  |\n|V3       |N1    |V3N1  |\n|V1       |N2    |V1N2  |\n|V2       |N2    |V2N2  |\n|V3       |N2    |V3N2  |\n|V1       |N3    |V1N3  |\n|V2       |N3    |V2N3  |\n|V3       |N3    |V3N3  |\n:::\n:::\n\n\nDari tiap perlakuan tersebut, lakukan pengacakan di tiap kelompok. Di R, ini dilakukan dengan design.rcbd dari agricolae:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(agricolae)\n\nbaganFakt_RAKL<-design.rcbd(KLperlakuan$Nomor,3,seed=78) #kombinasi perlakuan, jml kelompok\nknitr::kable(baganFakt_RAKL$sketch)\n```\n\n::: {.cell-output-display}\n|     |     |     |     |     |     |     |     |     |     |     |     |\n|:----|:----|:----|:----|:----|:----|:----|:----|:----|:----|:----|:----|\n|V1N3 |V2N3 |V2N2 |V2N0 |V2N1 |V1N1 |V3N0 |V3N2 |V3N1 |V1N0 |V3N3 |V1N2 |\n|V2N3 |V3N2 |V1N0 |V1N1 |V3N0 |V1N3 |V2N2 |V2N1 |V3N1 |V1N2 |V3N3 |V2N0 |\n|V3N0 |V3N2 |V2N3 |V2N1 |V2N2 |V1N0 |V2N0 |V1N2 |V3N1 |V1N3 |V3N3 |V1N1 |\n:::\n:::\n\n\n#### Pengacakan edibble\n\nPada dasarnya, struktur perlakuan akan sama, tetapi struktur unit dibuat sesuai dengan RAKL, yaitu membuat unit kelompok dan petak yang `nested_in(kelompok)`. Perlakuan masih diacak ke petak (unit):\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndesFaktRAKL<-design(name=\"Faktorial RAKL\") %>%\n  set_units(kelompok=3,\n            petak=nested_in(kelompok, 12)) %>%\n  set_trts(varietas=vari,\n           pupuk=pupu) %>%\n  allot_trts(c(varietas,pupuk)~petak) %>%\n  assign_trts(\"random\", seed=420) %>% serve_table\n\nknitr::kable(head(desFaktRAKL,n=10))\n```\n\n::: {.cell-output-display}\n|kelompok  |petak   |varietas |pupuk |\n|:---------|:-------|:--------|:-----|\n|kelompok1 |petak1  |V3       |N0    |\n|kelompok1 |petak2  |V1       |N1    |\n|kelompok1 |petak3  |V3       |N3    |\n|kelompok1 |petak4  |V2       |N0    |\n|kelompok1 |petak5  |V1       |N0    |\n|kelompok1 |petak6  |V1       |N2    |\n|kelompok1 |petak7  |V2       |N2    |\n|kelompok1 |petak8  |V2       |N3    |\n|kelompok1 |petak9  |V1       |N3    |\n|kelompok1 |petak10 |V2       |N1    |\n:::\n:::\n\n\nPlot dari rancangan tersebut dapat dilihat:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndeggust::autoplot(desFaktRAKL)\n```\n\n::: {.cell-output-display}\n![](05-Bab5_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\n### Model Linear Aditif\n\nModel bagi faktorial RAL adalah sebagai berikut:\n\n$$\ny_{ijk}=\\mu+\\alpha_i+\\beta_j+(\\alpha\\beta)_{ij}+\\rho_k+\\varepsilon_{ijk}\n$$\n\n\nDengan:\n\n1. $Y_{ijk}$ adalah nilai pengamatan pada faktor A taraf ke-i dan faktor B taraf ke-j pada ulangan ke-k.\n2. $\\mu$ adalah komponen aditif dari rataan umum.\n3. $\\alpha_i$ adalah komponen aditif dari pengaruh faktor A pada taraf ke-i.\n4. $\\beta_j$ adalah komponen aditif dari pengaruh faktor B pada taraf ke-j.\n5. $(\\alpha\\beta)_{ij}$ adalah komponen interaksi faktor A dan faktor B.\n6. $\\rho_k$ adalah pengaruh aditif dari kelompok dan diasumsikan tidak berinteraksi dengan perlakuan (bersifat aditif) / pengaruh kelompok ke-k\n7. $\\varepsilon_{ijk}\\sim N(0,\\sigma_\\varepsilon^2)$ adalah komponen acak pada tiap pengamatan\n\nOleh karena itu, terdapat empat hipotesis yang diuji, yaitu hipotesis mengenai pengaruh faktor A, pengaruh faktor B, pengaruh interaksi, dan pengaruh kelompok:\n\n\n$$\n\\begin{align*}\n&\\textbf{Pengaruh faktor A:}\\\\\nH_0&: \\alpha_1=\\cdots=\\alpha_a=0 \\\\\n&\\text{ (faktor A tidak berpengaruh pada respon yang diamati)}\\\\\nH_1&: \\text{paling sedikit ada satu i di mana }\\alpha_i\\neq0\\\\\n\\\\\n&\\textbf{Pengaruh faktor B:}\\\\\nH_0&: \\beta_1=\\cdots=\\beta_b=0 \\\\\n&\\text{ (faktor B tidak berpengaruh pada respon yang diamati)}\\\\\nH_1&: \\text{paling sedikit ada satu j di mana }\\beta_j\\neq0\\\\\n\\\\\n&\\textbf{Pengaruh interaksi:}\\\\\nH_0&: (\\alpha\\beta)_{11}=(\\alpha\\beta)_{12}=\\cdots=(\\alpha\\beta)_{ab}=0 \\\\\n&\\text{ (Interaksi faktor A dan B tidak berpengaruh pada respon yang diamati)}\\\\\nH_1&: \\text{paling sedikit ada sepasang } (i,j) \\text{ di mana }(\\alpha\\beta)_{ij}\\neq0\\\\\n\\\\\n&\\textbf{Pengaruh pengelompokan:}\\\\\nH_0&: \\rho_1=\\cdots=\\rho_r=0 \\\\&\n\\text{ (blok tidak berpengaruh pada respon yang diamati)}\\\\\nH_1&: \\text{paling sedikit ada satu k di mana }\\rho_k\\neq0\\\\\n\\\\\n\n\n\\end{align*}\n$$\n\n\nHipotesis tersebut diuji dengan uji-F, yang disimpulkan di tabel sidik ragam:\n\n\n\n  | Sumber Keragaman| db| JK| KT| F-hit|F(dbP,dbG)|\n  |------------:|-----------:|------------:|------------:|------------:|------------:|\n  |         A|         a-1|          JKA| JKP/dbA | KTA/KTG | |\n  |         B|         b-1|          JKB| JKB/dbB | KTB/KTG | |\n  |         A*B|         (a-1)(b-1)|          JKAB| JKAB/dbAB | KTAB/KTG | |\n  |          Blok|         (r-1)|         JKK| JKK/dbK | | |\n  |          Galat|         (ab-1)(r-1)|         JKG| JKG/dbG | | |\n  |          Total|         abr-1|          JKT| | | |\n\n\nJumlah kuadrat tersebut dihitung dengan:\n\n$$\n\\begin{align*}\nFK&=\\frac{y^2_{...}}{abr}\\\\\nJKT&=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k=1}^r\\left(y_{ijk}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{j=1}^b\\sum_{k=1}^r y_{ijk}^2-FK\\\\\nJKA&=\\sum_{i=1}^a\\left(\\bar{y}_{i..}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a \\frac{y_{i..}^2}{br}-FK\\\\\nJKB&=\\sum_{j=1}^b\\left(\\bar{y}_{.j.}-\\bar{y}_{...}\\right)^2=\\sum_{j=1}^b \\frac{y_{.j.}^2}{ar}-FK\\\\\nJKP&=\\sum_{i=1}^a\\sum_{j=1}^b\\left(\\bar{y}_{ij.}-\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{j=1}^b \\frac{y_{ij.}^2}{r}-FK\\\\\nJKAB&=\\sum_{i=1}^a\\sum_{j=1}^b\\left(\\bar{y}_{ij.}-\\bar{y}_{i..}-\\bar{y}_{.j.}+\\bar{y}_{...}\\right)^2=\\sum_{i=1}^a\\sum_{j=1}^b\\left(\\bar{y}_{ij.}-\\bar{y}_{...}\\right)^2-JKA-JKB\\\\\n&=JKP-JKB-JKA\\\\\nJKK&=\\sum_{k=1}^r \\left(\\bar{y}_{..k}-\\bar{y}_{...}\\right)^2=\\sum_{k=1}^r \\frac{y_{..k}^2}{ab}-FK\\\\\nJKG&=JKP-JKK-JKT\n\\end{align*}\n$$\n\n\n### ANOVA dengan R\n\n> Seorang peneliti akan melakukan percobaan pada sebuah tanaman dengan mengamati pertumbuhan tinggi tanaman di sebuah green house. Tanaman  diberikan 2 jenis perlakuan yang pertama adalah jenis varietas yang terdiri dari Varietas 1(V1), Varietas 2(V2), dan Varietas 3(V3) dan perlakuan kedua adalah dosis pupuk terdiri dari N1, N2, N3, N4, N5. Percobaan ini dilakukan di 3 spot berbeda.  Rancangan apakah yang sebaiknya digunakan peneliti?  Bagaimana alur  percobaan jika dilakukan sesuai rancangan yang anda sarankan? Lalu uji apakah perlakuan yang dicobakan berpengaruh signifikan, jika didapatkan data seperti dibawah ini?\n\nKarena percobaan dilakukan di tiga *spot* berebeda, maka rancangan adalah faktorial RAKL. Ambil data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(googlesheets4)\n\nFactRAKL<-read_sheet(\"https://docs.google.com/spreadsheets/d/1PqOsMGjb6aBwF-3NsWxsXk3-eevUJBq6sGMGHMLct-A/edit?usp=sharing\")\nknitr::kable(FactRAKL)\n```\n\n::: {.cell-output-display}\n|Varietas | kelompok|  N1|  N2|  N3|  N4|  N5|\n|:--------|--------:|---:|---:|---:|---:|---:|\n|V1       |        1| 0.9| 1.2| 1.3| 1.8| 1.1|\n|V1       |        2| 0.9| 1.3| 1.5| 1.9| 1.4|\n|V1       |        3| 1.0| 1.2| 1.4| 2.1| 1.2|\n|V2       |        1| 0.9| 1.1| 1.3| 1.6| 1.9|\n|V2       |        2| 0.8| 0.9| 1.5| 1.3| 1.6|\n|V2       |        3| 0.8| 0.9| 1.1| 1.1| 1.5|\n|V3       |        1| 0.9| 1.4| 1.3| 1.4| 1.2|\n|V3       |        2| 1.0| 1.2| 1.4| 1.5| 1.1|\n|V3       |        3| 0.7| 1.0| 1.4| 1.4| 1.3|\n:::\n:::\n\n\nLalu, melt data frame tersebut. Seperti biasa, id.vars merupakan pembeda individu di format wide yang menjadi bentuk awal data frame (dalam kasus ini, tiap individu adalah kombinasi Varietas dan Kelompok). Lalu, value.vars merupakan kolom-kolom yang digabung menjadi satu, dalam kasus ini pupuk dari N1 sampai N5.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(reshape2)\n\nFactRAKL2<-melt(FactRAKL,\n               #variabel yang membedakan tiap baris di tabulasi asli:\n               id.vars=c(\"Varietas\",\"kelompok\"),\n               value.vars=c(\"N1\",\"N2\",\"N3\",\"N4\",\"N5\"),\n               value.name=\"Tinggi\")\ncolnames(FactRAKL2)[3]<-\"Pupuk\" #kolom ketiga akan disebut \"variable\"\nknitr::kable(FactRAKL2)\n```\n\n::: {.cell-output-display}\n|Varietas | kelompok|Pupuk | Tinggi|\n|:--------|--------:|:-----|------:|\n|V1       |        1|N1    |    0.9|\n|V1       |        2|N1    |    0.9|\n|V1       |        3|N1    |    1.0|\n|V2       |        1|N1    |    0.9|\n|V2       |        2|N1    |    0.8|\n|V2       |        3|N1    |    0.8|\n|V3       |        1|N1    |    0.9|\n|V3       |        2|N1    |    1.0|\n|V3       |        3|N1    |    0.7|\n|V1       |        1|N2    |    1.2|\n|V1       |        2|N2    |    1.3|\n|V1       |        3|N2    |    1.2|\n|V2       |        1|N2    |    1.1|\n|V2       |        2|N2    |    0.9|\n|V2       |        3|N2    |    0.9|\n|V3       |        1|N2    |    1.4|\n|V3       |        2|N2    |    1.2|\n|V3       |        3|N2    |    1.0|\n|V1       |        1|N3    |    1.3|\n|V1       |        2|N3    |    1.5|\n|V1       |        3|N3    |    1.4|\n|V2       |        1|N3    |    1.3|\n|V2       |        2|N3    |    1.5|\n|V2       |        3|N3    |    1.1|\n|V3       |        1|N3    |    1.3|\n|V3       |        2|N3    |    1.4|\n|V3       |        3|N3    |    1.4|\n|V1       |        1|N4    |    1.8|\n|V1       |        2|N4    |    1.9|\n|V1       |        3|N4    |    2.1|\n|V2       |        1|N4    |    1.6|\n|V2       |        2|N4    |    1.3|\n|V2       |        3|N4    |    1.1|\n|V3       |        1|N4    |    1.4|\n|V3       |        2|N4    |    1.5|\n|V3       |        3|N4    |    1.4|\n|V1       |        1|N5    |    1.1|\n|V1       |        2|N5    |    1.4|\n|V1       |        3|N5    |    1.2|\n|V2       |        1|N5    |    1.9|\n|V2       |        2|N5    |    1.6|\n|V2       |        3|N5    |    1.5|\n|V3       |        1|N5    |    1.2|\n|V3       |        2|N5    |    1.1|\n|V3       |        3|N5    |    1.3|\n:::\n:::\n\n\nSetelah tabulasi data benar, pastikan tiap faktor sudah dibuat menjadi objek data yang benar; lakukan ANOVA dan lihat hasil:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFactRAKL2$Varietas<-as.factor(FactRAKL2$Varietas)\nFactRAKL2$Pupuk<-as.factor(FactRAKL2$Pupuk)\nFactRAKL2$kelompok<-as.factor(FactRAKL2$kelompok)\naovFactRAKL<-aov(Tinggi~Varietas*Pupuk+kelompok,FactRAKL2)\nsummary(aovFactRAKL)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               Df Sum Sq Mean Sq F value   Pr(>F)    \nVarietas        2 0.1693  0.0847   4.316   0.0232 *  \nPupuk           4 2.4902  0.6226  31.732 4.95e-10 ***\nkelompok        2 0.0640  0.0320   1.631   0.2138    \nVarietas:Pupuk  8 1.0151  0.1269   6.468 8.98e-05 ***\nResiduals      28 0.5493  0.0196                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nOperasi-operasi lanjutan, seperti uji asumsi, uji lanjut, ataupun pembuatan plot interaksi, dapat diadopsi dari contoh-contoh sebelumnya.\n\n::: {.cell}\n\n```{.r .cell-code}\nSumTabRAKFakt<-reshape2::dcast(aggregate(Tinggi~Varietas+Pupuk,data=FactRAKL2,FUN=mean),Varietas~Pupuk,value.var=\"Tinggi\") #(tabel: agregasi, fungsi: baris~kolom)\nknitr::kable(SumTabRAKFakt)\n```\n\n::: {.cell-output-display}\n|Varietas |        N1|        N2|       N3|       N4|       N5|\n|:--------|---------:|---------:|--------:|--------:|--------:|\n|V1       | 0.9333333| 1.2333333| 1.400000| 1.933333| 1.233333|\n|V2       | 0.8333333| 0.9666667| 1.300000| 1.333333| 1.666667|\n|V3       | 0.8666667| 1.2000000| 1.366667| 1.433333| 1.200000|\n:::\n:::\n\n\nDan plot interaksinya:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(phia)\nmod2<-lm(Tinggi~Varietas*Pupuk+kelompok,data=FactRAKL2)\nim2=interactionMeans(mod2)\nknitr::kable(head(im2),n=5) # tabel\n```\n\n::: {.cell-output-display}\n|Varietas |Pupuk |kelompok | adjusted mean| std. error|\n|:--------|:-----|:--------|-------------:|----------:|\n|V1       |N1    |1        |     0.9600000|  0.0860909|\n|V2       |N1    |1        |     0.8600000|  0.0860909|\n|V3       |N1    |1        |     0.8933333|  0.0860909|\n|V1       |N2    |1        |     1.2600000|  0.0860909|\n|V2       |N2    |1        |     0.9933333|  0.0860909|\n|V3       |N2    |1        |     1.2266667|  0.0860909|\n:::\n\n```{.r .cell-code}\nplot(im2) # plot\n```\n\n::: {.cell-output-display}\n![](05-Bab5_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n:::\n\n\nTerlihat bahwa pengelompokan memenuhi asumsi tak ada interaksi.\n",
    "supporting": [
      "05-Bab5_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}