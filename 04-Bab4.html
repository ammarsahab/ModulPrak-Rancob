<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Modul Praktikum Perancangan Percobaan - 4&nbsp; Uji Asumsi</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-Bab5.html" rel="next">
<link href="./03-Bab3.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Uji Asumsi</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modul Praktikum Perancangan Percobaan</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Pendahuluan</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Bab1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Konsep Dasar Perancangan Percobaan</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Bab2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Percobaan Faktor Tunggal</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-Bab3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Perbandingan Nilai Tengah Perlakuan</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-Bab4.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Uji Asumsi</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-Bab5.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Rancangan Faktorial</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-Bab6.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Rancangan Petak Terpisah (Split Plot Design)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-Bab7.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Rancangan Split Blok</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-Bab8.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">ANCOVA</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#galat-percobaaan-menyebar-normal" id="toc-galat-percobaaan-menyebar-normal" class="nav-link active" data-scroll-target="#galat-percobaaan-menyebar-normal"> <span class="header-section-number">4.1</span> Galat percobaaan menyebar normal</a>
  <ul class="collapse">
  <li><a href="#prosedur-eksploratif" id="toc-prosedur-eksploratif" class="nav-link" data-scroll-target="#prosedur-eksploratif"> <span class="header-section-number">4.1.1</span> Prosedur Eksploratif</a></li>
  <li><a href="#uji-formal-untuk-galat-percobaan-menyebar-normal" id="toc-uji-formal-untuk-galat-percobaan-menyebar-normal" class="nav-link" data-scroll-target="#uji-formal-untuk-galat-percobaan-menyebar-normal"> <span class="header-section-number">4.1.2</span> Uji formal untuk galat percobaan menyebar normal</a></li>
  <li><a href="#konsekuensi-dari-ketidaknormalan-pada-galat." id="toc-konsekuensi-dari-ketidaknormalan-pada-galat." class="nav-link" data-scroll-target="#konsekuensi-dari-ketidaknormalan-pada-galat."> <span class="header-section-number">4.1.3</span> Konsekuensi dari ketidaknormalan pada galat.</a></li>
  </ul></li>
  <li><a href="#kehomogenan-ragam" id="toc-kehomogenan-ragam" class="nav-link" data-scroll-target="#kehomogenan-ragam"> <span class="header-section-number">4.2</span> Kehomogenan ragam</a>
  <ul class="collapse">
  <li><a href="#prosedur-eksploratif-1" id="toc-prosedur-eksploratif-1" class="nav-link" data-scroll-target="#prosedur-eksploratif-1"> <span class="header-section-number">4.2.1</span> Prosedur Eksploratif</a></li>
  <li><a href="#uji-formal-untuk-kehomogenan-ragam" id="toc-uji-formal-untuk-kehomogenan-ragam" class="nav-link" data-scroll-target="#uji-formal-untuk-kehomogenan-ragam"> <span class="header-section-number">4.2.2</span> Uji formal untuk kehomogenan ragam</a></li>
  <li><a href="#uji-levene-dan-brown-forsythe" id="toc-uji-levene-dan-brown-forsythe" class="nav-link" data-scroll-target="#uji-levene-dan-brown-forsythe"> <span class="header-section-number">4.2.3</span> Uji Levene dan Brown-Forsythe</a></li>
  <li><a href="#plot-vs.-uji" id="toc-plot-vs.-uji" class="nav-link" data-scroll-target="#plot-vs.-uji"> <span class="header-section-number">4.2.4</span> Plot vs.&nbsp;uji</a></li>
  </ul></li>
  <li><a href="#galat-percobaan-saling-bebas" id="toc-galat-percobaan-saling-bebas" class="nav-link" data-scroll-target="#galat-percobaan-saling-bebas"> <span class="header-section-number">4.3</span> Galat percobaan saling bebas</a>
  <ul class="collapse">
  <li><a href="#prosedur-eksploratif-2" id="toc-prosedur-eksploratif-2" class="nav-link" data-scroll-target="#prosedur-eksploratif-2"> <span class="header-section-number">4.3.1</span> Prosedur Eksploratif</a></li>
  <li><a href="#uji-formal-untuk-galat-percobaan-saling-bebas" id="toc-uji-formal-untuk-galat-percobaan-saling-bebas" class="nav-link" data-scroll-target="#uji-formal-untuk-galat-percobaan-saling-bebas"> <span class="header-section-number">4.3.2</span> Uji formal untuk galat percobaan saling bebas</a></li>
  <li><a href="#konsekuensi-dari-ketidakbebasan-pada-galat" id="toc-konsekuensi-dari-ketidakbebasan-pada-galat" class="nav-link" data-scroll-target="#konsekuensi-dari-ketidakbebasan-pada-galat"> <span class="header-section-number">4.3.3</span> Konsekuensi dari ketidakbebasan pada galat</a></li>
  </ul></li>
  <li><a href="#aditivitas" id="toc-aditivitas" class="nav-link" data-scroll-target="#aditivitas"> <span class="header-section-number">4.4</span> Aditivitas</a>
  <ul class="collapse">
  <li><a href="#plot-interaksi" id="toc-plot-interaksi" class="nav-link" data-scroll-target="#plot-interaksi"> <span class="header-section-number">4.4.1</span> Plot Interaksi</a></li>
  <li><a href="#uji-formal" id="toc-uji-formal" class="nav-link" data-scroll-target="#uji-formal"> <span class="header-section-number">4.4.2</span> Uji formal</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Uji Asumsi</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>Prosedur ANOVA mengasumsikan beberapa hal mengenai struktur model dan struktur galat. Jika asumsi tersebut tidak terpenuhi, hasil dari ANOVA mungkin saja tidak valid. Oleh karena itu, pengujian asumsi sangat penting untuk diketahui.</p>
<section id="galat-percobaaan-menyebar-normal" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="galat-percobaaan-menyebar-normal"><span class="header-section-number">4.1</span> Galat percobaaan menyebar normal</h2>
<section id="prosedur-eksploratif" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="prosedur-eksploratif"><span class="header-section-number">4.1.1</span> Prosedur Eksploratif</h3>
<p>Secara eksploratif dalam mendeteksi kenormalan pada galat dapat menggunakan plot peluang normal (Normal probability (Q-Q) plot) dan histogram sisaan.</p>
<p>Metode grafis plot peluang normal (Normal probability (Q-Q) plot) memiliki sumbu vertikal plot (nilai data yang berurut) dan sumbu horizontal plot (nilai peluang normal). Untuk mendeteksi normalitas pada residual, maka pada sumbu vertikal plot NPP merupakan residual yang terurut dan pada sumbu horizontal merupakan skor peluang normal yang terurut dari residual. Jika pada NPP diperoleh garis yang lurus atau mendekati/hampir lurus maka data residual tersebut menyebar normal. Garis tersebut tidak akan betul-betul lurus sempurna karena adanya keragaman contoh. Jika dibuat plot NPP untuk data tidak normal, plot akan cenderung melengkung, dan bentuk kelengkungan tersebut dapat menjadi informasi sejauh mana penyimpangan ketidaknormalannya.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(googlesheets4)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>DataRAKL<span class="ot">&lt;-</span><span class="fu">read_sheet</span>(<span class="st">"https://docs.google.com/spreadsheets/d/1uFi_Njharot8G8-DvHWPhNLLqJ72ym5EuuOqgeFA0hY/edit?usp=sharing"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>! Using an auto-discovered, cached token.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  To suppress this message, modify your code or options to clearly consent to
  the use of a cached token.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  See gargle's "Non-interactive auth" vignette for more details:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  &lt;https://gargle.r-lib.org/articles/non-interactive-auth.html&gt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ The googlesheets4 package is using a cached token for
  'muh.ammarsahab@apps.ipb.ac.id'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Reading from "RAKL_P2 Rancob".</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ Range 'Sheet1'.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>DataRAKL<span class="sc">$</span>Produksi<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(DataRAKL<span class="sc">$</span>Produksi)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#pastikan perlakuan dan kelompok berbentuk faktor</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>DataRAKL<span class="sc">$</span>Kelompok<span class="ot">&lt;-</span><span class="fu">as.factor</span>(DataRAKL<span class="sc">$</span>Kelompok)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>DataRAKL<span class="sc">$</span>Perlakuan<span class="ot">&lt;-</span><span class="fu">as.factor</span>(DataRAKL<span class="sc">$</span>Perlakuan)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>aovRAKL<span class="ot">&lt;-</span><span class="fu">aov</span>(Produksi<span class="sc">~</span>Kelompok<span class="sc">+</span>Perlakuan,<span class="at">data=</span>DataRAKL) <span class="co">#prosedur anova</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(aovRAKL) <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">sumsq</th>
<th style="text-align: right;">meansq</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Kelompok</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">39.2107</td>
<td style="text-align: right;">19.605348</td>
<td style="text-align: right;">2.220614</td>
<td style="text-align: right;">0.1408977</td>
</tr>
<tr class="even">
<td style="text-align: left;">Perlakuan</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">586.0398</td>
<td style="text-align: right;">73.254970</td>
<td style="text-align: right;">8.297279</td>
<td style="text-align: right;">0.0001896</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">141.2607</td>
<td style="text-align: right;">8.828794</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Pertama, plot Q-Q:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Peluang Normal (Q-Q)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(aovRAKL, <span class="at">which =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#atau#</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(aovRAKL<span class="sc">$</span>residuals); <span class="fu">qqline</span>(aovRAKL<span class="sc">$</span>residuals, <span class="at">col =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Lalu, histogram:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram Sisaan</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(aovRAKL<span class="sc">$</span>residuals,<span class="at">breaks =</span> <span class="dv">10</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#atau#</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(rcompanion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotNormalHistogram</span>(aovRAKL<span class="sc">$</span>residuals, <span class="at">breaks =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Dari plot di atas dapat terlihat bahwa semua titik cenderung berada kira-kira di sekitar sepanjang garis diagonal tetapi ada satu titik tidak dekat dengan garis dan histogram membentuk seperti kurva sebaran normal sehingga asumsi galat percobaan menyebar normal terpenuhi. Metode qq-plot dan histogram residual di python sebagai berikut. Pertama, lakukan ANOVA:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>C:\Users\Acer\AppData\Local\R\win-library\4.2\reticulate\python\rpytools\loader.py:39: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.
  module = _import(
C:\Users\Acer\AppData\Local\Programs\Python\PYTHON~2\lib\site-packages\statsmodels\compat\pandas.py:65: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.
  from pandas import Int64Index as NumericIndex</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>RAKLpy<span class="op">=</span>pd.read_csv(<span class="st">"https://docs.google.com/spreadsheets/d/e/2PACX-1vTi9yO_OJZ5pHMmPRlPqPxK9TydeVWI--rXAYfFfwj2v6ee-vUrQGYUGYb5zgguZ5mgu9IDhwB-dIwl/pub?gid=0&amp;single=true&amp;output=csv"</span>) <span class="co">#baca data</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>RAKL_lm<span class="op">=</span> ols(<span class="st">'Produksi ~ C(Perlakuan)+C(Kelompok)'</span>,data<span class="op">=</span>RAKLpy).fit() <span class="co">#C=peubah kategorik</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> sm.stats.anova_lm(RAKL_lm, typ<span class="op">=</span><span class="dv">2</span>) <span class="co"># Type 2 ANOVA DataFrame</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  sum_sq    df         F    PR(&gt;F)
C(Perlakuan)  586.039763   8.0  8.297279  0.000190
C(Kelompok)    39.210696   2.0  2.220615  0.140898
Residual      141.260704  16.0       NaN       NaN</code></pre>
</div>
</div>
<p>Buat plot:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#create Q-Q plot with 45-degree line added to plot</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> sm.qqplot(RAKL_lm.resid, line<span class="op">=</span><span class="st">'s'</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Dan untuk histogram:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>plt.clf() <span class="co">#clear plot sebelumnya</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>h<span class="op">=</span>sns.histplot(RAKL_lm.resid,bins<span class="op">=</span><span class="dv">10</span>, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="uji-formal-untuk-galat-percobaan-menyebar-normal" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="uji-formal-untuk-galat-percobaan-menyebar-normal"><span class="header-section-number">4.1.2</span> Uji formal untuk galat percobaan menyebar normal</h3>
<p>secara formal dapat menggunakan beberapa uji tertentu diantaranya adalah Uji Kolmogorov-Smirnov, Uji Shapiro-Wilk, Uji Lilliefors, Uji Jarque-Bera, Uji Anderson-Darling, dsb.</p>
<p>Semua uji tersebut memiliki hipotesis:</p>
<p><span class="math display">\[
\begin{aligned}
H_{0}&amp;:\text{ Galat menyebar normal}\\
H_{1}&amp;:\text{ Galat tidak menyebar normal}
\end{aligned}
\]</span></p>
<p>Uji Shapiro Wilk memiliki statistik uji sebagai berikut:</p>
<p><span class="math display">\[
W = \frac{\left[\sum^n_{i=1} a_i x_{(i)}\right]^2}{\sum^n_{i=1}(x_i – \bar{x})^2}
\]</span></p>
<p><span class="math inline">\(x_{(i)}\)</span> adalah statistik tataan ke-i - angka terkecil ke-i dari sampel. <span class="math inline">\(a_{i}\)</span> berasal dari suatu rumus berisi mean dan matriks peragam <span class="math inline">\(X\)</span>. Implementasi di R:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro.test</span>(<span class="at">x =</span> aovRAKL<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  aovRAKL$residuals
W = 0.98096, p-value = 0.8833</code></pre>
</div>
</div>
<p>Dan implementasi python:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> shapiro</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> (shapiro(RAKL_lm.resid))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"S-W statistic: </span><span class="sc">{</span>result[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>S-W statistic: 0.9809552431106567</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>result[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>p-value: 0.8832639455795288</code></pre>
</div>
</div>
<p>Dari keluaran uji Shapiro-Wilk dapat dilihat nilai p-value = 0.8832 <span class="math inline">\(&gt; \alpha = 0.05\)</span> maka tak tolak <span class="math inline">\(H_{0}\)</span>, artinya tidak cukup bukti untuk mengatakan bahwa galat tidak menyebar normal sehingga asumsi galat percobaan menyebar normal terpenuhi.</p>
<p>Uji Kolmogorov-Smirnov memiliki statistik uji:</p>
<p><span class="math display">\[
D_n = \sup_{x}|F_n(x) – F(x)|
\]</span></p>
<p>Atau, jarak terbesar antara fungsi kumulatif dari sampel dan fungsi kumulatif dari sebaran normal (dalam kasus menguji kenormalan). Fungsi kumulatif dapat disesuaikan untuk sebaran yang berbeda jika ingin menguji kesesuaian dengan sebaran lain. Visualisasi dari proses ini ditunjukkan di <a href="https://rpubs.com/mharris/KSplot">dokumen ini</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Uji Kolmogorov-Smirnov</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ks.test</span>(aovRAKL<span class="sc">$</span>residuals,pnorm, <span class="fu">mean</span>(aovRAKL<span class="sc">$</span>residuals), <span class="fu">sd</span>(aovRAKL<span class="sc">$</span>residuals))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact one-sample Kolmogorov-Smirnov test

data:  aovRAKL$residuals
D = 0.090934, p-value = 0.964
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<p>Dan di python:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> kstest</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> kstest(RAKL_lm.resid, cdf<span class="op">=</span><span class="st">"norm"</span>,args<span class="op">=</span>(np.mean(RAKL_lm.resid),np.std(RAKL_lm.resid)))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"K-S statistic: </span><span class="sc">{</span>result[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>K-S statistic: 0.09507410791382365</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>result[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>p-value: 0.9483937411797532</code></pre>
</div>
</div>
<p>Dari keluaran diatas dapat dilihat nilai p-value = 0.964 (R) &gt; alpha = 0.05 maka Tak Tolak <span class="math inline">\(H_{0}\)</span>, artinya tidak cukup bukti untuk mengatakan bahwa galat tidak menyebar normal sehingga dengan uji Kolmogorov-Smirnov asumsi galat percobaan menyebar normal juga terpenuhi.</p>
<p>Uji Lilliefors pada dasarnya merupakan modifikasi dari uji Kolmogorov Smirnov. Uji tersebut dapat dilakukan tanpa menspesifikasi mean dan simpangan baku dari sebaran normal yang hendak diuji, serta memberikan koreksi pada nilai Kolmogorov Smirnov. Implementasi di R:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Uji Lilliefors</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Hipotesis: H0 : galat menyebar normal</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#            H1 : galat tidak menyebar normal</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lillie.test</span>(aovRAKL<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Lilliefors (Kolmogorov-Smirnov) normality test

data:  aovRAKL$residuals
D = 0.090934, p-value = 0.8199</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.diagnostic <span class="im">import</span> lilliefors</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>D,p<span class="op">=</span>lilliefors(RAKL_lm.resid,dist<span class="op">=</span><span class="st">'norm'</span>,pvalmethod<span class="op">=</span><span class="st">'table'</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Statistik uji: "</span>,D)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Statistik uji:  0.09093377335390318</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p-value: "</span>,p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>p-value:  0.8117606135583574</code></pre>
</div>
</div>
<p>Dari keluaran di atas dapat dilihat nilai p-value = 0.8199 <span class="math inline">\(&gt; /alpha = 0.05\)</span> maka Tak Tolak <span class="math inline">\(H_{0}\)</span>, artinya tidak cukup bukti untuk mengatakan bahwa galat tidak menyebar normal sehingga dengan uji Lilliefors asumsi galat percobaan menyebar normal juga terpenuhi.</p>
<p>Uji Jarque-Bera membandingkan skewness dan kurtosis data dengan sebaran normal. Ini dapat dilihat dari statistik uji:</p>
<p><span class="math display">\[
JB = \frac{n}{6} \times \bigg(S^2 + \frac{(K-3)^2}{4} \bigg)
\]</span></p>
<p>n adalah jumlah sampel, S adalah skewness, dan K adalah kurtosis. Implementasi di R sebagai berikut:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Uji Jarque-Bera</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Hipotesis: H0 : galat menyebar normal</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">#            H1 : galat tidak menyebar normal</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>tseries<span class="sc">::</span><span class="fu">jarque.bera.test</span>(aovRAKL<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  aovRAKL$residuals
X-squared = 0.31309, df = 2, p-value = 0.8551</code></pre>
</div>
</div>
<p>Dan implementasi python:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> jarque_bera</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> (jarque_bera(RAKL_lm.resid))</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"JB statistic:"</span>, result[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>JB statistic: 0.3130851694293787</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p-value:"</span>, result[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>p-value: 0.8550951029465681</code></pre>
</div>
</div>
<p>Dari keluaran diatas dapat dilihat nilai p-value = 0.8551 &gt; alpha = 0.05 maka Tak Tolak H0, artinya tidak cukup bukti untuk mengatakan bahwa galat tidak menyebar normal sehingga dengan uji Jarque-Bera asumsi galat percobaan menyebar normal juga terpenuhi.</p>
<p>Uji Anderson-Darling merupakan modifikasi dari uji Kolmogorov Smirnov:</p>
<p><span class="math display">\[
A^2 = n \int_{-\infty}^{\infty}  \bigg (F_n(x) – F(x) \bigg )^2 w(x) dF(x)
\]</span></p>
<p>Statistik uji tersebut masih merupakan beda antara fungsi kumulatif, tetapi beda yang terambil tidak hanya beda terbesar. Selain itu, ada pembobotan:</p>
<p><span class="math display">\[
w(x) = \bigg[F(x)(1-F(x))\bigg]^{-1}
\]</span></p>
<p>Sehingga bobot tersebut akan lebih besar di ujung sebaran. Implementasi di R sebagai berikut:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Uji Anderson-Darling</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Hipotesis: H0 : galat menyebar normal</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co">#            H1 : galat tidak menyebar normal</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ad.test</span>(aovRAKL<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Anderson-Darling normality test

data:  aovRAKL$residuals
A = 0.23022, p-value = 0.7851</code></pre>
</div>
</div>
<p>Sedangkan di python:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> anderson</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> (anderson(RAKL_lm.resid, dist<span class="op">=</span><span class="st">'norm'</span>))</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A-D statistic:"</span>, result[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>A-D statistic: 0.2302183152399664</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Critical values:"</span>, result[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Critical values: [0.517 0.589 0.707 0.824 0.98 ]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Significance levels:"</span>, result[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Significance levels: [15.  10.   5.   2.5  1. ]</code></pre>
</div>
</div>
<p>Dari keluaran diatas dapat dilihat nilai p-value = 0.7851 &gt; <span class="math inline">\(/alpha = 0.05\)</span> maka Tak Tolak <span class="math inline">\(H_{0}\)</span>, artinya tidak cukup bukti untuk mengatakan bahwa galat tidak menyebar normal sehingga dengan uji Anderson-Darling asumsi galat percobaan menyebar normal juga terpenuhi. Interpretasi output Python adalah dengan membandingkan statistik uji dengan nilai kritis di taraf tertentu. Misal, karena <span class="math inline">\(0.2302&lt;0.517\)</span>, <span class="math inline">\(H_{0}\)</span> tak ditolak di <span class="math inline">\(\alpha=15\%\)</span>. Jika nilai statistik uji lebih besar dari nilai kritis, <span class="math inline">\(H_{0}\)</span> dapat ditolak.</p>
</section>
<section id="konsekuensi-dari-ketidaknormalan-pada-galat." class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="konsekuensi-dari-ketidaknormalan-pada-galat."><span class="header-section-number">4.1.3</span> Konsekuensi dari ketidaknormalan pada galat.</h3>
<ol type="1">
<li>Kemenjuluran mempengaruhi selang kepercayaan</li>
</ol>
<p>Kemenjuluran digunakan untuk mengukur ketidaksimetrisan data dan kurtosis digunakan untuk mengukur panjang ekor pada data. Baik kemenjuluran dan kurtosis pada sebaran normal adalah 0. Sebaran dengan ekor yang lebih panjang ke kanan ialah sebaran yang menjulur positif, sedangkan sebaran dengan ekor yang lebih panjang ke kiri ialah sebaran yang menjulur negatif. Sebaran yang simetris seperti sebaran normal mempunyai nilai kemenjuluran sama dengan 0. Sebaran dengan ekor yang lebih panjang dari normal (lebih rawan memiliki pencilan) memiliki kurtosis positif, dan mereka dengan ekor lebih pendek dari normal (cenderung memiliki sedikit pencilan) memiliki kurtosis negatif.</p>
<p>Kemenjuluran mempengaruhi selang kepercayaanKemenjuluran dan kurtosis pada data dapat mempengaruhi selang kepercayaan, akan tetapi kemenjuluran mempunyai efek yang lebih besar dibanding kurtosis. Ketika suata data menyebar normal, selang kepercayaan dua arah dari sebaran t- berada pada selang/cakupan yang benar, galat yang sama besar pada data yang tinggi dan rendah. Ketika data dari sebaran mempunyai nilai kemenjuluran sama dengan nol, maka selang kepercayaan pada uji dua arah juga masih berada di sekitar nilai/cakupan yang benar, tetapi galat cenderung ke satu sisi atau sisi yang lainnya, tidak sama besar secara merata pada data yang besar dan kecil. Selang kepercayaan pada uji satu arah untuk rataan bisa menjadi masalah yang serius.</p>
<ol start="2" type="1">
<li>Pencilan, kekekaran, dan resistensi</li>
</ol>
<p>Suatu pencilan dapat mempengaruhi rataan perlakuan juga KTG. Sehingga inferensi yang diperoleh jika memasukkan dan mengeluarkan pencilan akan berbeda. Hal ini mungkin berguna untuk membedakan untuk membedakan antara kekekaran (validitas) dan resistensi (untuk pencilan). Kekekaran pada validitas artinya bahwa prosedur tersebut memberikan kesimpulan yang masih mendekati benar, bahkan ketika beberapa asumsi kita (seperti normalitas) tidak terpenuhi. Jadi dapat dikatakan bahwa uji-F pada ANOVA masih kekar, karena nilai uji-F 5% menolak nol di sekitar 5% dari seluruh contoh ketika hipotesin nol benar, bahkan ketika data yang diperoleh agak tidak normal. Suatu prosedur dikatakan resisten jika satu atau beberapa nilai data individu tidak mengubah inferensi dari suatu data. Walaupun uji F kekar pada validitasnya, tetapi uji-F tidak resisten terhadap pencilan.</p>
</section>
</section>
<section id="kehomogenan-ragam" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="kehomogenan-ragam"><span class="header-section-number">4.2</span> Kehomogenan ragam</h2>
<p>Terkadang, sisaan tidak konstan di nilai <span class="math inline">\(\hat{y}\)</span> yang berbeda (dalam kata lain, di taraf faktor berbeda-beda). Jika penurunan ANOVA yang diberikan di Montgomery (2017) diteliti, penurunan nilai harapan <span class="math inline">\(KT_{G}\)</span> sebagai penduga <span class="math inline">\(\sigma^2\)</span> memerlukan asumsi kehomogenan ragam. Oleh karena itu, jika asumsi tersebut tidak terpenuhi, penduga ragam yang dimiliki bukan penduga terbaik. Ini berarti penduga efek perlakuan, kelompok, dan lainnya belum tentu efisien (ragam belum tentu terkecil) dan hasil uji-F dapat salah. Namun, penduga tersebut masih tak bias karena ketidakbiasan muncul dari nilai harapan <span class="math inline">\(e_{ij}\)</span>, dan sifat tersebut dipastikan MKT.</p>
<p>Dalam rancangan percobaan dengan jumlah ulangan sama di semua perlakuan, uji-F tidak terlalu dipengaruhi ragam tak homogen. Namun, jika jumlah ulangan tidak sama atau jika ada ragam yang jauh lebih besar dari ragam lainnya, masalah tersebut lebih serius. Jika ragam besar muncul di perlakuan dengan ulangan sedikit, <span class="math inline">\(\alpha\)</span> aktual lebih besar dari yang diinginkan (sehingga lebih mungkin menolak <span class="math inline">\(H_{0}\)</span> jika <span class="math inline">\(H_{0}\)</span> benar). Jika ragam besar muncul di perlakuan dengan ulangan banyak <span class="math inline">\(\alpha\)</span> aktual lebih kecil dari yang diinginkan (peneliti tanpa sengaja memilih uji yang terlalu ketat). Jika model acak digunakan, inferensia mengenai ragam akan terganggu walaupun ulangan sama digunakan.</p>
<p><a href="https://link.springer.com/article/10.3758/s13428-017-0918-2">Blanca <em>et al.</em> (2017)</a> mendiskusikan kekekaran uji-F di berbagai situasi. Sama seperti Montgomery, ragam tak sama tidak menganggu uji-F saat ulangan sama. Namun, uji-F terganggu jika jumlah ulangan tak sama saat rasio antara ragam perlakuan terkecil dan terbesar lebih dari 1.5.</p>
<section id="prosedur-eksploratif-1" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="prosedur-eksploratif-1"><span class="header-section-number">4.2.1</span> Prosedur Eksploratif</h3>
<p>Prosedur eksploratif yang dapat dilakukan adalah plot residual vs.&nbsp;fitted dan plot scale-location. Plot ini dapat dilihat dengan menggunakan fungsi plot(hasilmodel). Fungsi tersebut sebenarnya mengeluarkan berbagai jenis plot, seperti plot kuantil-kuantil dari residual (yang akan berguna saat melihat normalitas dari residual). Implementasi plotting tersebut di R adalah:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="co">#layout: mfrow= 1 baris, 2 kolom</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aovRAKL, <span class="at">which=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)) <span class="co">#plot 1 (residual-fitted) dan 3 (scale-location)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Perlu dilihat dua hal dari plot residual vs fited. Pertama, garis merah di plot tersebut seharusnya lurus di nol. Kedua, titik-titik di plot tersebut menyebar seragam, tidak membentuk pola tertentu. Terlihat bahwa garis merah melengkung di kedua ujung plot residual vs.&nbsp;fitted Selain itu, titik-titik tampak membentuk pola corong terbalik. Hal tersebut dapat terlihat dari data yang sengaja dibuat memiliki ragam tak homogen. Demonstrasi ini diadaptasi dari <a href="https://www.econometrics-with-r.org/5-4-hah.html">Hanck <em>et al.</em> (2016)</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>) </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="co">#vektor x dari 1-100</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">40</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">26</span><span class="sc">:</span><span class="dv">50</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">30</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">51</span><span class="sc">:</span><span class="dv">75</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">76</span><span class="sc">:</span><span class="dv">100</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># vektor galat, saat x kecil, ragam galat dibuat besar</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">720</span> <span class="sc">+</span> <span class="fl">3.3</span> <span class="sc">*</span> x <span class="sc">+</span> e</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod,<span class="at">which=</span><span class="dv">1</span>) <span class="co">#plot model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Selain itu, heteroskedastisitas juga terlihat di plot scale-location. Seharusnya garis merah di plot scale-location lurus dan titik-titik terdistribusi homogen. Walaupun ada dua amatan yang tak sesuai dengan pola tersebut, terlihat bahwa ada pola menurun di plot tersebut saat x membesar. Jika kembali ke contoh data dengan ragam tak sama sebelumnya:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod,<span class="at">which=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Pola menurun tersebut juga terlihat. Plot terakhir yang dapat digunakan untuk mendiagnosis ragam tak seragam adalah plot residual vs level faktor:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aovRAKL,<span class="at">which=</span><span class="dv">5</span>) <span class="co">#plot ke-5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Plot ini menunjukkan sebaran residual per kelompok, sedangkan sebaran residual per perlakuan dapat dilihat di:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>aovRAKL2<span class="ot">&lt;-</span><span class="fu">aov</span>(Produksi<span class="sc">~</span>Perlakuan<span class="sc">+</span>Kelompok,<span class="at">data=</span>DataRAKL) <span class="co">#ubah urutan anova. peubah pertama setelah y~ akan menjadi level faktor di plot ini</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aovRAKL2,<span class="at">which=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ketidakhomogenan ragam tidak terlihat di kedua plot ini.</p>
<p>Buat plot residual vs fitted terlebih dahulu. Pertama, buat data frame dengan nilai-nilai yang diinginkan:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>temp_data <span class="op">=</span> pd.DataFrame(<span class="bu">dict</span>(fitted_values<span class="op">=</span>RAKL_lm.fittedvalues, residual<span class="op">=</span>RAKL_lm.resid))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co">#ambil fitted values dan residual dengan hasilANOVA.fittedvalues/resid</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Buat plot dari data tersebut. Buat argumen lowess=True agar garis merah terlihat seperti di R:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> sns.lmplot(x<span class="op">=</span><span class="st">'fitted_values'</span>, y<span class="op">=</span><span class="st">'residual'</span>, data<span class="op">=</span>temp_data, lowess<span class="op">=</span><span class="va">True</span>, line_kws<span class="op">=</span>{<span class="st">'color'</span>:<span class="st">'red'</span>}) <span class="co">#lowess=garis, line_kws=setting garis lowess, dalam kasus ini warna</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Pola corong terbalik juga terlihat di plot ini. Lalu, untuk membuat plot scale-location di python, ambil <em>studentized residual</em> dari model terebut dulu:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>sqrt_std_residual <span class="op">=</span> np.sqrt(np.<span class="bu">abs</span>(RAKL_lm.get_influence().resid_studentized_internal))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co">#hasil_model.get_influence().resid_studendized_interal: ambil studentized residual</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co">#np.sqrt: akar</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>temp_data_scaleloc <span class="op">=</span> pd.DataFrame(<span class="bu">dict</span>(fitted_values<span class="op">=</span>RAKL_lm.fittedvalues,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>                              sqrt_std_residual<span class="op">=</span>sqrt_std_residual)) <span class="co">#masukkan dataFrame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lalu, plot-kan:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> sns.lmplot(x<span class="op">=</span><span class="st">'fitted_values'</span>, y<span class="op">=</span><span class="st">'sqrt_std_residual'</span>, data<span class="op">=</span>temp_data_scaleloc, lowess<span class="op">=</span><span class="va">True</span>, line_kws<span class="op">=</span>{<span class="st">'color'</span>:<span class="st">'red'</span>})</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-25-3.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Pola menurun terlihat juga di plot ini.</p>
</section>
<section id="uji-formal-untuk-kehomogenan-ragam" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="uji-formal-untuk-kehomogenan-ragam"><span class="header-section-number">4.2.2</span> Uji formal untuk kehomogenan ragam</h3>
<p>Khalayak yang berbeda dapat memberikan tafsiran berbeda untuk tiap plot, khususnya jika ketidakhomogenan ragam tidak seekstrim di contoh sebelumnya. Pola-pola tertentu belum tentu terlihat, khususnya jika audiens kurang teliti. Oleh karena itu, perlu uji formal untuk kehomogenan ragam. Semua uji yang akan diperlihatkan memiliki hipotesis:</p>
<p><span class="math display">\[
\begin{aligned}
H_{0}&amp;:\sigma_{1}^2=\sigma_{2}^2=...=\sigma_{t}^2=\sigma^2 \text{ (ragam homogen)}\\
H_{1}&amp;:\text{ Setidaknya satu }\sigma_{i}^2\neq\sigma^2 \text{ (ragam tak homogen)}
\end{aligned}
\]</span></p>
<section id="uji-yang-didasari-asumsi-normalitas-bartlett-dan-hartley" class="level4" data-number="4.2.2.1">
<h4 data-number="4.2.2.1" class="anchored" data-anchor-id="uji-yang-didasari-asumsi-normalitas-bartlett-dan-hartley"><span class="header-section-number">4.2.2.1</span> Uji yang didasari asumsi normalitas: Bartlett dan Hartley</h4>
<p>Uji Bartlett memiliki statistik uji:</p>
<p><span class="math display">\[
\begin{aligned}
\chi_{0}^2&amp;=2.3026\frac{q}{c}\\
q&amp;=(N-t)\log_{10}S^2_p-\sum_{i=1}^t (r_{i}-1)\log_{10}S_{i}^2\\
c&amp;=1+\frac{1}{3(t-1)}\left[\sum_{i=1}^t (n_{i}-1)^{-1}-(N-a)^{-1}\right]\\
S_{p}^2&amp;=\frac{\sum_{i=1}^t(r_{i}-1)S_{i}^2}{N-t}
\end{aligned}
\]</span></p>
<p>Dengan <span class="math inline">\(S_{i}^2\)</span> adalah ragam sampel perlakuan atau kelompok ke-i, N jumlah total unit percobaan. Arti dari rumus tersebut adalah upaya membandingkan penduga ragam jika homogen <span class="math inline">\(S_{p}^2\)</span> dengan jumlah ragam sebenarnya. Jika ragam homogen, statistik q akan mendekati nol. Jika heterogen, statistik q akan besar sehingga <span class="math inline">\(H_{0}\)</span> akan ditolak jika <span class="math inline">\(\chi_{0}^2&gt;\chi_{\alpha;t-1}^2\)</span></p>
<p>Sedangkan uji Hartley memiliki statistik uji:</p>
<p><span class="math display">\[
F_{max}=\frac{max_{i}[S_{i}^2]}{min_{i}[S_{i}^2]}
\]</span></p>
<p>Atau rasio antara ragam maksimum dan ragam minimum. Uji ini mengharuskan jumlah ulangan sama. Penduga ragam menyebar chi-kuadrat jika peubah acak tersebut menyebar normal<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Jika jumlah ulangan sama di suatu perlakuan atau kelompok, maka derajat bebas tiap penduga ragam sama. Pembagian dua peubah chi-kuadrat dengan derajat bebasnya menghasilkan peubah yang menyebar F. Karena jumlah ulangan sama, angka tersebut saling terbagi.</p>
<p>Jika ada beberapa perlakuan yang digunakan, atau beberapa kelompok, dapat dilakukan uji untuk tiap perlakuan tersebut. Implementasi uji tersebut di R sebagai berikut:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(Produksi <span class="sc">~</span> Perlakuan, <span class="at">data =</span> DataRAKL) <span class="co">#uji kehomogenan ragam di tiap perlakuan</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  Produksi by Perlakuan
Bartlett's K-squared = 5.7463, df = 8, p-value = 0.6756</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(Produksi <span class="sc">~</span> Kelompok, <span class="at">data =</span> DataRAKL) <span class="co">#uji kehomogenan ragam di tiap kelompok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  Produksi by Kelompok
Bartlett's K-squared = 2.5611, df = 2, p-value = 0.2779</code></pre>
</div>
</div>
<p>Sedangkan uji Hartley:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PMCMRplus)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hartleyTest</span>(Produksi<span class="sc">~</span>Perlakuan,<span class="at">data=</span>DataRAKL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hartley's maximum F-ratio test of homogeneity of variances

data:  Produksi by Perlakuan
F Max = 22.226, df = 2, k = 9, p-value = 0.6461</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hartleyTest</span>(Produksi<span class="sc">~</span>Kelompok,<span class="at">data=</span>DataRAKL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hartley's maximum F-ratio test of homogeneity of variances

data:  Produksi by Kelompok
F Max = 3.1755, df = 8, k = 3, p-value = 0.2647</code></pre>
</div>
</div>
<p>Kedua uji tersebut tidak menolak <span class="math inline">\(H_{0}\)</span> di <span class="math inline">\(\alpha=5\%\)</span>. Oleh karena itu, kesimpulan dari dua uji tersebut adalah bahwa ragam homogen. Implementasi uji Bartlett di python menggunakan scipy sebagai berikut:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> bartlett</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>kel1 <span class="op">=</span> RAKLpy.query(<span class="st">'Kelompok == 1'</span>)[<span class="st">'Produksi'</span>] <span class="co">#ambil nilai peubah respon di tiap kelompok</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>kel2 <span class="op">=</span> RAKLpy.query(<span class="st">'Kelompok == 2'</span>)[<span class="st">'Produksi'</span>] <span class="co">#sintaks: dataframe.query('kondisi')['peubah']</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>kel3 <span class="op">=</span> RAKLpy.query(<span class="st">'Kelompok == 3'</span>)[<span class="st">'Produksi'</span>]</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>stat, p <span class="op">=</span> bartlett(kel1, kel2, kel3) <span class="co">#lakukan uji</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Statistik uji:"</span>, stat, <span class="st">"| P-value:"</span>, p) <span class="co">#print hasil uji</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Statistik uji: 2.5610747969217615 | P-value: 0.27788792377685606</code></pre>
</div>
</div>
<p>Implementasi ini cukup membosankan karena harus mengambil data tiap kelompok secara manual. Implementasi menggunakan pingouin tidak memerlukan hal tersebut. Implementasi ini lebih baik jika ada banyak kelompok. Misal, ada tujuh perlakuan berbeda. Pengambilan data untuk tiap perlakuan akan membosankan. Karena itu, gunakan pingouin:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pingouin <span class="im">as</span> pg</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>pg.homoscedasticity(RAKLpy, dv<span class="op">=</span><span class="st">'Produksi'</span>, </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>                    group<span class="op">=</span><span class="st">'Perlakuan'</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>                   method<span class="op">=</span><span class="st">'bartlett'</span>) <span class="co">#(data, peubah respon (y), faktor, metode)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 T      pval  equal_var
bartlett  5.746278  0.675628       True</code></pre>
</div>
</div>
<p>Kesimpulan uji menggunakan R ataupun python sama. Ragam homogen.</p>
</section>
</section>
<section id="uji-levene-dan-brown-forsythe" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="uji-levene-dan-brown-forsythe"><span class="header-section-number">4.2.3</span> Uji Levene dan Brown-Forsythe</h3>
<p>Uji Bartlett dan Hartley bergantung pada asumsi normalitas. Jika sebaran galat tidak normal, misal menyebar Student-t atau chi-kuadrat, uji tersebut akan cenderung mengambil keputusan yang salah. Uji tersebut dapat secara empiris memiliki <span class="math inline">\(\alpha\)</span> yang lebih tinggi dari yang diinginkan dan memiliki kuasa uji lebih rendah dari alternatif yang tidak mengasumsikan normalitas.</p>
<p>Alternatif uji yang tidak mengasumsikan normalitas adalah uji Levene, dengan statistik uji:</p>
<p><span class="math display">\[
W=\frac{(N-t)}{(t-1)}\frac{\sum_{i=1}^t r_{i}\left(\bar{Z}_{i.}-\bar{Z}_{..}\right)^2}{\sum_{i=1}^t\sum_{j=1}^r\left(Z_{ij}-\bar{Z}_{i.}\right)}
\]</span></p>
<p>Uji Levene menghasilkan sekeluarga uji dengan statistik uji yang mirip, hanya dibedakan oleh pilihan <span class="math inline">\(Z_{ij}\)</span>. Uji Levene menggunakan rata-rata perlakuan ke-i <span class="math inline">\(\bar{Y}_{i.}\)</span>, sedangkan ada juga uji yang menggunakan rata-rata terpangkas <span class="math inline">\(10\%\)</span> <span class="math inline">\(\hat{Y}_{i.}\)</span>. Uji Brown-Forsythe menggunakan median <span class="math inline">\(\bar{Y}_{i.}^{'}\)</span>. Jika disimpulkan:</p>
<p><span class="math display">\[
\begin{aligned}
\text{Levene }&amp;: Z_{ij}=|y_{ij}-\bar{y}_{i.}| &amp; \text{ (Mean)}\\
\text{Levene (trimmed) }&amp;: Z_{ij}=|y_{ij}-\hat{y}_{i.}| &amp; \text{ (Mean terpangkas)}\\
\text{Brown-Forsythe }&amp;: Z_{ij}=|y_{ij}-\bar{y}_{i.}^{'}| &amp; \text{ (Median)}\\
\end{aligned}
\]</span></p>
<p><a href="https://www.tandfonline.com/doi/abs/10.1080/01621459.1974.10482955">Brown dan Forsythe (1974)</a> membandingkan kuasa uji dan <span class="math inline">\(\alpha\)</span> empiris beberapa uji homogenitas ragam di berbagai situasi dengan simulasi. Keluarga uji Levene memiliki kuasa uji lebih rendah jika data berdistribusi normal, tetapi di distribusi Student-t dan chi-kuadrat kuasa uji Levene lebih tinggi. Uji Levene tidak kekar pada data dengan penjuluran ekstrim karena memiliki tingkat kesalahan jenis I (tolak <span class="math inline">\(H_{0}\)</span> jika <span class="math inline">\(H_{0}\)</span> benar) lebih tinggi secara empiris daripada yang dispesifikasi peneliti. Uji Brown-Forsythe sangat konservatif, bahkan dengan tingkat kesalahan jenis I (<span class="math inline">\(\alpha\)</span>) empiris lebih rendah dari yang dispesifikasi. Uji Levene dengan mean terpangkas memiliki <span class="math inline">\(\alpha\)</span> empiris paling dekat dengan yang diinginkan. Penemuan ini direplikasi di penelitian lainnya dan disimpulkan di <a href="https://www.tandfonline.com/doi/abs/10.1080/00949655.2018.1438437?journalCode=gscs20">Conover <em>et al.</em> (2018)</a>.</p>
<p>Oleh karena itu, dalam menentukan uji paling tepat untuk kehomogenan ragam, perlu diteliti sebaran dari sisaan. Jika sebaran normal, uji Bartlett ataupun Hartley paling baik. Jika sebaran tidak normal tetapi tidak menjulur ekstrim, uji Levene memilik kuasa uji paling tinggi daripada uji lainnya. Jika sebaran menjulur ekstrim, uji Levene dengan mean terpangkas atau uji Brown-Forsythe paling kekar.</p>
<p>Implementasi uji tersebut di R adalah sebagai berikut:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Produksi<span class="sc">~</span>Perlakuan, <span class="at">data=</span>DataRAKL, <span class="at">center =</span> median) <span class="co">#default (Brown Forsythe)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  8  0.5855 0.7771
      18               </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Produksi<span class="sc">~</span>Kelompok, <span class="at">data=</span>DataRAKL, <span class="at">center =</span> mean) <span class="co"># Levene (mean)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = mean)
      Df F value Pr(&gt;F)
group  2  0.8113 0.4561
      24               </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Produksi<span class="sc">~</span>Perlakuan, <span class="at">data=</span>DataRAKL, <span class="at">center =</span> mean,<span class="at">trim=</span><span class="fl">0.1</span>) <span class="co"># Levene (trimmed)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = mean: 0.1)
      Df F value Pr(&gt;F)
group  8  1.0536 0.4351
      18               </code></pre>
</div>
</div>
<p>Karena p-value lebih dari <span class="math inline">\(\alpha=5\%\)</span>, ragam dapat dianggap homogen untuk kelompok dan perlakuan di taraf tersebut. Sedangkan implementasi uji tersebut di Python:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> levene</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>statlev, plev <span class="op">=</span> levene(kel1, kel2, kel3,center<span class="op">=</span><span class="st">"median"</span>) <span class="co">#center median</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>statlev_trim, plev_trim <span class="op">=</span> levene(kel1, kel2, kel3,center<span class="op">=</span><span class="st">"mean"</span>, proportiontocut<span class="op">=</span><span class="fl">0.1</span>) <span class="co">#center mean, proportion to cut= 10 persen dipangkas</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Statistik uji (Brown-Forsythe):"</span>, statlev, <span class="st">"| P-value:"</span>, plev) <span class="co">#print hasil uji</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Statistik uji (Brown-Forsythe): 0.7589478077456477 | P-value: 0.47906740355022637</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Statistik uji (Trim):"</span>, statlev_trim, <span class="st">"| P-value:"</span>, plev_trim) <span class="co">#print hasil uji</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Statistik uji (Trim): 0.8113082087822503 | P-value: 0.45609278276162774</code></pre>
</div>
</div>
<p>Kode python untuk uji ini lebih pendek karena vektor hasil per kelompok sudah diambil sebelumnya untuk uji Bartlett. Jika menggunakan pingouin:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pingouin <span class="im">as</span> pg</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>pg.homoscedasticity(RAKLpy, dv<span class="op">=</span><span class="st">'Produksi'</span>, </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>                    group<span class="op">=</span><span class="st">'Perlakuan'</span>,</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>                   method<span class="op">=</span><span class="st">'levene'</span>) <span class="co">#(data, peubah respon (y), faktor, metode)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               W      pval  equal_var
levene  0.585459  0.777083       True</code></pre>
</div>
</div>
<p>Sayangnya, hanya dapat dilakukan uji Brown-Forsythe (atau, uji Levene menggunakan median). Walaupun implementasi pingouin lebih sederhana, metode ini kurang fleksibel.</p>
</section>
<section id="plot-vs.-uji" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="plot-vs.-uji"><span class="header-section-number">4.2.4</span> Plot vs.&nbsp;uji</h3>
<p>Terlihat bahwa hasil uji formal menyimpulkan bahwa ragam sama, sedangkan plot residual vs.&nbsp;fitted dan scale-location menunjukkan pola heteroskedastis. Mungkin, amatan 6 dan 14 berpengaruh. Coba hilangkan amatan tersebut:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>DataRAKL_tanpaoutlier<span class="ot">&lt;-</span>DataRAKL[<span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">14</span>),]</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(Produksi <span class="sc">~</span> Perlakuan, <span class="at">data =</span> DataRAKL_tanpaoutlier) <span class="co">#uji kehomogenan ragam di tiap perlakuan</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  Produksi by Perlakuan
Bartlett's K-squared = 2.5855, df = 8, p-value = 0.9576</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(Produksi <span class="sc">~</span> Kelompok, <span class="at">data =</span> DataRAKL_tanpaoutlier) <span class="co">#uji kehomogenan ragam di tiap kelompok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  Produksi by Kelompok
Bartlett's K-squared = 2.4855, df = 2, p-value = 0.2886</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Produksi <span class="sc">~</span> Perlakuan, <span class="at">data =</span> DataRAKL_tanpaoutlier) <span class="co">#uji kehomogenan ragam di tiap perlakuan</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  8  0.3319  0.941
      16               </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Produksi <span class="sc">~</span> Kelompok, <span class="at">data =</span> DataRAKL_tanpaoutlier) <span class="co">#uji kehomogenan ragam di tiap kelompok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  2  0.8511 0.4405
      22               </code></pre>
</div>
</div>
<p>Uji formal masih menandakan ragam sama. Lalu, bagaimana cara hasil plot residual vs fitted dijelaskan?</p>
<p>Pertama, plot residual per kelompok dan perlakuan relatif sama. Karena uji hanya dapat dilakukan kepada kelompok atau perlakuan, bukan kombinasinya, hasil ini sesuai dengan plot tersebut. Kedua, pola tersebut mungkin muncul karena observasi sedikit di fitted values yang besar sehingga terlihat berpola padahal tidak. Ketiga, pola tersebut mungkin muncul karena interaksi antara kelompok dan perlakuan yang menurut uji Tukey ada. Oleh karena itu, uji yang terpisah di perlakuan atau kelompok tidak dapat mendeteksi hal tersebut, tapi uji yang melihat kombinasi residual dapat mendeteksi hal tersbut. Mungkin dapat dibandingkan dengan uji Bresuch-Pagan (yang menjadi uji standar heteroskedastisitas di regresi):</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(Produksi<span class="sc">~</span>Perlakuan<span class="sc">+</span>Kelompok,<span class="at">data=</span>DataRAKL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  Produksi ~ Perlakuan + Kelompok
BP = 13.784, df = 10, p-value = 0.1831</code></pre>
</div>
</div>
<p>Walaupun masih taktolak <span class="math inline">\(H_{0}\)</span>, hasil uji Breusch-Pagan memiliki p-value lebih rendah dari uji lain. Oleh karena itu, aman untuk mengasumsikan ragam homogen di kasus ini. Selain itu karena jumlah ulangan sama, heterogenitas ragam tak berpengaruh besar, sesuai diskusi sebelumnya.</p>
</section>
</section>
<section id="galat-percobaan-saling-bebas" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="galat-percobaan-saling-bebas"><span class="header-section-number">4.3</span> Galat percobaan saling bebas</h2>
<p>Kebebasan galat merupakan asumsi yang paling penting dari ANOVA dan juga yang paling sulit diatasi ketika asumsi tersebut tidak terpenuhi. Asumsi ragam galat konstan merupakan asumsi yang terpenting kedua untuk dipenuhi setelah asumsi kebebasan galat. Akibat dari ragam galat yang tidak konstan akan mempengaruhi kesimpulan yang kita peroleh. Namun, ragam galat yang tidak konstan dapat diatasi pada banyak situasi, misal menggunakan transformasi.</p>
<p><span class="math display">\[
y_{ij} = \mu+\tau_{i}+\varepsilon_{ij}
\]</span></p>
<p>Pada model linier yang kita gunakan pada persamaan di atas, asumsi kenormalan menjadi tidak begitu penting untuk dipenuhi, terutama jika ukuran contoh yang diperoleh besar dan Teorema Limit Pusat dapat dipakai. Namun terdapat model-model tertentu yang sangat bergantung pada normalitas (Nur Hilal A. Syahrir, Statistika Terapan IPB).</p>
<p>Autokorelasi muncul ketika hasil pada amatan yang berdekatan cenderung terlalu mirip (korelasi positif) atau terlalu berbeda (korelasi negatif). Autokorelasi seringkali menjadi penyebab ketidakbebasan pada galat. Alasan amatan tidak saling bebas adalah:</p>
<ol type="1">
<li>Pengukuran berulang dilakukan ke subjek yang sama</li>
<li>Amatan berkorelasi dalam waktu</li>
<li>Amatan berkorelasi dalam tempat</li>
<li>Pengaturan sistematis dari unit percobaan</li>
</ol>
<p>Contoh pengukuran berulang dan amatan yang berkorelasi dalam waktu adalah jika tiga pohon dengan varietas berbeda diamati tingginya. Misal, tiga pohon tersebut diamati tingginya setelah satu, dua, dan tiga tahun. Jika amatan di varietas ke-i di tahun ke-j menjadi baris di data, amatan-amatan tersebut akan tidak bebas, melainkan berkorelasi dengan waktu. Oleh karena itu, amtatan tiap tahun harus dibuat kolom sendiri agar tiap baris (pohon) saling bebas. Namun, jika hanya diamati satu pohon untuk tiap varietas, tidak akan ada derajat bebas bagi ANOVA. Kasus ini menunjukkan salah satu kendala yang muncul saat penanganan amatan tak bebas.</p>
<p>Jika peneliti tersebut menyadari dari awal bahwa amatan suatu pohon di tahun berbeda tidak saling bebas, seharusnya peneliti menyiapkan beberapa pohon dari satu varietas. Jika ada pengaturan tersebut, derajat bebas cukup untuk melakukan ANOVA.</p>
<p>Contoh dari amatan yang berkorelasi dalam tempat adalah perlakuan A yang ditaruh di lereng suatu bukit dan perlakuan lainnya ditaruh di puncak bukit. Oleh karena berada di tempat geografis yang sama, amatan perlakuan A tidak saling bebas satu sama lain.</p>
<p>Pengaturan sistematis muncul ketika pengacakan tidak dilakukan dengan benar. Akan muncul pola dari urutan unit percobaan.</p>
<p>Sebelum melakukan eksplorasi ataupun uji, pastikan <strong>urutan dari amatan masuk akal</strong>. Dalam studi kasus ini, dianggap urutan amatan dari DataRAKL sesuai dengan suatu urutan waktu. Misal, baris 1 diamati sebelum baris 2, dan seterusnya. Jika <strong>urutan tidak memiliki arti</strong>, maka data dapat dengan mudah diubah urutannya agar tidak berkorelasi satu sama lain, seperti di [contoh ini] (https://stats.stackexchange.com/questions/326305/i-ran-the-durbinwatsontest-in-r-and-got-p-value-0-for-non-time-series-data-is).</p>
<section id="prosedur-eksploratif-2" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="prosedur-eksploratif-2"><span class="header-section-number">4.3.1</span> Prosedur Eksploratif</h3>
<section id="plot-residual-vs-order" class="level4" data-number="4.3.1.1">
<h4 data-number="4.3.1.1" class="anchored" data-anchor-id="plot-residual-vs-order"><span class="header-section-number">4.3.1.1</span> Plot residual vs order</h4>
<p>Memeriksa adanya autokorelasi secara eksploratif dilakukan dengan melihat plot antara sisaan dengan urutan waktu (<em>plot of residuals in time sequence</em>). Akan diteliti tren dari plot tersebut - menyebar secara acak atau tidak berpola apapun. Dapat juga melihat pola <em>plot of residual versus order</em>, khususnya apakah plot tersebut stasioner. Implementasi plotting tersebut di R adalah:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>resi <span class="ot">&lt;-</span> <span class="fu">residuals</span>(<span class="at">object =</span> aovRAKL) <span class="co">#ambil residual</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Sisaan vs Order  </span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(resi, <span class="at">type =</span> <span class="st">'o'</span>); <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Dari gambar plot sisaan vs order (plot of residual versus order) terlihat membentuk trend yang datar atau hampir datar sehingga asumsi galat percobaan saling bebas terpenuhi. Namun, titik tersebar membangun pola melebar atau menyempit (bentuk terompet) sehingga data mempunyai pola yang tidak stasioner.</p>
</section>
<section id="acf-dan-pacf" class="level4" data-number="4.3.1.2">
<h4 data-number="4.3.1.2" class="anchored" data-anchor-id="acf-dan-pacf"><span class="header-section-number">4.3.1.2</span> ACF dan PACF</h4>
<p>Selain plot tersebut, dapat dilihat plot autokorelasi (ACF) dan plot autokorelasi parsial (PACF). Lag adalah beda urutan suatu sisaan dengan sisaan sebelumnya. Misal, lag 2 berarti tiap sisaan dibandingkan dengan sisaan dua observasi sebelumnya. Jika garis vertikal di tiap lag lebih tinggi dari garis biru horizontal, maka dianggap terjadi autokorelasi di lag tersebut.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(resi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Plot korelasi parsial mengeluarkan pengaruh dari lag-lag lain. Aturan keputuasan dari plot tersebut sama dengan plot ACF:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(resi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Lag nol di plot ACF dapat diabaikan karena korelasi antara observasi dengan dirinya sendiri pasti satu. Namun, terlihat bahwa di beberapa lag bukan nol garis vertikal melewati garis horizontal sehingga dapat disimpulkan bahwa galat tidak bebas.</p>
</section>
</section>
<section id="uji-formal-untuk-galat-percobaan-saling-bebas" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="uji-formal-untuk-galat-percobaan-saling-bebas"><span class="header-section-number">4.3.2</span> Uji formal untuk galat percobaan saling bebas</h3>
<p>Uji formal untuk menentukan kebebasan galat percobaan menggunakan Runs Test (Uji Runtunan) dan Uji Durbin Watson.</p>
<section id="uji-durbin-watson" class="level4" data-number="4.3.2.1">
<h4 data-number="4.3.2.1" class="anchored" data-anchor-id="uji-durbin-watson"><span class="header-section-number">4.3.2.1</span> Uji Durbin-Watson</h4>
<p>Uji formal yang sederhana yang biasa digunakan untuk mengecek autokorelasi adalah Uji Durbin Watson. Uji Durbin Watson hanya dapat menguji ketidakbebasan galat percobaan pada lag 1. Dalam uji tersebut, anggap bahwa sisaan ke-t adalah <span class="math inline">\(e_{t}=\rho e_{t-1}+v_{t}\)</span>, di mana <span class="math inline">\(v_{t}\)</span> merupakan komponen sisaan yang memenuhi asumsi kebebasan dan kehomogenan. Oleh karena itu, hipotesis yang diuji adalah:</p>
<p><span class="math display">\[
\begin{aligned}
H_{0}&amp;: \rho=0\\
H_{1}&amp;: \rho\neq0\\
\end{aligned}
\]</span></p>
<p>Jika <span class="math inline">\(e_{k}\)</span> adalah residual yang diurut berdasarkan urutan waktu, statistik Durbin-Watson adalah:</p>
<p><span class="math display">\[
DW=\frac{\sum_{k=2}^n\left(e_{k}-e_{k-1}\right)^2}{\sum_{k=1}^n e_{k}}
\]</span></p>
<p>Interpretasi yang tepat dari nilai statistik uji Durbin-Watson, jika dilakukan secara manual, cukup sulit. Sebaran tepat statistik uji Durbin Watson bergantung pada matriks peubah bebas X sehingga tidak ada satu tabel yang mengandung nilai kritis statistik Durbin Watson. Jika tidak ada autokorelasi, DW berada di sekitar 2. Autokorelasi positif akan membuat DW kurang dari 2, dan jika terdapat autokorelasi negatif maka nilai DW akan lebih besar dari 2.</p>
<p>Sebagai perhitungan kasar, autokorelasi terjadi ketika DW berada di luar rentang 1,5 sampai 2,5. Nilai tersebut cukup besar dalam melihat efek yang nyata pada teknik inferensi. Perhatikan bahwa DW sendiri acak dan mungkin di luar jangkauan 1,5 sampai 2,5 bahkan jika residual tidak berkorelasi. Untuk kumpulan data dengan amatan yang panjang dari perlakuan yang sama, ragam dari DW kurang dari 4/N.</p>
<p>Namun, implementasi uji Durbin-Watson di berbagai software statistika, termasuk R, dapat diinterpretasikan dengan mudah karena software tersebut dapat menghitung sebaran statistik uji Durbin Watson secara eksak. Matriks peubah bebas X dapat menjadi input software dan p-value eksak dapat dikeluarkan oleh software tersebut. Uji Durbin-Watson dapat diimplentasikan melalui package lmtest atau car.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">dwtest</span>(aovRAKL,<span class="at">alternative=</span><span class="st">"two.sided"</span>, <span class="at">iter=</span><span class="dv">15</span>, <span class="at">tol=</span><span class="fl">1e-10</span>) <span class="co">#H1: rho tak sama dengan nol</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  aovRAKL
DW = 1.8764, p-value = 0.04881
alternative hypothesis: true autocorrelation is not 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#iter=iterasi algoritma pan, tol=toleransi</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(aovRAKL,<span class="at">alternative=</span><span class="st">"greater"</span>) <span class="co">#H1: rho lebih dari nol</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  aovRAKL
DW = 1.8764, p-value = 0.02441
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(aovRAKL,<span class="at">alternative=</span><span class="st">"less"</span>) <span class="co">#H1: rho kurang dari nol</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  aovRAKL
DW = 1.8764, p-value = 0.9756
alternative hypothesis: true autocorrelation is less than 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">durbinWatsonTest</span>(aovRAKL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> lag Autocorrelation D-W Statistic p-value
   1      0.04019671      1.876365   0.034
 Alternative hypothesis: rho != 0</code></pre>
</div>
</div>
<p>Lebih direkomendasikan menggunakan package lmtest karena p-value package lmtest lebih stabil. Ini terjadi karena algoritma “pan” yang digunakan package tersebut untuk mengatur p-value. Pada dasarnya, algoritma tersebut memastikan p-value konvergen (menuju ke) suatu nilai sehingga tidak berubah-ubah. Seperti dilihat di kode, toleransi telah di-set sehingga perubahan p-value dari satu iterasi ke iterasi selanjutnya lebih sedikit dari toleransi yang diinginkan. Dapat disimulasikan sebagai berikut:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>carRes<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>lmtestRes<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>)){</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  carRes[i]<span class="ot">&lt;-</span>car<span class="sc">::</span><span class="fu">durbinWatsonTest</span>(aovRAKL)<span class="sc">$</span>p</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  lmtestRes[i]<span class="ot">&lt;-</span>lmtest<span class="sc">::</span><span class="fu">dwtest</span>(aovRAKL,<span class="at">alternative=</span><span class="st">"two.sided"</span>)<span class="sc">$</span>p</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">data.frame</span>(<span class="at">car=</span>carRes,<span class="at">lmtest=</span>lmtestRes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">car</th>
<th style="text-align: right;">lmtest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.058</td>
<td style="text-align: right;">0.0488117</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.0488117</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.046</td>
<td style="text-align: right;">0.0488117</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">0.0488117</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.054</td>
<td style="text-align: right;">0.0488117</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.040</td>
<td style="text-align: right;">0.0488117</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.054</td>
<td style="text-align: right;">0.0488117</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">0.0488117</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.046</td>
<td style="text-align: right;">0.0488117</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.0488117</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(carRes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0474</code></pre>
</div>
</div>
<p>Seperti yang dapat dilihat, p-value dari library car sangat tidak stabil, sehingga mungkin saja keputusan uji berubah-ubah. Gunakan lmtest saja. Implementasi di python sebagai berikut:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.stattools <span class="im">import</span> durbin_watson</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="co">#perform Durbin-Watson test</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>durbin_watson(RAKL_lm.resid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1.8763649943450147</code></pre>
</div>
</div>
<p>Implementasi dari statsmodels tidak dapat memberikan p-value. Oleh karena itu, implementasi dari dwtest, dengan sintaks mirip lmtest dapat menjadi alternatif:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dwtest <span class="im">import</span> dwtest</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>dw,pval<span class="op">=</span>dwtest(formula<span class="op">=</span><span class="st">'Produksi~Perlakuan+Kelompok'</span>,data<span class="op">=</span>RAKLpy,alternative<span class="op">=</span><span class="st">"two_sided"</span>,iterations<span class="op">=</span><span class="dv">15</span>,tol<span class="op">=</span><span class="fl">1e-10</span>)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p-value:"</span>,pval,<span class="st">"| DW:"</span>,dw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>p-value: 0.03261757679080751 | DW: 1.8779282884437019</code></pre>
</div>
</div>
<p>Namun, sepertinya implementasi dwtest menghitung nilai statistik uji DW dengan kurang tepat - statistik uji tersebut sedikit berbeda dari keluaran statsmodels atau R. Dari keluaran di atas dapat dilihat bahwa pada uji Durbin Watson ini memiliki nilai p-value <span class="math inline">\(&lt; \alpha = 0.05\)</span> maka Tolak <span class="math inline">\(H_{0}\)</span>, artinya cukup bukti untuk mengatakan bahwa ada autokorelasi. Oleh karena itu, karena autokorelasi seringkali menjadi penyebab ketidakbebasan pada galat maka asumsi galat percobaan saling bebas belum terpenuhi.</p>
<p>Uji Durbin-Watson memiliki beberapa kelemahan:</p>
<ol type="1">
<li>Seperti yang dijelaskan sebelumnya, uji tersebut mengasumsikan autokorelasi pada lag 1 saja.</li>
<li>Uji tidak dapat digunakan dalam model autoregresif (memiliki peubah tak bebas dari periode sebelumnya)</li>
<li>Uji sensitif terhadap asumsi normalitas.</li>
</ol>
</section>
<section id="runs-test" class="level4" data-number="4.3.2.2">
<h4 data-number="4.3.2.2" class="anchored" data-anchor-id="runs-test"><span class="header-section-number">4.3.2.2</span> Runs test</h4>
<p>Oleh karena itu, dapat digunakan Runs test. Misal ada 15 data, maka jika nilai data naik dari nilai sebelumnya dinotasikan positif (+), dan sebaliknya dinotasikan negatif (-). Jika proses tersebut menghasilkan + + + + − − − + + + − − + + +, ada 5 run, 3 positif dan 2 negatif. Sebuah run merupakan kumpulan tanda positif atau negatif. Jumlah run tersebut menjadi statistik uji runs test, dengan implementasi di R berupa:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run Test</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="co"># H0 (null): The data was produced in a random manner.</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ha (alternative): The data was not produced in a random manner.</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(snpar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'snpar'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tseries':

    runs.test</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runs.test</span>(aovRAKL<span class="sc">$</span>residuals,<span class="at">exact=</span>T,<span class="at">alternative =</span><span class="st">"two.sided"</span>) <span class="co">#exact=p-value tepat</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact runs test

data:  aovRAKL$residuals
Runs = 13, p-value = 0.6951
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Implementasi di python dapat dilihat di <a href="https://gist.github.com/kwcooper/b1ff695d6ff9dc0189d52fe9ba4dc567">sini</a>.</p>
<p>Nilai p dari pengujian ini adalah 0.6951. Karena p-value lebih dari taraf nyata 0.05, maka tak tolak hipotesis nol. Hal ini menunjukkan belum cukup bukti untuk mengatakan bahwa data dihasilkan secara tidak acak.</p>
</section>
<section id="autokorelasi-dengan-lag-lebih-dari-1-breusch-godfrey-dan-modifikasi-durbin-watson" class="level4" data-number="4.3.2.3">
<h4 data-number="4.3.2.3" class="anchored" data-anchor-id="autokorelasi-dengan-lag-lebih-dari-1-breusch-godfrey-dan-modifikasi-durbin-watson"><span class="header-section-number">4.3.2.3</span> Autokorelasi dengan lag lebih dari 1: Breusch-Godfrey dan modifikasi Durbin-Watson</h4>
<p>Seperti dijelaskan sebelumnya, uji Durbin Watson hanya dapat menguji autokorelasi lag 1. Namun, terlihat di plot ACF dan PACF bahwa autokorelasi muncul di lag 2 dan 4. Alternatif sederhana untuk menguji hal tersebut adalah menambah order di fungsi uji Durbin Watson car:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">durbinWatsonTest</span>(aovRAKL,<span class="at">max.lag=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> lag Autocorrelation D-W Statistic p-value
   1      0.04019671      1.876365   0.044
   2     -0.36296687      2.584265   0.276
 Alternative hypothesis: rho[lag] != 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">durbinWatsonTest</span>(aovRAKL,<span class="at">max.lag=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> lag Autocorrelation D-W Statistic p-value
   1      0.04019671      1.876365   0.048
   2     -0.36296687      2.584265   0.272
   3     -0.41913635      2.582042   0.192
   4     -0.06558390      1.720913   0.738
 Alternative hypothesis: rho[lag] != 0</code></pre>
</div>
</div>
<p>Atau, dapat digunakan uji Breusch-Godfrey. Pada dasarnya, dilakukan regresi residual dengan peubah bebas dan residual lag sebelumnya, lalu dihitung <span class="math inline">\(R^2\)</span>. Secara asimptotik, <span class="math inline">\(nR^2\sim\chi^2_{p}\)</span>. Implementasi uji tersebut di R:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bgtest</span>(aovRAKL,<span class="at">order=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey test for serial correlation of order up to 1

data:  aovRAKL
LM test = 0.084631, df = 1, p-value = 0.7711</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bgtest</span>(aovRAKL,<span class="at">order=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey test for serial correlation of order up to 2

data:  aovRAKL
LM test = 7.5086, df = 2, p-value = 0.02342</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bgtest</span>(aovRAKL,<span class="at">order=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey test for serial correlation of order up to 4

data:  aovRAKL
LM test = 17.379, df = 4, p-value = 0.001631</code></pre>
</div>
</div>
<p>Uji tersebut tak menolak <span class="math inline">\(H_{0}\)</span> di lag 1, tapi di lag selanjutnya uji tersebut menolak <span class="math inline">\(H_{0}\)</span>. Implementasi di Python:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span>  statsmodels.stats.diagnostic <span class="im">import</span> acorr_breusch_godfrey</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>bgstat,pbg,fstat,pf<span class="op">=</span>acorr_breusch_godfrey(RAKL_lm,nlags<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Statistik uji:"</span>, bgstat, <span class="st">"| P-value:"</span>, pbg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Statistik uji: 7.508563644839594 | P-value: 0.023417262324381103</code></pre>
</div>
</div>
<p>Diskusi mengenai kuasa uji autokorelasi dilakukan di <a href="https://pjsor.com/pjsor/article/view/2691">Ulyanto (2020)</a>.</p>
</section>
</section>
<section id="konsekuensi-dari-ketidakbebasan-pada-galat" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="konsekuensi-dari-ketidakbebasan-pada-galat"><span class="header-section-number">4.3.3</span> Konsekuensi dari ketidakbebasan pada galat</h3>
<ol type="1">
<li>Ragam dari rataan contoh bukan lagi (<span class="math inline">\(\frac{\sigma^2}{n}\)</span>) pada data yang tidak saling bebas</li>
</ol>
<p>Ketika galat tidak saling bebas tapi sebaliknya memenuhi asumsi, maka dugaan dari pengaruh perlakuan yang kita peroleh masih tak bias, dan KTG mendekati tak bias untuk menduga <span class="math inline">\(\sigma^2\)</span> ketika ukuran contah besar. Perbedaannya ialah ragam dari rataan tidak lagi <span class="math inline">\(\sigma^2\)</span> dibagi dengan ukuran sampel (<span class="math inline">\(\frac{\sigma^2}{n}\)</span>). Ini berarti bahwa dugaan standar error untuk rataan perlakuan dan perbandingan perlakuan adalah dugaan yang bias, (apakah penyimpangannya terlalu besar atau kecil tergantung pada pola ketidaksalingbebasan pada galat), sehingga selang kepercayaan dan uji anova tidak akan memiliki laju kesalahan yang dibutuhkan. Uji-F pada ANOVA akan dipengaruhi oleh alasan yang sama.</p>
<ol start="2" type="1">
<li>Uji-F pada ANOVA kekar terhadap ketidakbebasan</li>
</ol>
<p>Uji-F pada ANOVA kekar terhadap ketidakbebasan jika dipertimbangkan sebagai uji pengacakan. Artinya bahwa rataan di semua pengacakan yang mungkin, uji-F akan menolak hipotesis nol ketika hipotesis nol benar.Masalah yang lebih berat dapat muncul ketika tidak ada pengacakan pada suluruh ketidakbebasan. Misalnya, perlakuan mungkin diterapkan untuk unit-unit pada pengacakan. Tapi ketika respon-respon peralakuan diukur, diikuti oleh semua perlakuan dua unit, dan seterusnya. Penerapan pengacakan dari perlakuan untuk unit-unit tidak akan membantu, jika terdapat korelasi yang kuat pada pengukuran galat.</p>
</section>
</section>
<section id="aditivitas" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="aditivitas"><span class="header-section-number">4.4</span> Aditivitas</h2>
<p>Rancangan-rancangan seperti RAKL dan RBSL mengasumsikan bahwa pengaruh perlakuan dan kelompok <strong>aditif</strong> - pengaruh tersebut tetap sama di semua kombinasi perlakuan dan kelompok. Sifat tersebut terlihat dari model linear untuk RAKL:</p>
<p><span class="math display">\[
y_{ij}=\mu+\tau_{i}+\beta_{j}+\varepsilon_{ij}
\]</span></p>
<p>Terlihat bahwa tidak ada interaksi <span class="math inline">\((\tau_{i}\beta_{j})\)</span> antara perlakuan dan kelompok. Dalam kata lain, efek suatu kelompok dianggap sama di semua perlakuan. Jika asumsi tersebut tidak terpenuhi, dapat terlihat bahwa:</p>
<p><span class="math display">\[
v_{ij}=\lambda_{ij}+\varepsilon_{ij}=y_{ij}-\mu-\tau_{i}-\beta_{j}
\]</span></p>
<p>Akan menjadi komponen galat. Ini berarti galat akan heterogen tergantung besaran interaksi di kelompok dan perlakuan tertentu, sehingga ragam galat tidak terduga dengan benar. Oleh karena uji-F menggunakan penduga ragam galat, hasil-hasil uji dapat <em>misleading</em>. Ada beberapa cari menguji asumsi ini.</p>
<section id="plot-interaksi" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="plot-interaksi"><span class="header-section-number">4.4.1</span> Plot Interaksi</h3>
<p>Plot interaksi sudah didiskusikan di <a href="#plot-interaksi">Bab 2</a>. Jika garis plot interaksi sejajar, asumsi keaditifan dianggap terpenuhi. Jika plot interaksi tidak sejajar, ada bukti untuk menduga bahwa asumsi keaditifan tidak terpenuhi. Sebagai contoh, plot interaksi ini:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DataRAKL, <span class="fu">aes</span>(<span class="at">x =</span> Perlakuan, <span class="at">y =</span> Produksi, <span class="at">colour =</span> Kelompok)) <span class="sc">+</span> </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> DataRAKL, <span class="fu">aes</span>(<span class="at">y =</span> Produksi)) <span class="sc">+</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> DataRAKL, <span class="fu">aes</span>(<span class="at">y =</span> Produksi, <span class="at">group =</span> Kelompok)) <span class="sc">+</span> </span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="04-Bab4_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Menandakan bahwa mungkin ada interaksi antara perlakuan dan kelompok karena garis plot interaksi tidak sejajar.</p>
</section>
<section id="uji-formal" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="uji-formal"><span class="header-section-number">4.4.2</span> Uji formal</h3>
<p>Asumsi aditivitas juga dapat diuji secara formal. Ada beberapa uji aditivitas yang dapat digunakan, antara lain uji Tukey, uji Mandel, uji Johnson-Graybill, uji Tussel, dan uji LBI (<em>locally best invariant</em>). Akan diberikan sintaks untuk tiap uji tersebut. Uji Tukey dan uji Tussel akan dijelaskan secara singkat. Filosofi inti dari uji Tukey mirip dengan uji Mandel, sedangkan filosofi uji Johnson-Graybill, Tussel, dan LBI juga saling mirip. Oleh karena itu, hanya akan diberikan penjelasan singkat mengenai uji Tukey dan Tussel. Referensi tambahan mengenai uji aditivitas dapat dilihat di <a href="https://www2.karlin.mff.cuni.cz/~antoch/robust08/postery/simeckova.pdf">Simeckova <em>et al.</em> (2018)</a></p>
<section id="asumsi-bentuk-interaksi-tertentu-uji-tukey" class="level4" data-number="4.4.2.1">
<h4 data-number="4.4.2.1" class="anchored" data-anchor-id="asumsi-bentuk-interaksi-tertentu-uji-tukey"><span class="header-section-number">4.4.2.1</span> Asumsi bentuk interaksi tertentu: uji Tukey</h4>
<p>Jika kita menggunakan rancangan faktorial, di mana kombinasi perlakuan diulang sebanyakan <span class="math inline">\(r\)</span> kali, uji-F untuk efek interaksi merupakan bagian dari ANOVA. Namun, derajat bebas galat di rancangan faktorial adalah <span class="math inline">\(ab(n-1)\)</span>, sedangkan <span class="math inline">\(n=1\)</span> di RAKL - satu perlakuan hanya muncul sekali di tiap kelompok. Derajat bebas galat akan nol jika kita menggunakan cara tersebut.</p>
<p>Namun, Uji Tukey pada dasarnya hanya menambahkan satu parameter <span class="math inline">\(\theta\)</span>. Parameter tersebut hanya mengambil satu derajat bebas sehingga derajat bebas galat tidak menjadi nol. Akan dibandingkan model tanpa interaksi dengan model berbentuk:</p>
<p><span class="math display">\[
y_{ij}=\mu+\tau_{i}+\beta_{j}+\theta\tau_{i}\beta_{j}+\varepsilon_{ij}
\]</span></p>
<p>Dalam kata lain, penduga interaksi dalam uji Tukey berbentuk <span class="math inline">\(\lambda_{ij}=\theta\bar{y}_{i.}\bar{y}_{.j}\)</span> - perkalian antara rata-rata perlakuan ke-i dan rata-rata kelompok ke-j, serta suaut konstanta. Oleh karena itu, hipotesis uji Tukey adalah:</p>
<p><span class="math display">\[
\begin{aligned}
H_{0}&amp;: \theta=0 \text{ (Model aditif)} \\
H_{1}&amp;: \theta\neq0 \text{ (Model tak aditif)}
\end{aligned}
\]</span></p>
<p>Dengan statistik uji:</p>
<p><span class="math display">\[
\begin{aligned}
S_{T}&amp;=\frac{KT_{interaksi}}{KTG} \sim F_{(\alpha,1,db_{g})}\\
KT_{interaksi}&amp;=JK_{interaksi}=\frac{\left[\sum_{i=1}^t\sum_{j=1}^r y_{ij}(\bar{y}_{i.}-\bar{y}_{..})(\bar{y}_{.j}-\bar{y}_{..})\right]^2}{\sum_{i=1}^t(\bar{y}_{i.}-\bar{y}_{..})^2\sum_{j=1}^r(\bar{y}_{.j}-\bar{y}_{..})^2}\\
JK_{P}&amp;=r\sum_{i=1}^t(\bar{y}_{i.}-\bar{y}_{..})^2\\
JK_{K}&amp;=t\sum_{j=1}^r(\bar{y}_{.j}-\bar{y}_{..})^2\\
JK_{T}&amp;=\sum_{i=1}^t\sum_{j=1}^r(\bar{y}_{ij}-\bar{y}_{..})^2\\
JK_{G}&amp;=JK_{T}-JK_{P}-JK_{K}-JK_{interaksi}\\
KT_{g}&amp;=\frac{JK_{G}}{db_{g}}=\frac{JK_{G}}{(t-1)(r-1)-1}
\end{aligned}
\]</span></p>
<p>Note, <span class="math inline">\(db_{g}=(t-1)(r-1)-1\)</span> karena derajat bebas galat RAKL biasa berupa <span class="math inline">\((t-1)(r-1)\)</span>, tertapi satu derajat bebas diambil <span class="math inline">\(\theta\)</span>. Untuk mengimplementasikan uji di R, data harus berbentuk matriks - dalam kata lain, tiap kelompok merupakan baris, dan tiap kolom merupakan perlakuan. Lalu, kolom kelompok harus tidak ada. Matriks hanya berisi data, dengan tiap baris menandakan kelompok dan kolom menandakan perlakuan.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>DataRAKLWide<span class="ot">&lt;-</span><span class="fu">dcast</span>(DataRAKL,Kelompok<span class="sc">~</span>Perlakuan,<span class="at">value.var=</span><span class="st">"Produksi"</span>) <span class="co"># (data, baris~kolom)</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(DataRAKLWide[<span class="sc">-</span><span class="dv">1</span>]) <span class="co">#keluarkan kolom 1 (nama kelompok)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lakukan uji:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(additivityTests)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tukey.test</span>(Y,<span class="at">alpha=</span><span class="fl">0.05</span>) <span class="co">#alpha dapat dispesifikasi</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Tukey test on 5% alpha-level:

Test statistic: 9.213 
Critival value: 4.543 
The additivity hypothesis was rejected.</code></pre>
</div>
</div>
<p>Uji Tukey menolak <span class="math inline">\(H_{0}\)</span>, sehingga dapat disimpulkan <span class="math inline">\(\theta\neq0\)</span> dan model tak aditif. Bandingkan dengan uji Mandel:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mandel.test</span>(Y,<span class="at">alpha=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Mandel test on 5% alpha-level:

Test statistic: 4.316 
Critival value: 3.739 
The additivity hypothesis was rejected.</code></pre>
</div>
</div>
<p>Uji tersebut juga menolak <span class="math inline">\(H_{0}\)</span>.</p>
</section>
<section id="uji-dari-akar-ciri-tussel-lbi-johnson-graybill" class="level4" data-number="4.4.2.2">
<h4 data-number="4.4.2.2" class="anchored" data-anchor-id="uji-dari-akar-ciri-tussel-lbi-johnson-graybill"><span class="header-section-number">4.4.2.2</span> Uji dari akar ciri: Tussel, LBI, Johnson-Graybill</h4>
<p>Uji Tukey mengasumsikan bentuk interaksi tertentu. Namun, bisa saja bentuk interaksi antara kelompok dan perlakuan lebih kompleks dari yang diberikan uji Tukey. Dalam kasus ini, kuasa uji (probabilitas menolak <span class="math inline">\(H_{0}\)</span> jika <span class="math inline">\(H_{1}\)</span> benar) dari uji Tukey dan Mandel relatif lebih rendah.</p>
<p>Ketiga uji ini muncul dari mengkaji matriks residual <span class="math inline">\(R\)</span>, di mana elemen matriks tersebut adalah:</p>
<p><span class="math display">\[
r_{ij}=y_{ij}-\bar{y}_{i.}-\bar{y}_{.j}+\bar{y}_{..}
\]</span></p>
<p>Lalu, matriks tersebut akan dikali dengan transposenya, <span class="math inline">\(RR^{T}\)</span> dan akan dicari akar ciri matriks tersebut. Akar ciri diurutkan sehingga <span class="math inline">\(k_{1}\geq k_{2}\geq ... \geq k_{n}\)</span>. Lalu, tiap akar ciri dibagi dengan jumlah total akar ciri, sehingga <span class="math inline">\(\omega_{i}=k_{1}/\sum_{i=1}^n k_{i}\)</span>. Jika ada interaksi, beberapa <span class="math inline">\(\omega_{i}\)</span> akan lebih besar dari yang lainnya. Statistik uji Johnson-Graybill merupakan akar ciri terstandarisasi terbesar <span class="math inline">\(\omega_{1}\)</span>. Statistik uji Tussel dan LBI mencari m jumlah akar ciri, di mana jumlah tersebut adalah <span class="math inline">\(min(r,t)-1\)</span>. Maka, dicari jumlah yang terkecil dari jumlah perlakuan atau jumlah kelompok. Angka tersebut dikurangi satu dan diambil m akar ciri sebanyak jumlah tersebut. LBI menambahkan akar ciri tersebut sedangkan Tussel mengalikan akar ciri. Johnson Graybill dan LBI menolak <span class="math inline">\(H_{0}\)</span> jika statistik ujinya lebih besar dari nilai kritis. Uji Tussel menolak <span class="math inline">\(H_{0}\)</span> jika statistik ujinya lebih kecil dari nilai kritis. Implementasi uji di R:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">johnson.graybill.test</span>(Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Johnson and Graybill test on 5% alpha-level:

Test statistic: 0.7262 
Critival value: 0.8799 
The additivity hypothesis cannot be rejected.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lbi.test</span>(Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Locally Best Invariant test on 5% alpha-level:

Test statistic: 0.6024 
Critival value: 0.7797 
The additivity hypothesis cannot be rejected.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tusell.test</span>(Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Tusell test on 5% alpha-level:

Test statistic: 0.1988 
Critival value: 0.1089 
The additivity hypothesis cannot be rejected.</code></pre>
</div>
</div>
<p>Dapat dilihat bahwa hasil uji Tukey dan Mandel berbeda dengan uji berdasarkan akar ciri. <span class="math inline">\(\alpha\)</span> sama - dalam kata lain, probabilitas menolak <span class="math inline">\(H_{0}\)</span> jika <span class="math inline">\(H_{0}\)</span> benar sama. Namun, kuasa uji berbeda. Jika bentuk interaksi sederhana (<span class="math inline">\(\theta\tau_{i}\beta_{j}\)</span>), uji Tukey dan Mandel memiliki kuasa lebih besar dari uji berdasarkan akar ciri. Namun, jika bentuk interaksi lebih kompleks, uji akar ciri memiliki kuasa lebih besar.</p>
<p>Dalam kasus ini, dapat dilihat skenario-skenario tertentu. Jika interaksi kompleks, seharusnya uji Tukey dan Mandel cendurung taktolak <span class="math inline">\(H_{0}\)</span> (karena kuasa uji lebih rendah) dan uji akar ciri cenderung menolak <span class="math inline">\(H_{0}\)</span>. Jika interaksi sederhana, seharusnya uji Tukey dan Mandel cenderung tolak <span class="math inline">\(H_{0}\)</span> (karena kuasa uji lebih tinggi) dan uji akar ciri cenderung taktolak <span class="math inline">\(H_{0}\)</span>. Jika tidak ada interaksi, <span class="math inline">\(\alpha\)</span> sudah dibuat sama sehingga seharusnya tidak ada kecenderungan tertentu.</p>
<p>Kasus ini sepertinya sesuai dengan skenario interaksi sederhana. Oleh karena itu, hasil uji Tukey dan Mandel dapat lebih dipercaya. Selain itu, sudah ada plot interaksi yang memperkuat kepercayaan bahwa interaksi benar adanya.</p>
<p>Sebagai tambahan terakhir, implementasi uji Tukey di Python dapat dilihat di notebook Google Colab <a href="https://colab.research.google.com/drive/1JpEQ5KDOACZIBDlQW770NCJnaFDLNCQ3?usp=sharing">ini</a>.</p>


<!-- -->

</section>
</section>
</section>
<section class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1" role="doc-endnote"><p>Dapat dilihat di buku Teori Statistika seperti Ramachandran dan Tsokos<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-Bab3.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Perbandingan Nilai Tengah Perlakuan</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-Bab5.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Rancangan Faktorial</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb148" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Uji Asumsi</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>Prosedur ANOVA mengasumsikan beberapa hal mengenai struktur model dan struktur galat. Jika asumsi tersebut tidak terpenuhi, hasil dari ANOVA mungkin saja tidak valid. Oleh karena itu, pengujian asumsi sangat penting untuk diketahui.</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="fu">## Galat percobaaan menyebar normal</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="fu">### Prosedur Eksploratif</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>Secara eksploratif dalam mendeteksi kenormalan pada galat dapat menggunakan plot peluang normal (Normal probability (Q-Q) plot) dan histogram sisaan.</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>Metode grafis plot peluang normal (Normal probability (Q-Q) plot) memiliki sumbu vertikal plot (nilai data yang berurut) dan  sumbu horizontal plot (nilai peluang normal). Untuk mendeteksi normalitas pada residual, maka pada sumbu vertikal plot NPP merupakan residual yang terurut dan pada sumbu horizontal merupakan skor peluang normal yang terurut dari residual. Jika pada NPP diperoleh garis yang lurus atau mendekati/hampir lurus maka data residual tersebut menyebar normal. Garis tersebut tidak akan betul-betul lurus sempurna karena adanya keragaman contoh. Jika dibuat plot NPP untuk data tidak normal, plot akan cenderung melengkung, dan bentuk kelengkungan tersebut dapat menjadi informasi sejauh mana penyimpangan ketidaknormalannya.</span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE}</span></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(googlesheets4)</span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>DataRAKL<span class="ot">&lt;-</span><span class="fu">read_sheet</span>(<span class="st">"https://docs.google.com/spreadsheets/d/1uFi_Njharot8G8-DvHWPhNLLqJ72ym5EuuOqgeFA0hY/edit?usp=sharing"</span>)</span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a>DataRAKL<span class="sc">$</span>Produksi<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(DataRAKL<span class="sc">$</span>Produksi)</span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a><span class="co">#pastikan perlakuan dan kelompok berbentuk faktor</span></span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a>DataRAKL<span class="sc">$</span>Kelompok<span class="ot">&lt;-</span><span class="fu">as.factor</span>(DataRAKL<span class="sc">$</span>Kelompok)</span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a>DataRAKL<span class="sc">$</span>Perlakuan<span class="ot">&lt;-</span><span class="fu">as.factor</span>(DataRAKL<span class="sc">$</span>Perlakuan)</span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a>aovRAKL<span class="ot">&lt;-</span><span class="fu">aov</span>(Produksi<span class="sc">~</span>Kelompok<span class="sc">+</span>Perlakuan,<span class="at">data=</span>DataRAKL) <span class="co">#prosedur anova</span></span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(aovRAKL) <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb148-23"><a href="#cb148-23" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-24"><a href="#cb148-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-25"><a href="#cb148-25" aria-hidden="true" tabindex="-1"></a>Pertama, plot Q-Q:</span>
<span id="cb148-26"><a href="#cb148-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-29"><a href="#cb148-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-30"><a href="#cb148-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Peluang Normal (Q-Q)</span></span>
<span id="cb148-31"><a href="#cb148-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(aovRAKL, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb148-32"><a href="#cb148-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#atau#</span></span>
<span id="cb148-33"><a href="#cb148-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(aovRAKL<span class="sc">$</span>residuals); <span class="fu">qqline</span>(aovRAKL<span class="sc">$</span>residuals, <span class="at">col =</span> <span class="st">'red'</span>)</span>
<span id="cb148-34"><a href="#cb148-34" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-35"><a href="#cb148-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-36"><a href="#cb148-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-37"><a href="#cb148-37" aria-hidden="true" tabindex="-1"></a>Lalu, histogram:</span>
<span id="cb148-38"><a href="#cb148-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-41"><a href="#cb148-41" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-42"><a href="#cb148-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram Sisaan</span></span>
<span id="cb148-43"><a href="#cb148-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(aovRAKL<span class="sc">$</span>residuals,<span class="at">breaks =</span> <span class="dv">10</span>)</span>
<span id="cb148-44"><a href="#cb148-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">#atau#</span></span>
<span id="cb148-45"><a href="#cb148-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(rcompanion)</span>
<span id="cb148-46"><a href="#cb148-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotNormalHistogram</span>(aovRAKL<span class="sc">$</span>residuals, <span class="at">breaks =</span> <span class="dv">10</span>)</span>
<span id="cb148-47"><a href="#cb148-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-48"><a href="#cb148-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-49"><a href="#cb148-49" aria-hidden="true" tabindex="-1"></a>Dari plot di atas dapat terlihat bahwa semua titik cenderung berada kira-kira di sekitar sepanjang garis diagonal tetapi ada satu titik tidak dekat dengan garis dan histogram membentuk seperti kurva sebaran normal sehingga asumsi galat percobaan menyebar normal terpenuhi. Metode qq-plot dan histogram residual di python sebagai berikut. Pertama, lakukan ANOVA:</span>
<span id="cb148-50"><a href="#cb148-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-53"><a href="#cb148-53" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-54"><a href="#cb148-54" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb148-55"><a href="#cb148-55" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb148-56"><a href="#cb148-56" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb148-57"><a href="#cb148-57" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb148-58"><a href="#cb148-58" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb148-59"><a href="#cb148-59" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb148-60"><a href="#cb148-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-61"><a href="#cb148-61" aria-hidden="true" tabindex="-1"></a>RAKLpy<span class="op">=</span>pd.read_csv(<span class="st">"https://docs.google.com/spreadsheets/d/e/2PACX-1vTi9yO_OJZ5pHMmPRlPqPxK9TydeVWI--rXAYfFfwj2v6ee-vUrQGYUGYb5zgguZ5mgu9IDhwB-dIwl/pub?gid=0&amp;single=true&amp;output=csv"</span>) <span class="co">#baca data</span></span>
<span id="cb148-62"><a href="#cb148-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-63"><a href="#cb148-63" aria-hidden="true" tabindex="-1"></a>RAKL_lm<span class="op">=</span> ols(<span class="st">'Produksi ~ C(Perlakuan)+C(Kelompok)'</span>,data<span class="op">=</span>RAKLpy).fit() <span class="co">#C=peubah kategorik</span></span>
<span id="cb148-64"><a href="#cb148-64" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> sm.stats.anova_lm(RAKL_lm, typ<span class="op">=</span><span class="dv">2</span>) <span class="co"># Type 2 ANOVA DataFrame</span></span>
<span id="cb148-65"><a href="#cb148-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(table)</span>
<span id="cb148-66"><a href="#cb148-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-67"><a href="#cb148-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-68"><a href="#cb148-68" aria-hidden="true" tabindex="-1"></a>Buat plot:</span>
<span id="cb148-69"><a href="#cb148-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-72"><a href="#cb148-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-73"><a href="#cb148-73" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb148-74"><a href="#cb148-74" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb148-75"><a href="#cb148-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-76"><a href="#cb148-76" aria-hidden="true" tabindex="-1"></a><span class="co">#create Q-Q plot with 45-degree line added to plot</span></span>
<span id="cb148-77"><a href="#cb148-77" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> sm.qqplot(RAKL_lm.resid, line<span class="op">=</span><span class="st">'s'</span>)</span>
<span id="cb148-78"><a href="#cb148-78" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb148-79"><a href="#cb148-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-80"><a href="#cb148-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-81"><a href="#cb148-81" aria-hidden="true" tabindex="-1"></a>Dan untuk histogram:</span>
<span id="cb148-82"><a href="#cb148-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-85"><a href="#cb148-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-86"><a href="#cb148-86" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb148-87"><a href="#cb148-87" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb148-88"><a href="#cb148-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-89"><a href="#cb148-89" aria-hidden="true" tabindex="-1"></a>plt.clf() <span class="co">#clear plot sebelumnya</span></span>
<span id="cb148-90"><a href="#cb148-90" aria-hidden="true" tabindex="-1"></a>h<span class="op">=</span>sns.histplot(RAKL_lm.resid,bins<span class="op">=</span><span class="dv">10</span>, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb148-91"><a href="#cb148-91" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb148-92"><a href="#cb148-92" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-93"><a href="#cb148-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-94"><a href="#cb148-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-95"><a href="#cb148-95" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uji formal untuk galat percobaan menyebar normal</span></span>
<span id="cb148-96"><a href="#cb148-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-97"><a href="#cb148-97" aria-hidden="true" tabindex="-1"></a>secara formal dapat menggunakan beberapa uji tertentu diantaranya adalah Uji Kolmogorov-Smirnov, Uji Shapiro-Wilk, Uji Lilliefors, Uji Jarque-Bera, Uji Anderson-Darling, dsb.</span>
<span id="cb148-98"><a href="#cb148-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-99"><a href="#cb148-99" aria-hidden="true" tabindex="-1"></a>Semua uji tersebut memiliki hipotesis:</span>
<span id="cb148-100"><a href="#cb148-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-101"><a href="#cb148-101" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-102"><a href="#cb148-102" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb148-103"><a href="#cb148-103" aria-hidden="true" tabindex="-1"></a>H_{0}&amp;:\text{ Galat menyebar normal}<span class="sc">\\</span></span>
<span id="cb148-104"><a href="#cb148-104" aria-hidden="true" tabindex="-1"></a>H_{1}&amp;:\text{ Galat tidak menyebar normal}</span>
<span id="cb148-105"><a href="#cb148-105" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb148-106"><a href="#cb148-106" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-107"><a href="#cb148-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-108"><a href="#cb148-108" aria-hidden="true" tabindex="-1"></a>Uji Shapiro Wilk memiliki statistik uji sebagai berikut:</span>
<span id="cb148-109"><a href="#cb148-109" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-110"><a href="#cb148-110" aria-hidden="true" tabindex="-1"></a>W = \frac{\left<span class="co">[</span><span class="ot">\sum^n_{i=1} a_i x_{(i)}\right</span><span class="co">]</span>^2}{\sum^n_{i=1}(x_i – \bar{x})^2}</span>
<span id="cb148-111"><a href="#cb148-111" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-112"><a href="#cb148-112" aria-hidden="true" tabindex="-1"></a>$x_{(i)}$ adalah statistik tataan ke-i - angka terkecil ke-i dari sampel. $a_{i}$ berasal dari suatu rumus berisi mean dan matriks peragam $X$. Implementasi di R:</span>
<span id="cb148-113"><a href="#cb148-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-116"><a href="#cb148-116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-117"><a href="#cb148-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro.test</span>(<span class="at">x =</span> aovRAKL<span class="sc">$</span>residuals)</span>
<span id="cb148-118"><a href="#cb148-118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-119"><a href="#cb148-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-120"><a href="#cb148-120" aria-hidden="true" tabindex="-1"></a>Dan implementasi python:</span>
<span id="cb148-121"><a href="#cb148-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-124"><a href="#cb148-124" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-125"><a href="#cb148-125" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> shapiro</span>
<span id="cb148-126"><a href="#cb148-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-127"><a href="#cb148-127" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> (shapiro(RAKL_lm.resid))</span>
<span id="cb148-128"><a href="#cb148-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-129"><a href="#cb148-129" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"S-W statistic: </span><span class="sc">{</span>result[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb148-130"><a href="#cb148-130" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>result[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb148-131"><a href="#cb148-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-132"><a href="#cb148-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-133"><a href="#cb148-133" aria-hidden="true" tabindex="-1"></a>Dari keluaran uji Shapiro-Wilk dapat dilihat nilai p-value = 0.8832 $&gt; \alpha = 0.05$ maka tak tolak $H_{0}$, artinya tidak cukup bukti untuk mengatakan bahwa galat tidak menyebar normal sehingga asumsi galat percobaan menyebar normal terpenuhi.</span>
<span id="cb148-134"><a href="#cb148-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-135"><a href="#cb148-135" aria-hidden="true" tabindex="-1"></a>Uji Kolmogorov-Smirnov memiliki statistik uji:</span>
<span id="cb148-136"><a href="#cb148-136" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-137"><a href="#cb148-137" aria-hidden="true" tabindex="-1"></a>D_n = \sup_{x}|F_n(x) – F(x)|</span>
<span id="cb148-138"><a href="#cb148-138" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-139"><a href="#cb148-139" aria-hidden="true" tabindex="-1"></a>Atau, jarak terbesar antara fungsi kumulatif dari sampel dan fungsi kumulatif dari sebaran normal (dalam kasus menguji kenormalan). Fungsi kumulatif dapat disesuaikan untuk sebaran yang berbeda jika ingin menguji kesesuaian dengan sebaran lain. Visualisasi dari proses ini ditunjukkan di <span class="co">[</span><span class="ot">dokumen ini</span><span class="co">](https://rpubs.com/mharris/KSplot)</span>.</span>
<span id="cb148-140"><a href="#cb148-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-143"><a href="#cb148-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-144"><a href="#cb148-144" aria-hidden="true" tabindex="-1"></a><span class="co"># Uji Kolmogorov-Smirnov</span></span>
<span id="cb148-145"><a href="#cb148-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ks.test</span>(aovRAKL<span class="sc">$</span>residuals,pnorm, <span class="fu">mean</span>(aovRAKL<span class="sc">$</span>residuals), <span class="fu">sd</span>(aovRAKL<span class="sc">$</span>residuals))</span>
<span id="cb148-146"><a href="#cb148-146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-147"><a href="#cb148-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-148"><a href="#cb148-148" aria-hidden="true" tabindex="-1"></a>Dan di python:</span>
<span id="cb148-149"><a href="#cb148-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-152"><a href="#cb148-152" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-153"><a href="#cb148-153" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> kstest</span>
<span id="cb148-154"><a href="#cb148-154" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb148-155"><a href="#cb148-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-156"><a href="#cb148-156" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> kstest(RAKL_lm.resid, cdf<span class="op">=</span><span class="st">"norm"</span>,args<span class="op">=</span>(np.mean(RAKL_lm.resid),np.std(RAKL_lm.resid)))</span>
<span id="cb148-157"><a href="#cb148-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-158"><a href="#cb148-158" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"K-S statistic: </span><span class="sc">{</span>result[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb148-159"><a href="#cb148-159" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>result[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb148-160"><a href="#cb148-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-161"><a href="#cb148-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-162"><a href="#cb148-162" aria-hidden="true" tabindex="-1"></a>Dari keluaran diatas dapat dilihat nilai p-value = 0.964 (R) &gt; alpha = 0.05 maka Tak Tolak $H_{0}$, artinya tidak cukup bukti untuk mengatakan bahwa galat tidak menyebar normal sehingga dengan uji Kolmogorov-Smirnov asumsi galat percobaan menyebar normal juga terpenuhi.</span>
<span id="cb148-163"><a href="#cb148-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-164"><a href="#cb148-164" aria-hidden="true" tabindex="-1"></a>Uji Lilliefors pada dasarnya merupakan modifikasi dari uji Kolmogorov Smirnov. Uji tersebut dapat dilakukan tanpa menspesifikasi mean dan simpangan baku dari sebaran normal yang hendak diuji, serta memberikan koreksi pada nilai Kolmogorov Smirnov. Implementasi di R:</span>
<span id="cb148-165"><a href="#cb148-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-168"><a href="#cb148-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-169"><a href="#cb148-169" aria-hidden="true" tabindex="-1"></a><span class="co"># Uji Lilliefors</span></span>
<span id="cb148-170"><a href="#cb148-170" aria-hidden="true" tabindex="-1"></a><span class="co"># Hipotesis: H0 : galat menyebar normal</span></span>
<span id="cb148-171"><a href="#cb148-171" aria-hidden="true" tabindex="-1"></a><span class="co">#            H1 : galat tidak menyebar normal</span></span>
<span id="cb148-172"><a href="#cb148-172" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest)</span>
<span id="cb148-173"><a href="#cb148-173" aria-hidden="true" tabindex="-1"></a><span class="fu">lillie.test</span>(aovRAKL<span class="sc">$</span>residuals)</span>
<span id="cb148-174"><a href="#cb148-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-177"><a href="#cb148-177" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-178"><a href="#cb148-178" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.diagnostic <span class="im">import</span> lilliefors</span>
<span id="cb148-179"><a href="#cb148-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-180"><a href="#cb148-180" aria-hidden="true" tabindex="-1"></a>D,p<span class="op">=</span>lilliefors(RAKL_lm.resid,dist<span class="op">=</span><span class="st">'norm'</span>,pvalmethod<span class="op">=</span><span class="st">'table'</span>)</span>
<span id="cb148-181"><a href="#cb148-181" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Statistik uji: "</span>,D)</span>
<span id="cb148-182"><a href="#cb148-182" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p-value: "</span>,p)</span>
<span id="cb148-183"><a href="#cb148-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-184"><a href="#cb148-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-185"><a href="#cb148-185" aria-hidden="true" tabindex="-1"></a>Dari keluaran di atas dapat dilihat nilai p-value = 0.8199 $&gt; /alpha = 0.05$ maka Tak Tolak $H_{0}$, artinya tidak cukup bukti untuk mengatakan bahwa galat tidak menyebar normal sehingga dengan uji Lilliefors asumsi galat percobaan menyebar normal juga terpenuhi.</span>
<span id="cb148-186"><a href="#cb148-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-187"><a href="#cb148-187" aria-hidden="true" tabindex="-1"></a>Uji Jarque-Bera membandingkan skewness dan kurtosis data dengan sebaran normal. Ini dapat dilihat dari statistik uji:</span>
<span id="cb148-188"><a href="#cb148-188" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-189"><a href="#cb148-189" aria-hidden="true" tabindex="-1"></a>JB = \frac{n}{6} \times \bigg(S^2 + \frac{(K-3)^2}{4} \bigg)</span>
<span id="cb148-190"><a href="#cb148-190" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-191"><a href="#cb148-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-192"><a href="#cb148-192" aria-hidden="true" tabindex="-1"></a>n adalah jumlah sampel, S adalah skewness, dan K adalah kurtosis. Implementasi di R sebagai berikut:</span>
<span id="cb148-193"><a href="#cb148-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-194"><a href="#cb148-194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE}</span></span>
<span id="cb148-195"><a href="#cb148-195" aria-hidden="true" tabindex="-1"></a><span class="co"># Uji Jarque-Bera</span></span>
<span id="cb148-196"><a href="#cb148-196" aria-hidden="true" tabindex="-1"></a><span class="co"># Hipotesis: H0 : galat menyebar normal</span></span>
<span id="cb148-197"><a href="#cb148-197" aria-hidden="true" tabindex="-1"></a><span class="co">#            H1 : galat tidak menyebar normal</span></span>
<span id="cb148-198"><a href="#cb148-198" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb148-199"><a href="#cb148-199" aria-hidden="true" tabindex="-1"></a>tseries<span class="sc">::</span><span class="fu">jarque.bera.test</span>(aovRAKL<span class="sc">$</span>residuals)</span>
<span id="cb148-200"><a href="#cb148-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-201"><a href="#cb148-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-202"><a href="#cb148-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-203"><a href="#cb148-203" aria-hidden="true" tabindex="-1"></a>Dan implementasi python:</span>
<span id="cb148-204"><a href="#cb148-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-207"><a href="#cb148-207" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-208"><a href="#cb148-208" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> jarque_bera</span>
<span id="cb148-209"><a href="#cb148-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-210"><a href="#cb148-210" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> (jarque_bera(RAKL_lm.resid))</span>
<span id="cb148-211"><a href="#cb148-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-212"><a href="#cb148-212" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"JB statistic:"</span>, result[<span class="dv">0</span>])</span>
<span id="cb148-213"><a href="#cb148-213" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p-value:"</span>, result[<span class="dv">1</span>])</span>
<span id="cb148-214"><a href="#cb148-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-215"><a href="#cb148-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-216"><a href="#cb148-216" aria-hidden="true" tabindex="-1"></a>Dari keluaran diatas dapat dilihat nilai p-value = 0.8551 &gt; alpha = 0.05 maka Tak Tolak H0, artinya tidak cukup bukti untuk mengatakan bahwa galat tidak menyebar normal sehingga dengan uji Jarque-Bera asumsi galat percobaan menyebar normal juga terpenuhi.</span>
<span id="cb148-217"><a href="#cb148-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-218"><a href="#cb148-218" aria-hidden="true" tabindex="-1"></a>Uji Anderson-Darling merupakan modifikasi dari uji Kolmogorov Smirnov:</span>
<span id="cb148-219"><a href="#cb148-219" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-220"><a href="#cb148-220" aria-hidden="true" tabindex="-1"></a>A^2 = n \int_{-\infty}^{\infty}  \bigg (F_n(x) – F(x) \bigg )^2 w(x) dF(x)</span>
<span id="cb148-221"><a href="#cb148-221" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-222"><a href="#cb148-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-223"><a href="#cb148-223" aria-hidden="true" tabindex="-1"></a>Statistik uji tersebut masih merupakan beda antara fungsi kumulatif, tetapi beda yang terambil tidak hanya beda terbesar. Selain itu, ada pembobotan:</span>
<span id="cb148-224"><a href="#cb148-224" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-225"><a href="#cb148-225" aria-hidden="true" tabindex="-1"></a>w(x) = \bigg<span class="co">[</span><span class="ot">F(x)(1-F(x))\bigg</span><span class="co">]</span>^{-1}</span>
<span id="cb148-226"><a href="#cb148-226" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-227"><a href="#cb148-227" aria-hidden="true" tabindex="-1"></a>Sehingga bobot tersebut akan lebih besar di ujung sebaran. Implementasi di R sebagai berikut:</span>
<span id="cb148-228"><a href="#cb148-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-231"><a href="#cb148-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-232"><a href="#cb148-232" aria-hidden="true" tabindex="-1"></a><span class="co"># Uji Anderson-Darling</span></span>
<span id="cb148-233"><a href="#cb148-233" aria-hidden="true" tabindex="-1"></a><span class="co"># Hipotesis: H0 : galat menyebar normal</span></span>
<span id="cb148-234"><a href="#cb148-234" aria-hidden="true" tabindex="-1"></a><span class="co">#            H1 : galat tidak menyebar normal</span></span>
<span id="cb148-235"><a href="#cb148-235" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest)</span>
<span id="cb148-236"><a href="#cb148-236" aria-hidden="true" tabindex="-1"></a><span class="fu">ad.test</span>(aovRAKL<span class="sc">$</span>residuals)</span>
<span id="cb148-237"><a href="#cb148-237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-238"><a href="#cb148-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-239"><a href="#cb148-239" aria-hidden="true" tabindex="-1"></a>Sedangkan di python:</span>
<span id="cb148-240"><a href="#cb148-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-243"><a href="#cb148-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-244"><a href="#cb148-244" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> anderson</span>
<span id="cb148-245"><a href="#cb148-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-246"><a href="#cb148-246" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> (anderson(RAKL_lm.resid, dist<span class="op">=</span><span class="st">'norm'</span>))</span>
<span id="cb148-247"><a href="#cb148-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-248"><a href="#cb148-248" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A-D statistic:"</span>, result[<span class="dv">0</span>])</span>
<span id="cb148-249"><a href="#cb148-249" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Critical values:"</span>, result[<span class="dv">1</span>])</span>
<span id="cb148-250"><a href="#cb148-250" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Significance levels:"</span>, result[<span class="dv">2</span>])</span>
<span id="cb148-251"><a href="#cb148-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-252"><a href="#cb148-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-253"><a href="#cb148-253" aria-hidden="true" tabindex="-1"></a>Dari keluaran diatas dapat dilihat nilai p-value = 0.7851 &gt; $/alpha = 0.05$ maka Tak Tolak $H_{0}$, artinya tidak cukup bukti untuk mengatakan bahwa galat tidak menyebar normal sehingga dengan uji Anderson-Darling asumsi galat percobaan menyebar normal juga terpenuhi. Interpretasi output Python adalah dengan membandingkan statistik uji dengan nilai kritis di taraf tertentu. Misal, karena $0.2302&lt;0.517$, $H_{0}$ tak ditolak di $\alpha=15\%$. Jika nilai statistik uji lebih besar dari nilai kritis, $H_{0}$ dapat ditolak.</span>
<span id="cb148-254"><a href="#cb148-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-255"><a href="#cb148-255" aria-hidden="true" tabindex="-1"></a><span class="fu">### Konsekuensi dari ketidaknormalan pada galat.</span></span>
<span id="cb148-256"><a href="#cb148-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-257"><a href="#cb148-257" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Kemenjuluran mempengaruhi selang kepercayaan</span>
<span id="cb148-258"><a href="#cb148-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-259"><a href="#cb148-259" aria-hidden="true" tabindex="-1"></a>Kemenjuluran digunakan untuk mengukur ketidaksimetrisan data dan kurtosis digunakan untuk mengukur panjang ekor pada data. Baik kemenjuluran dan kurtosis pada sebaran normal adalah 0. Sebaran dengan ekor yang lebih panjang ke kanan ialah sebaran yang menjulur positif, sedangkan sebaran dengan ekor yang lebih panjang ke kiri ialah sebaran yang menjulur negatif. Sebaran yang simetris seperti sebaran normal mempunyai nilai kemenjuluran sama dengan 0. Sebaran dengan ekor yang lebih panjang dari normal (lebih rawan memiliki pencilan) memiliki kurtosis positif, dan mereka dengan ekor lebih pendek dari normal (cenderung memiliki sedikit pencilan) memiliki kurtosis negatif.</span>
<span id="cb148-260"><a href="#cb148-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-261"><a href="#cb148-261" aria-hidden="true" tabindex="-1"></a>Kemenjuluran mempengaruhi selang kepercayaanKemenjuluran dan kurtosis pada data dapat mempengaruhi selang kepercayaan, akan tetapi kemenjuluran mempunyai efek yang lebih besar dibanding kurtosis. Ketika suata data menyebar normal, selang kepercayaan dua arah dari sebaran t- berada pada selang/cakupan yang benar, galat yang sama besar pada data yang tinggi dan rendah. Ketika data dari sebaran mempunyai nilai kemenjuluran sama dengan nol, maka selang kepercayaan pada uji dua arah juga masih berada di sekitar nilai/cakupan yang benar, tetapi galat cenderung ke satu sisi atau sisi yang lainnya, tidak sama besar secara merata pada data yang besar dan kecil. Selang kepercayaan pada uji satu arah untuk rataan bisa menjadi masalah yang serius. </span>
<span id="cb148-262"><a href="#cb148-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-263"><a href="#cb148-263" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Pencilan, kekekaran, dan resistensi</span>
<span id="cb148-264"><a href="#cb148-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-265"><a href="#cb148-265" aria-hidden="true" tabindex="-1"></a>Suatu pencilan dapat mempengaruhi rataan perlakuan juga KTG. Sehingga inferensi yang diperoleh jika memasukkan dan mengeluarkan pencilan akan berbeda. Hal ini mungkin berguna untuk membedakan untuk membedakan antara kekekaran (validitas) dan resistensi (untuk pencilan). Kekekaran pada validitas artinya bahwa prosedur tersebut memberikan kesimpulan yang masih mendekati benar, bahkan ketika beberapa asumsi kita (seperti normalitas) tidak terpenuhi. Jadi dapat dikatakan bahwa uji-F pada ANOVA masih kekar, karena nilai uji-F 5% menolak nol di sekitar 5% dari seluruh contoh ketika hipotesin nol benar, bahkan ketika data yang diperoleh agak tidak normal. Suatu prosedur dikatakan resisten jika satu atau beberapa nilai data individu tidak mengubah inferensi dari suatu data. Walaupun uji F kekar pada validitasnya, tetapi uji-F tidak resisten terhadap pencilan.</span>
<span id="cb148-266"><a href="#cb148-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-267"><a href="#cb148-267" aria-hidden="true" tabindex="-1"></a><span class="fu">## Kehomogenan ragam</span></span>
<span id="cb148-268"><a href="#cb148-268" aria-hidden="true" tabindex="-1"></a>Terkadang, sisaan tidak konstan di nilai $\hat{y}$ yang berbeda (dalam kata lain, di taraf faktor berbeda-beda). Jika penurunan ANOVA yang diberikan di Montgomery (2017) diteliti, penurunan nilai harapan $KT_{G}$ sebagai penduga $\sigma^2$ memerlukan asumsi kehomogenan ragam. Oleh karena itu, jika asumsi tersebut tidak terpenuhi, penduga ragam yang dimiliki bukan penduga terbaik. Ini berarti penduga efek perlakuan, kelompok, dan lainnya belum tentu efisien (ragam belum tentu terkecil) dan hasil uji-F dapat salah. Namun, penduga tersebut masih tak bias karena ketidakbiasan muncul dari nilai harapan $e_{ij}$, dan sifat tersebut dipastikan MKT.</span>
<span id="cb148-269"><a href="#cb148-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-270"><a href="#cb148-270" aria-hidden="true" tabindex="-1"></a>Dalam rancangan percobaan dengan jumlah ulangan sama di semua perlakuan, uji-F tidak terlalu dipengaruhi ragam tak homogen. Namun, jika jumlah ulangan tidak sama atau jika ada ragam yang jauh lebih besar dari ragam lainnya, masalah tersebut lebih serius. Jika ragam besar muncul di perlakuan dengan ulangan sedikit, $\alpha$ aktual lebih besar dari yang diinginkan (sehingga lebih mungkin menolak $H_{0}$ jika $H_{0}$ benar). Jika ragam besar muncul di perlakuan dengan ulangan banyak $\alpha$ aktual lebih kecil dari yang diinginkan (peneliti tanpa sengaja memilih uji yang terlalu ketat). Jika model acak digunakan, inferensia mengenai ragam akan terganggu walaupun ulangan sama digunakan.</span>
<span id="cb148-271"><a href="#cb148-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-272"><a href="#cb148-272" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Blanca *et al.* (2017)</span><span class="co">](https://link.springer.com/article/10.3758/s13428-017-0918-2)</span> mendiskusikan kekekaran uji-F di berbagai situasi. Sama seperti Montgomery, ragam tak sama tidak menganggu uji-F saat ulangan sama. Namun, uji-F terganggu jika jumlah ulangan tak sama saat rasio antara ragam perlakuan terkecil dan terbesar lebih dari 1.5.</span>
<span id="cb148-273"><a href="#cb148-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-274"><a href="#cb148-274" aria-hidden="true" tabindex="-1"></a><span class="fu">### Prosedur Eksploratif</span></span>
<span id="cb148-275"><a href="#cb148-275" aria-hidden="true" tabindex="-1"></a>Prosedur eksploratif yang dapat dilakukan adalah plot residual vs. fitted dan plot scale-location. Plot ini dapat dilihat dengan menggunakan fungsi plot(hasilmodel). Fungsi tersebut sebenarnya mengeluarkan berbagai jenis plot, seperti plot kuantil-kuantil dari residual (yang akan berguna saat melihat normalitas dari residual). Implementasi plotting tersebut di R adalah:</span>
<span id="cb148-276"><a href="#cb148-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-279"><a href="#cb148-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-280"><a href="#cb148-280" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="co">#layout: mfrow= 1 baris, 2 kolom</span></span>
<span id="cb148-281"><a href="#cb148-281" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aovRAKL, <span class="at">which=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)) <span class="co">#plot 1 (residual-fitted) dan 3 (scale-location)</span></span>
<span id="cb148-282"><a href="#cb148-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-283"><a href="#cb148-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-284"><a href="#cb148-284" aria-hidden="true" tabindex="-1"></a>Perlu dilihat dua hal dari plot residual vs fited. Pertama, garis merah di plot tersebut seharusnya lurus di nol. Kedua, titik-titik di plot tersebut menyebar seragam, tidak membentuk pola tertentu. Terlihat bahwa garis merah melengkung di kedua ujung plot residual vs. fitted Selain itu, titik-titik tampak membentuk pola corong terbalik. Hal tersebut dapat terlihat dari data yang sengaja dibuat memiliki ragam tak homogen. Demonstrasi ini diadaptasi dari <span class="co">[</span><span class="ot">Hanck *et al.* (2016)</span><span class="co">](https://www.econometrics-with-r.org/5-4-hah.html)</span>.</span>
<span id="cb148-285"><a href="#cb148-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-288"><a href="#cb148-288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-289"><a href="#cb148-289" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>) </span>
<span id="cb148-290"><a href="#cb148-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-291"><a href="#cb148-291" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>)) <span class="co">#vektor x dari 1-100</span></span>
<span id="cb148-292"><a href="#cb148-292" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb148-293"><a href="#cb148-293" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">40</span>)</span>
<span id="cb148-294"><a href="#cb148-294" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">26</span><span class="sc">:</span><span class="dv">50</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">30</span>)</span>
<span id="cb148-295"><a href="#cb148-295" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">51</span><span class="sc">:</span><span class="dv">75</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb148-296"><a href="#cb148-296" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">76</span><span class="sc">:</span><span class="dv">100</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb148-297"><a href="#cb148-297" aria-hidden="true" tabindex="-1"></a><span class="co"># vektor galat, saat x kecil, ragam galat dibuat besar</span></span>
<span id="cb148-298"><a href="#cb148-298" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">720</span> <span class="sc">+</span> <span class="fl">3.3</span> <span class="sc">*</span> x <span class="sc">+</span> e</span>
<span id="cb148-299"><a href="#cb148-299" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb148-300"><a href="#cb148-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-301"><a href="#cb148-301" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod,<span class="at">which=</span><span class="dv">1</span>) <span class="co">#plot model</span></span>
<span id="cb148-302"><a href="#cb148-302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-303"><a href="#cb148-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-304"><a href="#cb148-304" aria-hidden="true" tabindex="-1"></a>Selain itu, heteroskedastisitas juga terlihat di plot scale-location. Seharusnya garis merah di plot scale-location lurus dan titik-titik terdistribusi homogen. Walaupun ada dua amatan yang tak sesuai dengan pola tersebut, terlihat bahwa ada pola menurun di plot tersebut saat x membesar. Jika kembali ke contoh data dengan ragam tak sama sebelumnya:</span>
<span id="cb148-305"><a href="#cb148-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-308"><a href="#cb148-308" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-309"><a href="#cb148-309" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod,<span class="at">which=</span><span class="dv">3</span>)</span>
<span id="cb148-310"><a href="#cb148-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-311"><a href="#cb148-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-312"><a href="#cb148-312" aria-hidden="true" tabindex="-1"></a>Pola menurun tersebut juga terlihat. Plot terakhir yang dapat digunakan untuk mendiagnosis ragam tak seragam adalah plot residual vs level faktor:</span>
<span id="cb148-313"><a href="#cb148-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-316"><a href="#cb148-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-317"><a href="#cb148-317" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aovRAKL,<span class="at">which=</span><span class="dv">5</span>) <span class="co">#plot ke-5</span></span>
<span id="cb148-318"><a href="#cb148-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-319"><a href="#cb148-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-320"><a href="#cb148-320" aria-hidden="true" tabindex="-1"></a>Plot ini menunjukkan sebaran residual per kelompok, sedangkan sebaran residual per perlakuan dapat dilihat di:</span>
<span id="cb148-321"><a href="#cb148-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-324"><a href="#cb148-324" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-325"><a href="#cb148-325" aria-hidden="true" tabindex="-1"></a>aovRAKL2<span class="ot">&lt;-</span><span class="fu">aov</span>(Produksi<span class="sc">~</span>Perlakuan<span class="sc">+</span>Kelompok,<span class="at">data=</span>DataRAKL) <span class="co">#ubah urutan anova. peubah pertama setelah y~ akan menjadi level faktor di plot ini</span></span>
<span id="cb148-326"><a href="#cb148-326" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aovRAKL2,<span class="at">which=</span><span class="dv">5</span>)</span>
<span id="cb148-327"><a href="#cb148-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-328"><a href="#cb148-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-329"><a href="#cb148-329" aria-hidden="true" tabindex="-1"></a>Ketidakhomogenan ragam tidak terlihat di kedua plot ini.</span>
<span id="cb148-330"><a href="#cb148-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-331"><a href="#cb148-331" aria-hidden="true" tabindex="-1"></a>Buat plot residual vs fitted terlebih dahulu. Pertama, buat data frame dengan nilai-nilai yang diinginkan:</span>
<span id="cb148-332"><a href="#cb148-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-335"><a href="#cb148-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-336"><a href="#cb148-336" aria-hidden="true" tabindex="-1"></a>temp_data <span class="op">=</span> pd.DataFrame(<span class="bu">dict</span>(fitted_values<span class="op">=</span>RAKL_lm.fittedvalues, residual<span class="op">=</span>RAKL_lm.resid))</span>
<span id="cb148-337"><a href="#cb148-337" aria-hidden="true" tabindex="-1"></a><span class="co">#ambil fitted values dan residual dengan hasilANOVA.fittedvalues/resid</span></span>
<span id="cb148-338"><a href="#cb148-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-339"><a href="#cb148-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-340"><a href="#cb148-340" aria-hidden="true" tabindex="-1"></a>Buat plot dari data tersebut. Buat argumen lowess=True agar garis merah terlihat seperti di R:</span>
<span id="cb148-341"><a href="#cb148-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-344"><a href="#cb148-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-345"><a href="#cb148-345" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> sns.lmplot(x<span class="op">=</span><span class="st">'fitted_values'</span>, y<span class="op">=</span><span class="st">'residual'</span>, data<span class="op">=</span>temp_data, lowess<span class="op">=</span><span class="va">True</span>, line_kws<span class="op">=</span>{<span class="st">'color'</span>:<span class="st">'red'</span>}) <span class="co">#lowess=garis, line_kws=setting garis lowess, dalam kasus ini warna</span></span>
<span id="cb148-346"><a href="#cb148-346" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb148-347"><a href="#cb148-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-348"><a href="#cb148-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-349"><a href="#cb148-349" aria-hidden="true" tabindex="-1"></a>Pola corong terbalik juga terlihat di plot ini. Lalu, untuk membuat plot scale-location di python, ambil *studentized residual* dari model terebut dulu:</span>
<span id="cb148-350"><a href="#cb148-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-353"><a href="#cb148-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-354"><a href="#cb148-354" aria-hidden="true" tabindex="-1"></a>sqrt_std_residual <span class="op">=</span> np.sqrt(np.<span class="bu">abs</span>(RAKL_lm.get_influence().resid_studentized_internal))</span>
<span id="cb148-355"><a href="#cb148-355" aria-hidden="true" tabindex="-1"></a><span class="co">#hasil_model.get_influence().resid_studendized_interal: ambil studentized residual</span></span>
<span id="cb148-356"><a href="#cb148-356" aria-hidden="true" tabindex="-1"></a><span class="co">#np.sqrt: akar</span></span>
<span id="cb148-357"><a href="#cb148-357" aria-hidden="true" tabindex="-1"></a>temp_data_scaleloc <span class="op">=</span> pd.DataFrame(<span class="bu">dict</span>(fitted_values<span class="op">=</span>RAKL_lm.fittedvalues,</span>
<span id="cb148-358"><a href="#cb148-358" aria-hidden="true" tabindex="-1"></a>                              sqrt_std_residual<span class="op">=</span>sqrt_std_residual)) <span class="co">#masukkan dataFrame</span></span>
<span id="cb148-359"><a href="#cb148-359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-360"><a href="#cb148-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-361"><a href="#cb148-361" aria-hidden="true" tabindex="-1"></a>Lalu, plot-kan:</span>
<span id="cb148-362"><a href="#cb148-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-365"><a href="#cb148-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-366"><a href="#cb148-366" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> sns.lmplot(x<span class="op">=</span><span class="st">'fitted_values'</span>, y<span class="op">=</span><span class="st">'sqrt_std_residual'</span>, data<span class="op">=</span>temp_data_scaleloc, lowess<span class="op">=</span><span class="va">True</span>, line_kws<span class="op">=</span>{<span class="st">'color'</span>:<span class="st">'red'</span>})</span>
<span id="cb148-367"><a href="#cb148-367" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb148-368"><a href="#cb148-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-369"><a href="#cb148-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-370"><a href="#cb148-370" aria-hidden="true" tabindex="-1"></a>Pola menurun terlihat juga di plot ini.</span>
<span id="cb148-371"><a href="#cb148-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-372"><a href="#cb148-372" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uji formal untuk kehomogenan ragam</span></span>
<span id="cb148-373"><a href="#cb148-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-374"><a href="#cb148-374" aria-hidden="true" tabindex="-1"></a>Khalayak yang berbeda dapat memberikan tafsiran berbeda untuk tiap plot, khususnya jika ketidakhomogenan ragam tidak seekstrim di contoh sebelumnya. Pola-pola tertentu belum tentu terlihat, khususnya jika audiens kurang teliti. Oleh karena itu, perlu uji formal untuk kehomogenan ragam. Semua uji yang akan diperlihatkan memiliki hipotesis:</span>
<span id="cb148-375"><a href="#cb148-375" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-376"><a href="#cb148-376" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb148-377"><a href="#cb148-377" aria-hidden="true" tabindex="-1"></a>H_{0}&amp;:\sigma_{1}^2=\sigma_{2}^2=...=\sigma_{t}^2=\sigma^2 \text{ (ragam homogen)}<span class="sc">\\</span></span>
<span id="cb148-378"><a href="#cb148-378" aria-hidden="true" tabindex="-1"></a>H_{1}&amp;:\text{ Setidaknya satu }\sigma_{i}^2\neq\sigma^2 \text{ (ragam tak homogen)}</span>
<span id="cb148-379"><a href="#cb148-379" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb148-380"><a href="#cb148-380" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-381"><a href="#cb148-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-382"><a href="#cb148-382" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Uji yang didasari asumsi normalitas: Bartlett dan Hartley</span></span>
<span id="cb148-383"><a href="#cb148-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-384"><a href="#cb148-384" aria-hidden="true" tabindex="-1"></a>Uji Bartlett memiliki statistik uji:</span>
<span id="cb148-385"><a href="#cb148-385" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-386"><a href="#cb148-386" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb148-387"><a href="#cb148-387" aria-hidden="true" tabindex="-1"></a>\chi_{0}^2&amp;=2.3026\frac{q}{c}<span class="sc">\\</span></span>
<span id="cb148-388"><a href="#cb148-388" aria-hidden="true" tabindex="-1"></a>q&amp;=(N-t)\log_{10}S^2_p-\sum_{i=1}^t (r_{i}-1)\log_{10}S_{i}^2<span class="sc">\\</span></span>
<span id="cb148-389"><a href="#cb148-389" aria-hidden="true" tabindex="-1"></a>c&amp;=1+\frac{1}{3(t-1)}\left<span class="co">[</span><span class="ot">\sum_{i=1}^t (n_{i}-1)^{-1}-(N-a)^{-1}\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb148-390"><a href="#cb148-390" aria-hidden="true" tabindex="-1"></a>S_{p}^2&amp;=\frac{\sum_{i=1}^t(r_{i}-1)S_{i}^2}{N-t}</span>
<span id="cb148-391"><a href="#cb148-391" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb148-392"><a href="#cb148-392" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-393"><a href="#cb148-393" aria-hidden="true" tabindex="-1"></a>Dengan $S_{i}^2$ adalah ragam sampel perlakuan atau kelompok ke-i, N jumlah total unit percobaan. Arti dari rumus tersebut adalah upaya membandingkan penduga ragam jika homogen $S_{p}^2$ dengan jumlah ragam sebenarnya. Jika ragam homogen, statistik q akan mendekati nol. Jika heterogen, statistik q akan besar sehingga $H_{0}$ akan ditolak jika $\chi_{0}^2&gt;\chi_{\alpha;t-1}^2$</span>
<span id="cb148-394"><a href="#cb148-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-395"><a href="#cb148-395" aria-hidden="true" tabindex="-1"></a>Sedangkan uji Hartley memiliki statistik uji:</span>
<span id="cb148-396"><a href="#cb148-396" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-397"><a href="#cb148-397" aria-hidden="true" tabindex="-1"></a>F_{max}=\frac{max_{i}<span class="co">[</span><span class="ot">S_{i}^2</span><span class="co">]</span>}{min_{i}<span class="co">[</span><span class="ot">S_{i}^2</span><span class="co">]</span>}</span>
<span id="cb148-398"><a href="#cb148-398" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-399"><a href="#cb148-399" aria-hidden="true" tabindex="-1"></a>Atau rasio antara ragam maksimum dan ragam minimum. Uji ini mengharuskan jumlah ulangan sama. Penduga ragam menyebar chi-kuadrat jika peubah acak tersebut menyebar normal^<span class="co">[</span><span class="ot">Dapat dilihat di buku Teori Statistika seperti Ramachandran dan Tsokos</span><span class="co">]</span>. Jika jumlah ulangan sama di suatu perlakuan atau kelompok, maka derajat bebas tiap penduga ragam sama. Pembagian dua peubah chi-kuadrat dengan derajat bebasnya menghasilkan peubah yang menyebar F. Karena jumlah ulangan sama, angka tersebut saling terbagi.</span>
<span id="cb148-400"><a href="#cb148-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-401"><a href="#cb148-401" aria-hidden="true" tabindex="-1"></a>Jika ada beberapa perlakuan yang digunakan, atau beberapa kelompok, dapat dilakukan uji untuk tiap perlakuan tersebut. Implementasi uji tersebut di R sebagai berikut:</span>
<span id="cb148-402"><a href="#cb148-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-405"><a href="#cb148-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-406"><a href="#cb148-406" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(Produksi <span class="sc">~</span> Perlakuan, <span class="at">data =</span> DataRAKL) <span class="co">#uji kehomogenan ragam di tiap perlakuan</span></span>
<span id="cb148-407"><a href="#cb148-407" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(Produksi <span class="sc">~</span> Kelompok, <span class="at">data =</span> DataRAKL) <span class="co">#uji kehomogenan ragam di tiap kelompok</span></span>
<span id="cb148-408"><a href="#cb148-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-409"><a href="#cb148-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-410"><a href="#cb148-410" aria-hidden="true" tabindex="-1"></a>Sedangkan uji Hartley:</span>
<span id="cb148-411"><a href="#cb148-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-414"><a href="#cb148-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-415"><a href="#cb148-415" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PMCMRplus)</span>
<span id="cb148-416"><a href="#cb148-416" aria-hidden="true" tabindex="-1"></a><span class="fu">hartleyTest</span>(Produksi<span class="sc">~</span>Perlakuan,<span class="at">data=</span>DataRAKL)</span>
<span id="cb148-417"><a href="#cb148-417" aria-hidden="true" tabindex="-1"></a><span class="fu">hartleyTest</span>(Produksi<span class="sc">~</span>Kelompok,<span class="at">data=</span>DataRAKL)</span>
<span id="cb148-418"><a href="#cb148-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-419"><a href="#cb148-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-420"><a href="#cb148-420" aria-hidden="true" tabindex="-1"></a>Kedua uji tersebut tidak menolak $H_{0}$ di $\alpha=5\%$. Oleh karena itu, kesimpulan dari dua uji tersebut adalah bahwa ragam homogen. Implementasi uji Bartlett di python menggunakan scipy sebagai berikut:</span>
<span id="cb148-421"><a href="#cb148-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-424"><a href="#cb148-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-425"><a href="#cb148-425" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> bartlett</span>
<span id="cb148-426"><a href="#cb148-426" aria-hidden="true" tabindex="-1"></a>kel1 <span class="op">=</span> RAKLpy.query(<span class="st">'Kelompok == 1'</span>)[<span class="st">'Produksi'</span>] <span class="co">#ambil nilai peubah respon di tiap kelompok</span></span>
<span id="cb148-427"><a href="#cb148-427" aria-hidden="true" tabindex="-1"></a>kel2 <span class="op">=</span> RAKLpy.query(<span class="st">'Kelompok == 2'</span>)[<span class="st">'Produksi'</span>] <span class="co">#sintaks: dataframe.query('kondisi')['peubah']</span></span>
<span id="cb148-428"><a href="#cb148-428" aria-hidden="true" tabindex="-1"></a>kel3 <span class="op">=</span> RAKLpy.query(<span class="st">'Kelompok == 3'</span>)[<span class="st">'Produksi'</span>]</span>
<span id="cb148-429"><a href="#cb148-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-430"><a href="#cb148-430" aria-hidden="true" tabindex="-1"></a>stat, p <span class="op">=</span> bartlett(kel1, kel2, kel3) <span class="co">#lakukan uji</span></span>
<span id="cb148-431"><a href="#cb148-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-432"><a href="#cb148-432" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Statistik uji:"</span>, stat, <span class="st">"| P-value:"</span>, p) <span class="co">#print hasil uji</span></span>
<span id="cb148-433"><a href="#cb148-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-434"><a href="#cb148-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-435"><a href="#cb148-435" aria-hidden="true" tabindex="-1"></a>Implementasi ini cukup membosankan karena harus mengambil data tiap kelompok secara manual. Implementasi menggunakan pingouin tidak memerlukan hal tersebut. Implementasi ini lebih baik jika ada banyak kelompok. Misal, ada tujuh perlakuan berbeda. Pengambilan data untuk tiap perlakuan akan membosankan. Karena itu, gunakan pingouin:</span>
<span id="cb148-436"><a href="#cb148-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-439"><a href="#cb148-439" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-440"><a href="#cb148-440" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pingouin <span class="im">as</span> pg</span>
<span id="cb148-441"><a href="#cb148-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-442"><a href="#cb148-442" aria-hidden="true" tabindex="-1"></a>pg.homoscedasticity(RAKLpy, dv<span class="op">=</span><span class="st">'Produksi'</span>, </span>
<span id="cb148-443"><a href="#cb148-443" aria-hidden="true" tabindex="-1"></a>                    group<span class="op">=</span><span class="st">'Perlakuan'</span>,</span>
<span id="cb148-444"><a href="#cb148-444" aria-hidden="true" tabindex="-1"></a>                   method<span class="op">=</span><span class="st">'bartlett'</span>) <span class="co">#(data, peubah respon (y), faktor, metode)</span></span>
<span id="cb148-445"><a href="#cb148-445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-446"><a href="#cb148-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-447"><a href="#cb148-447" aria-hidden="true" tabindex="-1"></a>Kesimpulan uji menggunakan R ataupun python sama. Ragam homogen.</span>
<span id="cb148-448"><a href="#cb148-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-449"><a href="#cb148-449" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uji Levene dan Brown-Forsythe</span></span>
<span id="cb148-450"><a href="#cb148-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-451"><a href="#cb148-451" aria-hidden="true" tabindex="-1"></a>Uji Bartlett dan Hartley bergantung pada asumsi normalitas. Jika sebaran galat tidak normal, misal menyebar Student-t atau chi-kuadrat, uji tersebut akan cenderung mengambil keputusan yang salah. Uji tersebut dapat secara empiris memiliki $\alpha$ yang lebih tinggi dari yang diinginkan dan memiliki kuasa uji lebih rendah dari alternatif yang tidak mengasumsikan normalitas.</span>
<span id="cb148-452"><a href="#cb148-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-453"><a href="#cb148-453" aria-hidden="true" tabindex="-1"></a>Alternatif uji yang tidak mengasumsikan normalitas adalah uji Levene, dengan statistik uji:</span>
<span id="cb148-454"><a href="#cb148-454" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-455"><a href="#cb148-455" aria-hidden="true" tabindex="-1"></a>W=\frac{(N-t)}{(t-1)}\frac{\sum_{i=1}^t r_{i}\left(\bar{Z}_{i.}-\bar{Z}_{..}\right)^2}{\sum_{i=1}^t\sum_{j=1}^r\left(Z_{ij}-\bar{Z}_{i.}\right)}</span>
<span id="cb148-456"><a href="#cb148-456" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-457"><a href="#cb148-457" aria-hidden="true" tabindex="-1"></a>Uji Levene menghasilkan sekeluarga uji dengan statistik uji yang mirip, hanya dibedakan oleh pilihan $Z_{ij}$. Uji Levene menggunakan rata-rata perlakuan ke-i $\bar{Y}_{i.}$, sedangkan ada juga uji yang menggunakan rata-rata terpangkas $10\%$ $\hat{Y}_{i.}$. Uji Brown-Forsythe menggunakan median $\bar{Y}_{i.}^{'}$. Jika disimpulkan:</span>
<span id="cb148-458"><a href="#cb148-458" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-459"><a href="#cb148-459" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb148-460"><a href="#cb148-460" aria-hidden="true" tabindex="-1"></a>\text{Levene }&amp;: Z_{ij}=|y_{ij}-\bar{y}_{i.}| &amp; \text{ (Mean)}<span class="sc">\\</span></span>
<span id="cb148-461"><a href="#cb148-461" aria-hidden="true" tabindex="-1"></a>\text{Levene (trimmed) }&amp;: Z_{ij}=|y_{ij}-\hat{y}_{i.}| &amp; \text{ (Mean terpangkas)}<span class="sc">\\</span></span>
<span id="cb148-462"><a href="#cb148-462" aria-hidden="true" tabindex="-1"></a>\text{Brown-Forsythe }&amp;: Z_{ij}=|y_{ij}-\bar{y}_{i.}^{'}| &amp; \text{ (Median)}<span class="sc">\\</span></span>
<span id="cb148-463"><a href="#cb148-463" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb148-464"><a href="#cb148-464" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-465"><a href="#cb148-465" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Brown dan Forsythe (1974)</span><span class="co">](https://www.tandfonline.com/doi/abs/10.1080/01621459.1974.10482955)</span> membandingkan kuasa uji dan $\alpha$ empiris beberapa uji homogenitas ragam di berbagai situasi dengan simulasi. Keluarga uji Levene memiliki kuasa uji lebih rendah jika data berdistribusi normal, tetapi di distribusi Student-t dan chi-kuadrat kuasa uji Levene lebih tinggi. Uji Levene tidak kekar pada data dengan penjuluran ekstrim karena memiliki tingkat kesalahan jenis I (tolak $H_{0}$ jika $H_{0}$ benar) lebih tinggi secara empiris daripada yang dispesifikasi peneliti. Uji Brown-Forsythe sangat konservatif, bahkan dengan tingkat kesalahan jenis I ($\alpha$) empiris lebih rendah dari yang dispesifikasi. Uji Levene dengan mean terpangkas memiliki $\alpha$ empiris paling dekat dengan yang diinginkan. Penemuan ini direplikasi di penelitian lainnya dan disimpulkan di <span class="co">[</span><span class="ot">Conover *et al.* (2018)</span><span class="co">](https://www.tandfonline.com/doi/abs/10.1080/00949655.2018.1438437?journalCode=gscs20)</span>.</span>
<span id="cb148-466"><a href="#cb148-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-467"><a href="#cb148-467" aria-hidden="true" tabindex="-1"></a>Oleh karena itu, dalam menentukan uji paling tepat untuk kehomogenan ragam, perlu diteliti sebaran dari sisaan. Jika sebaran normal, uji Bartlett ataupun Hartley paling baik. Jika sebaran tidak normal tetapi tidak menjulur ekstrim, uji Levene memilik kuasa uji paling tinggi daripada uji lainnya. Jika sebaran menjulur ekstrim, uji Levene dengan mean terpangkas atau uji Brown-Forsythe paling kekar.</span>
<span id="cb148-468"><a href="#cb148-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-469"><a href="#cb148-469" aria-hidden="true" tabindex="-1"></a>Implementasi uji tersebut di R adalah sebagai berikut:</span>
<span id="cb148-470"><a href="#cb148-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-473"><a href="#cb148-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-474"><a href="#cb148-474" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb148-475"><a href="#cb148-475" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Produksi<span class="sc">~</span>Perlakuan, <span class="at">data=</span>DataRAKL, <span class="at">center =</span> median) <span class="co">#default (Brown Forsythe)</span></span>
<span id="cb148-476"><a href="#cb148-476" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Produksi<span class="sc">~</span>Kelompok, <span class="at">data=</span>DataRAKL, <span class="at">center =</span> mean) <span class="co"># Levene (mean)</span></span>
<span id="cb148-477"><a href="#cb148-477" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Produksi<span class="sc">~</span>Perlakuan, <span class="at">data=</span>DataRAKL, <span class="at">center =</span> mean,<span class="at">trim=</span><span class="fl">0.1</span>) <span class="co"># Levene (trimmed)</span></span>
<span id="cb148-478"><a href="#cb148-478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-479"><a href="#cb148-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-480"><a href="#cb148-480" aria-hidden="true" tabindex="-1"></a>Karena p-value lebih dari $\alpha=5\%$, ragam dapat dianggap homogen untuk kelompok dan perlakuan di taraf tersebut. Sedangkan implementasi uji tersebut di Python:</span>
<span id="cb148-481"><a href="#cb148-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-484"><a href="#cb148-484" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-485"><a href="#cb148-485" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> levene</span>
<span id="cb148-486"><a href="#cb148-486" aria-hidden="true" tabindex="-1"></a>statlev, plev <span class="op">=</span> levene(kel1, kel2, kel3,center<span class="op">=</span><span class="st">"median"</span>) <span class="co">#center median</span></span>
<span id="cb148-487"><a href="#cb148-487" aria-hidden="true" tabindex="-1"></a>statlev_trim, plev_trim <span class="op">=</span> levene(kel1, kel2, kel3,center<span class="op">=</span><span class="st">"mean"</span>, proportiontocut<span class="op">=</span><span class="fl">0.1</span>) <span class="co">#center mean, proportion to cut= 10 persen dipangkas</span></span>
<span id="cb148-488"><a href="#cb148-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-489"><a href="#cb148-489" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Statistik uji (Brown-Forsythe):"</span>, statlev, <span class="st">"| P-value:"</span>, plev) <span class="co">#print hasil uji</span></span>
<span id="cb148-490"><a href="#cb148-490" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Statistik uji (Trim):"</span>, statlev_trim, <span class="st">"| P-value:"</span>, plev_trim) <span class="co">#print hasil uji</span></span>
<span id="cb148-491"><a href="#cb148-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-492"><a href="#cb148-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-493"><a href="#cb148-493" aria-hidden="true" tabindex="-1"></a>Kode python untuk uji ini lebih pendek karena vektor hasil per kelompok sudah diambil sebelumnya untuk uji Bartlett. Jika menggunakan pingouin:</span>
<span id="cb148-494"><a href="#cb148-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-497"><a href="#cb148-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-498"><a href="#cb148-498" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pingouin <span class="im">as</span> pg</span>
<span id="cb148-499"><a href="#cb148-499" aria-hidden="true" tabindex="-1"></a>pg.homoscedasticity(RAKLpy, dv<span class="op">=</span><span class="st">'Produksi'</span>, </span>
<span id="cb148-500"><a href="#cb148-500" aria-hidden="true" tabindex="-1"></a>                    group<span class="op">=</span><span class="st">'Perlakuan'</span>,</span>
<span id="cb148-501"><a href="#cb148-501" aria-hidden="true" tabindex="-1"></a>                   method<span class="op">=</span><span class="st">'levene'</span>) <span class="co">#(data, peubah respon (y), faktor, metode)</span></span>
<span id="cb148-502"><a href="#cb148-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-503"><a href="#cb148-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-504"><a href="#cb148-504" aria-hidden="true" tabindex="-1"></a>Sayangnya, hanya dapat dilakukan uji Brown-Forsythe (atau, uji Levene menggunakan median). Walaupun implementasi pingouin lebih sederhana, metode ini kurang fleksibel.</span>
<span id="cb148-505"><a href="#cb148-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-506"><a href="#cb148-506" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot vs. uji</span></span>
<span id="cb148-507"><a href="#cb148-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-508"><a href="#cb148-508" aria-hidden="true" tabindex="-1"></a>Terlihat bahwa hasil uji formal menyimpulkan bahwa ragam sama, sedangkan plot residual vs. fitted dan scale-location menunjukkan pola heteroskedastis. Mungkin, amatan 6 dan 14 berpengaruh. Coba hilangkan amatan tersebut:</span>
<span id="cb148-509"><a href="#cb148-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-512"><a href="#cb148-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-513"><a href="#cb148-513" aria-hidden="true" tabindex="-1"></a>DataRAKL_tanpaoutlier<span class="ot">&lt;-</span>DataRAKL[<span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">14</span>),]</span>
<span id="cb148-514"><a href="#cb148-514" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(Produksi <span class="sc">~</span> Perlakuan, <span class="at">data =</span> DataRAKL_tanpaoutlier) <span class="co">#uji kehomogenan ragam di tiap perlakuan</span></span>
<span id="cb148-515"><a href="#cb148-515" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(Produksi <span class="sc">~</span> Kelompok, <span class="at">data =</span> DataRAKL_tanpaoutlier) <span class="co">#uji kehomogenan ragam di tiap kelompok</span></span>
<span id="cb148-516"><a href="#cb148-516" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Produksi <span class="sc">~</span> Perlakuan, <span class="at">data =</span> DataRAKL_tanpaoutlier) <span class="co">#uji kehomogenan ragam di tiap perlakuan</span></span>
<span id="cb148-517"><a href="#cb148-517" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Produksi <span class="sc">~</span> Kelompok, <span class="at">data =</span> DataRAKL_tanpaoutlier) <span class="co">#uji kehomogenan ragam di tiap kelompok</span></span>
<span id="cb148-518"><a href="#cb148-518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-519"><a href="#cb148-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-520"><a href="#cb148-520" aria-hidden="true" tabindex="-1"></a>Uji formal masih menandakan ragam sama. Lalu, bagaimana cara hasil plot residual vs fitted dijelaskan?</span>
<span id="cb148-521"><a href="#cb148-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-522"><a href="#cb148-522" aria-hidden="true" tabindex="-1"></a>Pertama, plot residual per kelompok dan perlakuan relatif sama. Karena uji hanya dapat dilakukan kepada kelompok atau perlakuan, bukan kombinasinya, hasil ini sesuai dengan plot tersebut. Kedua, pola tersebut mungkin muncul karena observasi sedikit di fitted values yang besar sehingga terlihat berpola padahal tidak. Ketiga, pola tersebut mungkin muncul karena interaksi antara kelompok dan perlakuan yang menurut uji Tukey ada. Oleh karena itu, uji yang terpisah di perlakuan atau kelompok tidak dapat mendeteksi hal tersebut, tapi uji yang melihat kombinasi residual dapat mendeteksi hal tersbut. Mungkin dapat dibandingkan dengan uji Bresuch-Pagan (yang menjadi uji standar heteroskedastisitas di regresi):</span>
<span id="cb148-523"><a href="#cb148-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-526"><a href="#cb148-526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-527"><a href="#cb148-527" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb148-528"><a href="#cb148-528" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(Produksi<span class="sc">~</span>Perlakuan<span class="sc">+</span>Kelompok,<span class="at">data=</span>DataRAKL)</span>
<span id="cb148-529"><a href="#cb148-529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-530"><a href="#cb148-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-531"><a href="#cb148-531" aria-hidden="true" tabindex="-1"></a>Walaupun masih taktolak $H_{0}$, hasil uji Breusch-Pagan memiliki p-value lebih rendah dari uji lain. Oleh karena itu, aman untuk mengasumsikan ragam homogen di kasus ini. Selain itu karena jumlah ulangan sama, heterogenitas ragam tak berpengaruh besar, sesuai diskusi sebelumnya.</span>
<span id="cb148-532"><a href="#cb148-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-533"><a href="#cb148-533" aria-hidden="true" tabindex="-1"></a><span class="fu">## Galat percobaan saling bebas</span></span>
<span id="cb148-534"><a href="#cb148-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-535"><a href="#cb148-535" aria-hidden="true" tabindex="-1"></a>Kebebasan galat merupakan asumsi yang paling penting dari ANOVA dan juga yang paling sulit diatasi ketika asumsi tersebut tidak terpenuhi. Asumsi ragam galat konstan merupakan asumsi yang terpenting kedua untuk dipenuhi setelah asumsi kebebasan galat. Akibat dari ragam galat yang tidak konstan akan mempengaruhi kesimpulan yang kita peroleh. Namun, ragam galat yang tidak konstan dapat diatasi pada banyak situasi, misal menggunakan transformasi.  </span>
<span id="cb148-536"><a href="#cb148-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-537"><a href="#cb148-537" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-538"><a href="#cb148-538" aria-hidden="true" tabindex="-1"></a>y_{ij} = \mu+\tau_{i}+\varepsilon_{ij}</span>
<span id="cb148-539"><a href="#cb148-539" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-540"><a href="#cb148-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-541"><a href="#cb148-541" aria-hidden="true" tabindex="-1"></a>Pada model linier yang kita gunakan pada persamaan di atas, asumsi kenormalan menjadi tidak begitu penting untuk dipenuhi, terutama jika ukuran contoh yang diperoleh besar dan Teorema Limit Pusat dapat dipakai. Namun terdapat model-model tertentu yang sangat bergantung pada normalitas (Nur Hilal A. Syahrir, Statistika Terapan IPB).</span>
<span id="cb148-542"><a href="#cb148-542" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb148-543"><a href="#cb148-543" aria-hidden="true" tabindex="-1"></a>Autokorelasi muncul ketika hasil pada amatan yang berdekatan cenderung terlalu mirip (korelasi positif) atau terlalu berbeda (korelasi negatif). Autokorelasi seringkali menjadi penyebab ketidakbebasan pada galat. Alasan amatan tidak saling bebas adalah:</span>
<span id="cb148-544"><a href="#cb148-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-545"><a href="#cb148-545" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Pengukuran berulang dilakukan ke subjek yang sama</span>
<span id="cb148-546"><a href="#cb148-546" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Amatan berkorelasi dalam waktu</span>
<span id="cb148-547"><a href="#cb148-547" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Amatan berkorelasi dalam tempat</span>
<span id="cb148-548"><a href="#cb148-548" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Pengaturan sistematis dari unit percobaan</span>
<span id="cb148-549"><a href="#cb148-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-550"><a href="#cb148-550" aria-hidden="true" tabindex="-1"></a>Contoh pengukuran berulang dan amatan yang berkorelasi dalam waktu adalah jika tiga pohon dengan varietas berbeda diamati tingginya. Misal, tiga pohon tersebut diamati tingginya setelah satu, dua, dan tiga tahun. Jika amatan di varietas ke-i di tahun ke-j menjadi baris di data, amatan-amatan tersebut akan tidak bebas, melainkan berkorelasi dengan waktu. Oleh karena itu, amtatan tiap tahun harus dibuat kolom sendiri agar tiap baris (pohon) saling bebas. Namun, jika hanya diamati satu pohon untuk tiap varietas, tidak akan ada derajat bebas bagi ANOVA. Kasus ini menunjukkan salah satu kendala yang muncul saat penanganan amatan tak bebas.</span>
<span id="cb148-551"><a href="#cb148-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-552"><a href="#cb148-552" aria-hidden="true" tabindex="-1"></a>Jika peneliti tersebut menyadari dari awal bahwa amatan suatu pohon di tahun berbeda tidak saling bebas, seharusnya peneliti menyiapkan beberapa pohon dari satu varietas. Jika ada pengaturan tersebut, derajat bebas cukup untuk melakukan ANOVA.</span>
<span id="cb148-553"><a href="#cb148-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-554"><a href="#cb148-554" aria-hidden="true" tabindex="-1"></a>Contoh dari amatan yang berkorelasi dalam tempat adalah perlakuan A yang ditaruh di lereng suatu bukit dan perlakuan lainnya ditaruh di puncak bukit. Oleh karena berada di tempat geografis yang sama, amatan perlakuan A tidak saling bebas satu sama lain. </span>
<span id="cb148-555"><a href="#cb148-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-556"><a href="#cb148-556" aria-hidden="true" tabindex="-1"></a>Pengaturan sistematis muncul ketika pengacakan tidak dilakukan dengan benar. Akan muncul pola dari urutan unit percobaan.</span>
<span id="cb148-557"><a href="#cb148-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-558"><a href="#cb148-558" aria-hidden="true" tabindex="-1"></a>Sebelum melakukan eksplorasi ataupun uji, pastikan **urutan dari amatan masuk akal**. Dalam studi kasus ini, dianggap urutan amatan dari DataRAKL sesuai dengan suatu urutan waktu. Misal, baris 1 diamati sebelum baris 2, dan seterusnya. Jika **urutan tidak memiliki arti**, maka data dapat dengan mudah diubah urutannya agar tidak berkorelasi satu sama lain, seperti di <span class="co">[</span><span class="ot">contoh ini</span><span class="co">]</span> (https://stats.stackexchange.com/questions/326305/i-ran-the-durbinwatsontest-in-r-and-got-p-value-0-for-non-time-series-data-is).</span>
<span id="cb148-559"><a href="#cb148-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-560"><a href="#cb148-560" aria-hidden="true" tabindex="-1"></a><span class="fu">### Prosedur Eksploratif</span></span>
<span id="cb148-561"><a href="#cb148-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-562"><a href="#cb148-562" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Plot residual vs order</span></span>
<span id="cb148-563"><a href="#cb148-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-564"><a href="#cb148-564" aria-hidden="true" tabindex="-1"></a>Memeriksa adanya autokorelasi secara eksploratif dilakukan dengan melihat plot antara sisaan dengan urutan waktu (*plot of residuals in time sequence*). Akan diteliti tren dari plot tersebut - menyebar secara acak atau tidak berpola apapun. Dapat juga melihat pola *plot of residual versus order*, khususnya apakah plot tersebut stasioner. Implementasi plotting tersebut di R adalah:</span>
<span id="cb148-565"><a href="#cb148-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-568"><a href="#cb148-568" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-569"><a href="#cb148-569" aria-hidden="true" tabindex="-1"></a>resi <span class="ot">&lt;-</span> <span class="fu">residuals</span>(<span class="at">object =</span> aovRAKL) <span class="co">#ambil residual</span></span>
<span id="cb148-570"><a href="#cb148-570" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Sisaan vs Order  </span></span>
<span id="cb148-571"><a href="#cb148-571" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(resi, <span class="at">type =</span> <span class="st">'o'</span>); <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">'red'</span>)</span>
<span id="cb148-572"><a href="#cb148-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-573"><a href="#cb148-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-574"><a href="#cb148-574" aria-hidden="true" tabindex="-1"></a>Dari gambar plot sisaan vs order (plot of residual versus order) terlihat membentuk trend yang datar atau hampir datar sehingga asumsi galat percobaan saling bebas terpenuhi. Namun, titik tersebar membangun pola melebar atau menyempit (bentuk terompet) sehingga data mempunyai pola yang tidak stasioner.</span>
<span id="cb148-575"><a href="#cb148-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-576"><a href="#cb148-576" aria-hidden="true" tabindex="-1"></a><span class="fu">#### ACF dan PACF</span></span>
<span id="cb148-577"><a href="#cb148-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-578"><a href="#cb148-578" aria-hidden="true" tabindex="-1"></a>Selain plot tersebut, dapat dilihat plot autokorelasi (ACF) dan plot autokorelasi parsial (PACF). Lag adalah beda urutan suatu sisaan dengan sisaan sebelumnya. Misal, lag 2 berarti tiap sisaan dibandingkan dengan sisaan dua observasi sebelumnya. Jika garis vertikal di tiap lag lebih tinggi dari garis biru horizontal, maka dianggap terjadi autokorelasi di lag tersebut.</span>
<span id="cb148-579"><a href="#cb148-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-582"><a href="#cb148-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-583"><a href="#cb148-583" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(resi)</span>
<span id="cb148-584"><a href="#cb148-584" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-585"><a href="#cb148-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-586"><a href="#cb148-586" aria-hidden="true" tabindex="-1"></a>Plot korelasi parsial mengeluarkan pengaruh dari lag-lag lain. Aturan keputuasan dari plot tersebut sama dengan plot ACF:</span>
<span id="cb148-587"><a href="#cb148-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-590"><a href="#cb148-590" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-591"><a href="#cb148-591" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(resi)</span>
<span id="cb148-592"><a href="#cb148-592" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-593"><a href="#cb148-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-594"><a href="#cb148-594" aria-hidden="true" tabindex="-1"></a>Lag nol di plot ACF dapat diabaikan karena korelasi antara observasi dengan dirinya sendiri pasti satu. Namun, terlihat bahwa di beberapa lag bukan nol garis vertikal melewati garis horizontal sehingga dapat disimpulkan bahwa galat tidak bebas.</span>
<span id="cb148-595"><a href="#cb148-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-596"><a href="#cb148-596" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uji formal untuk galat percobaan saling bebas</span></span>
<span id="cb148-597"><a href="#cb148-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-598"><a href="#cb148-598" aria-hidden="true" tabindex="-1"></a>Uji formal untuk menentukan kebebasan galat percobaan menggunakan Runs Test (Uji Runtunan) dan Uji Durbin Watson. </span>
<span id="cb148-599"><a href="#cb148-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-600"><a href="#cb148-600" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Uji Durbin-Watson</span></span>
<span id="cb148-601"><a href="#cb148-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-602"><a href="#cb148-602" aria-hidden="true" tabindex="-1"></a>Uji formal yang sederhana yang biasa digunakan untuk mengecek autokorelasi adalah Uji Durbin Watson. Uji Durbin Watson hanya dapat menguji ketidakbebasan galat percobaan pada lag 1. Dalam uji tersebut, anggap bahwa sisaan ke-t adalah $e_{t}=\rho e_{t-1}+v_{t}$, di mana $v_{t}$ merupakan komponen sisaan yang memenuhi asumsi kebebasan dan kehomogenan. Oleh karena itu, hipotesis yang diuji adalah:</span>
<span id="cb148-603"><a href="#cb148-603" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-604"><a href="#cb148-604" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb148-605"><a href="#cb148-605" aria-hidden="true" tabindex="-1"></a>H_{0}&amp;: \rho=0<span class="sc">\\</span></span>
<span id="cb148-606"><a href="#cb148-606" aria-hidden="true" tabindex="-1"></a>H_{1}&amp;: \rho\neq0<span class="sc">\\</span></span>
<span id="cb148-607"><a href="#cb148-607" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb148-608"><a href="#cb148-608" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-609"><a href="#cb148-609" aria-hidden="true" tabindex="-1"></a>Jika $e_{k}$ adalah residual yang diurut berdasarkan urutan waktu, statistik Durbin-Watson adalah:</span>
<span id="cb148-610"><a href="#cb148-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-611"><a href="#cb148-611" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-612"><a href="#cb148-612" aria-hidden="true" tabindex="-1"></a>DW=\frac{\sum_{k=2}^n\left(e_{k}-e_{k-1}\right)^2}{\sum_{k=1}^n e_{k}}</span>
<span id="cb148-613"><a href="#cb148-613" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-614"><a href="#cb148-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-615"><a href="#cb148-615" aria-hidden="true" tabindex="-1"></a>Interpretasi yang tepat dari nilai statistik uji Durbin-Watson, jika dilakukan secara manual, cukup sulit. Sebaran tepat statistik uji Durbin Watson bergantung pada matriks peubah bebas X sehingga tidak ada satu tabel yang mengandung nilai kritis statistik Durbin Watson. Jika tidak ada autokorelasi, DW berada di sekitar 2. Autokorelasi positif akan membuat DW kurang dari 2, dan jika terdapat autokorelasi negatif maka nilai DW akan lebih besar dari 2. </span>
<span id="cb148-616"><a href="#cb148-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-617"><a href="#cb148-617" aria-hidden="true" tabindex="-1"></a>Sebagai perhitungan kasar, autokorelasi terjadi ketika DW berada di luar rentang 1,5 sampai 2,5. Nilai tersebut cukup besar dalam melihat efek yang nyata pada teknik inferensi. Perhatikan bahwa DW sendiri acak dan mungkin di luar jangkauan 1,5 sampai 2,5 bahkan jika residual tidak berkorelasi. Untuk kumpulan data dengan amatan yang panjang dari perlakuan yang sama, ragam dari DW kurang dari 4/N.</span>
<span id="cb148-618"><a href="#cb148-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-619"><a href="#cb148-619" aria-hidden="true" tabindex="-1"></a>Namun, implementasi uji Durbin-Watson di berbagai software statistika, termasuk R, dapat diinterpretasikan dengan mudah karena software tersebut dapat menghitung sebaran statistik uji Durbin Watson secara eksak. Matriks peubah bebas X dapat menjadi input software dan p-value eksak dapat dikeluarkan oleh software tersebut. Uji Durbin-Watson dapat diimplentasikan melalui package lmtest atau car. </span>
<span id="cb148-620"><a href="#cb148-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-623"><a href="#cb148-623" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-624"><a href="#cb148-624" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb148-625"><a href="#cb148-625" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb148-626"><a href="#cb148-626" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">dwtest</span>(aovRAKL,<span class="at">alternative=</span><span class="st">"two.sided"</span>, <span class="at">iter=</span><span class="dv">15</span>, <span class="at">tol=</span><span class="fl">1e-10</span>) <span class="co">#H1: rho tak sama dengan nol</span></span>
<span id="cb148-627"><a href="#cb148-627" aria-hidden="true" tabindex="-1"></a><span class="co">#iter=iterasi algoritma pan, tol=toleransi</span></span>
<span id="cb148-628"><a href="#cb148-628" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(aovRAKL,<span class="at">alternative=</span><span class="st">"greater"</span>) <span class="co">#H1: rho lebih dari nol</span></span>
<span id="cb148-629"><a href="#cb148-629" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(aovRAKL,<span class="at">alternative=</span><span class="st">"less"</span>) <span class="co">#H1: rho kurang dari nol</span></span>
<span id="cb148-630"><a href="#cb148-630" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">durbinWatsonTest</span>(aovRAKL)</span>
<span id="cb148-631"><a href="#cb148-631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-632"><a href="#cb148-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-633"><a href="#cb148-633" aria-hidden="true" tabindex="-1"></a>Lebih direkomendasikan menggunakan package lmtest karena p-value package lmtest lebih stabil. Ini terjadi karena algoritma "pan" yang digunakan package tersebut untuk mengatur p-value. Pada dasarnya, algoritma tersebut memastikan p-value konvergen (menuju ke) suatu nilai sehingga tidak berubah-ubah. Seperti dilihat di kode, toleransi telah di-set sehingga perubahan p-value dari satu iterasi ke iterasi selanjutnya lebih sedikit dari toleransi yang diinginkan. Dapat disimulasikan sebagai berikut:</span>
<span id="cb148-634"><a href="#cb148-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-637"><a href="#cb148-637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-638"><a href="#cb148-638" aria-hidden="true" tabindex="-1"></a>carRes<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb148-639"><a href="#cb148-639" aria-hidden="true" tabindex="-1"></a>lmtestRes<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb148-640"><a href="#cb148-640" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>)){</span>
<span id="cb148-641"><a href="#cb148-641" aria-hidden="true" tabindex="-1"></a>  carRes[i]<span class="ot">&lt;-</span>car<span class="sc">::</span><span class="fu">durbinWatsonTest</span>(aovRAKL)<span class="sc">$</span>p</span>
<span id="cb148-642"><a href="#cb148-642" aria-hidden="true" tabindex="-1"></a>  lmtestRes[i]<span class="ot">&lt;-</span>lmtest<span class="sc">::</span><span class="fu">dwtest</span>(aovRAKL,<span class="at">alternative=</span><span class="st">"two.sided"</span>)<span class="sc">$</span>p</span>
<span id="cb148-643"><a href="#cb148-643" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb148-644"><a href="#cb148-644" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">data.frame</span>(<span class="at">car=</span>carRes,<span class="at">lmtest=</span>lmtestRes))</span>
<span id="cb148-645"><a href="#cb148-645" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(carRes)</span>
<span id="cb148-646"><a href="#cb148-646" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-647"><a href="#cb148-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-648"><a href="#cb148-648" aria-hidden="true" tabindex="-1"></a>Seperti yang dapat dilihat, p-value dari library car sangat tidak stabil, sehingga mungkin saja keputusan uji berubah-ubah. Gunakan lmtest saja. Implementasi di python sebagai berikut:</span>
<span id="cb148-649"><a href="#cb148-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-652"><a href="#cb148-652" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-653"><a href="#cb148-653" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.stattools <span class="im">import</span> durbin_watson</span>
<span id="cb148-654"><a href="#cb148-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-655"><a href="#cb148-655" aria-hidden="true" tabindex="-1"></a><span class="co">#perform Durbin-Watson test</span></span>
<span id="cb148-656"><a href="#cb148-656" aria-hidden="true" tabindex="-1"></a>durbin_watson(RAKL_lm.resid)</span>
<span id="cb148-657"><a href="#cb148-657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-658"><a href="#cb148-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-659"><a href="#cb148-659" aria-hidden="true" tabindex="-1"></a>Implementasi dari statsmodels tidak dapat memberikan p-value. Oleh karena itu, implementasi dari dwtest, dengan sintaks mirip lmtest dapat menjadi alternatif:</span>
<span id="cb148-660"><a href="#cb148-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-663"><a href="#cb148-663" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-664"><a href="#cb148-664" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dwtest <span class="im">import</span> dwtest</span>
<span id="cb148-665"><a href="#cb148-665" aria-hidden="true" tabindex="-1"></a>dw,pval<span class="op">=</span>dwtest(formula<span class="op">=</span><span class="st">'Produksi~Perlakuan+Kelompok'</span>,data<span class="op">=</span>RAKLpy,alternative<span class="op">=</span><span class="st">"two_sided"</span>,iterations<span class="op">=</span><span class="dv">15</span>,tol<span class="op">=</span><span class="fl">1e-10</span>)</span>
<span id="cb148-666"><a href="#cb148-666" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p-value:"</span>,pval,<span class="st">"| DW:"</span>,dw)</span>
<span id="cb148-667"><a href="#cb148-667" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-668"><a href="#cb148-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-669"><a href="#cb148-669" aria-hidden="true" tabindex="-1"></a>Namun, sepertinya implementasi dwtest menghitung nilai statistik uji DW dengan kurang tepat - statistik uji tersebut sedikit berbeda dari keluaran statsmodels atau R. Dari keluaran di atas dapat dilihat bahwa pada uji Durbin Watson ini memiliki nilai p-value $&lt; \alpha = 0.05$ maka Tolak $H_{0}$, artinya cukup bukti untuk mengatakan bahwa ada autokorelasi. Oleh karena itu, karena autokorelasi seringkali menjadi penyebab ketidakbebasan pada galat maka asumsi galat percobaan saling bebas belum terpenuhi.</span>
<span id="cb148-670"><a href="#cb148-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-671"><a href="#cb148-671" aria-hidden="true" tabindex="-1"></a>Uji Durbin-Watson memiliki beberapa kelemahan:</span>
<span id="cb148-672"><a href="#cb148-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-673"><a href="#cb148-673" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Seperti yang dijelaskan sebelumnya, uji tersebut mengasumsikan autokorelasi pada lag 1 saja.</span>
<span id="cb148-674"><a href="#cb148-674" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Uji tidak dapat digunakan dalam model autoregresif (memiliki peubah tak bebas dari periode sebelumnya)</span>
<span id="cb148-675"><a href="#cb148-675" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Uji sensitif terhadap asumsi normalitas.</span>
<span id="cb148-676"><a href="#cb148-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-677"><a href="#cb148-677" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Runs test</span></span>
<span id="cb148-678"><a href="#cb148-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-679"><a href="#cb148-679" aria-hidden="true" tabindex="-1"></a>Oleh karena itu, dapat digunakan Runs test. Misal ada 15 data, maka jika nilai data naik dari nilai sebelumnya dinotasikan positif (+), dan sebaliknya dinotasikan negatif (-). Jika proses tersebut menghasilkan + + + + − − − + + + − − + + +, ada 5 run, 3 positif dan 2 negatif. Sebuah run merupakan kumpulan tanda positif atau negatif. Jumlah run tersebut menjadi statistik uji runs test, dengan implementasi di R berupa:</span>
<span id="cb148-680"><a href="#cb148-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-683"><a href="#cb148-683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-684"><a href="#cb148-684" aria-hidden="true" tabindex="-1"></a><span class="co"># Run Test</span></span>
<span id="cb148-685"><a href="#cb148-685" aria-hidden="true" tabindex="-1"></a><span class="co"># H0 (null): The data was produced in a random manner.</span></span>
<span id="cb148-686"><a href="#cb148-686" aria-hidden="true" tabindex="-1"></a><span class="co"># Ha (alternative): The data was not produced in a random manner.</span></span>
<span id="cb148-687"><a href="#cb148-687" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(snpar)</span>
<span id="cb148-688"><a href="#cb148-688" aria-hidden="true" tabindex="-1"></a><span class="fu">runs.test</span>(aovRAKL<span class="sc">$</span>residuals,<span class="at">exact=</span>T,<span class="at">alternative =</span><span class="st">"two.sided"</span>) <span class="co">#exact=p-value tepat</span></span>
<span id="cb148-689"><a href="#cb148-689" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-690"><a href="#cb148-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-691"><a href="#cb148-691" aria-hidden="true" tabindex="-1"></a>Implementasi di python dapat dilihat di <span class="co">[</span><span class="ot">sini</span><span class="co">](https://gist.github.com/kwcooper/b1ff695d6ff9dc0189d52fe9ba4dc567)</span>.</span>
<span id="cb148-692"><a href="#cb148-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-693"><a href="#cb148-693" aria-hidden="true" tabindex="-1"></a>Nilai p dari pengujian ini adalah 0.6951. Karena p-value  lebih dari taraf nyata 0.05, maka  tak tolak hipotesis nol. Hal ini menunjukkan belum cukup bukti untuk mengatakan bahwa data dihasilkan secara tidak acak.</span>
<span id="cb148-694"><a href="#cb148-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-695"><a href="#cb148-695" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Autokorelasi dengan lag lebih dari 1: Breusch-Godfrey dan modifikasi Durbin-Watson</span></span>
<span id="cb148-696"><a href="#cb148-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-697"><a href="#cb148-697" aria-hidden="true" tabindex="-1"></a>Seperti dijelaskan sebelumnya, uji Durbin Watson hanya dapat menguji autokorelasi lag 1. Namun, terlihat di plot ACF dan PACF bahwa autokorelasi muncul di lag 2 dan 4. Alternatif sederhana untuk menguji hal tersebut adalah menambah order di fungsi uji Durbin Watson car:</span>
<span id="cb148-698"><a href="#cb148-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-701"><a href="#cb148-701" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-702"><a href="#cb148-702" aria-hidden="true" tabindex="-1"></a><span class="fu">durbinWatsonTest</span>(aovRAKL,<span class="at">max.lag=</span><span class="dv">2</span>)</span>
<span id="cb148-703"><a href="#cb148-703" aria-hidden="true" tabindex="-1"></a><span class="fu">durbinWatsonTest</span>(aovRAKL,<span class="at">max.lag=</span><span class="dv">4</span>)</span>
<span id="cb148-704"><a href="#cb148-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-705"><a href="#cb148-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-706"><a href="#cb148-706" aria-hidden="true" tabindex="-1"></a>Atau, dapat digunakan uji Breusch-Godfrey. Pada dasarnya, dilakukan regresi residual dengan peubah bebas dan residual lag sebelumnya, lalu dihitung $R^2$. Secara asimptotik, $nR^2\sim\chi^2_{p}$. Implementasi uji tersebut di R:</span>
<span id="cb148-707"><a href="#cb148-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-710"><a href="#cb148-710" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-711"><a href="#cb148-711" aria-hidden="true" tabindex="-1"></a><span class="fu">bgtest</span>(aovRAKL,<span class="at">order=</span><span class="dv">1</span>)</span>
<span id="cb148-712"><a href="#cb148-712" aria-hidden="true" tabindex="-1"></a><span class="fu">bgtest</span>(aovRAKL,<span class="at">order=</span><span class="dv">2</span>)</span>
<span id="cb148-713"><a href="#cb148-713" aria-hidden="true" tabindex="-1"></a><span class="fu">bgtest</span>(aovRAKL,<span class="at">order=</span><span class="dv">4</span>)</span>
<span id="cb148-714"><a href="#cb148-714" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-715"><a href="#cb148-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-716"><a href="#cb148-716" aria-hidden="true" tabindex="-1"></a>Uji tersebut tak menolak $H_{0}$ di lag 1, tapi di lag selanjutnya uji tersebut menolak $H_{0}$. Implementasi di Python:</span>
<span id="cb148-717"><a href="#cb148-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-720"><a href="#cb148-720" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-721"><a href="#cb148-721" aria-hidden="true" tabindex="-1"></a><span class="im">from</span>  statsmodels.stats.diagnostic <span class="im">import</span> acorr_breusch_godfrey</span>
<span id="cb148-722"><a href="#cb148-722" aria-hidden="true" tabindex="-1"></a>bgstat,pbg,fstat,pf<span class="op">=</span>acorr_breusch_godfrey(RAKL_lm,nlags<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb148-723"><a href="#cb148-723" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Statistik uji:"</span>, bgstat, <span class="st">"| P-value:"</span>, pbg)</span>
<span id="cb148-724"><a href="#cb148-724" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-725"><a href="#cb148-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-726"><a href="#cb148-726" aria-hidden="true" tabindex="-1"></a>Diskusi mengenai kuasa uji autokorelasi dilakukan di <span class="co">[</span><span class="ot">Ulyanto (2020)</span><span class="co">](https://pjsor.com/pjsor/article/view/2691)</span>.</span>
<span id="cb148-727"><a href="#cb148-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-728"><a href="#cb148-728" aria-hidden="true" tabindex="-1"></a><span class="fu">### Konsekuensi dari ketidakbebasan pada galat</span></span>
<span id="cb148-729"><a href="#cb148-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-730"><a href="#cb148-730" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Ragam dari rataan contoh bukan lagi ($\frac{\sigma^2}{n}$) pada data yang tidak saling bebas</span>
<span id="cb148-731"><a href="#cb148-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-732"><a href="#cb148-732" aria-hidden="true" tabindex="-1"></a>Ketika galat tidak saling bebas tapi sebaliknya memenuhi asumsi, maka dugaan dari pengaruh perlakuan yang kita peroleh masih tak bias, dan KTG mendekati tak bias untuk menduga $\sigma^2$ ketika ukuran contah besar. Perbedaannya ialah ragam dari rataan tidak lagi $\sigma^2$ dibagi dengan ukuran sampel ($\frac{\sigma^2}{n}$). Ini berarti bahwa dugaan standar error untuk rataan perlakuan dan perbandingan perlakuan adalah dugaan yang bias, (apakah penyimpangannya terlalu besar atau kecil tergantung pada pola ketidaksalingbebasan pada galat), sehingga selang kepercayaan dan uji anova tidak akan memiliki laju kesalahan yang dibutuhkan. Uji-F pada ANOVA akan dipengaruhi oleh alasan yang sama.</span>
<span id="cb148-733"><a href="#cb148-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-734"><a href="#cb148-734" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Uji-F pada ANOVA kekar terhadap ketidakbebasan</span>
<span id="cb148-735"><a href="#cb148-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-736"><a href="#cb148-736" aria-hidden="true" tabindex="-1"></a>Uji-F pada ANOVA kekar terhadap ketidakbebasan jika dipertimbangkan sebagai uji pengacakan. Artinya bahwa rataan di semua pengacakan yang mungkin, uji-F akan menolak hipotesis nol ketika hipotesis nol benar.Masalah yang lebih berat dapat muncul ketika tidak ada pengacakan pada suluruh ketidakbebasan. Misalnya, perlakuan mungkin diterapkan untuk unit-unit pada pengacakan. Tapi ketika respon-respon peralakuan diukur, diikuti oleh semua perlakuan dua unit, dan seterusnya. Penerapan pengacakan dari perlakuan untuk unit-unit tidak akan membantu, jika terdapat korelasi yang kuat pada pengukuran galat.</span>
<span id="cb148-737"><a href="#cb148-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-738"><a href="#cb148-738" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aditivitas</span></span>
<span id="cb148-739"><a href="#cb148-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-740"><a href="#cb148-740" aria-hidden="true" tabindex="-1"></a>Rancangan-rancangan seperti RAKL dan RBSL mengasumsikan bahwa pengaruh perlakuan dan kelompok **aditif** - pengaruh tersebut tetap sama di semua kombinasi perlakuan dan kelompok. Sifat tersebut terlihat dari model linear untuk RAKL:</span>
<span id="cb148-741"><a href="#cb148-741" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-742"><a href="#cb148-742" aria-hidden="true" tabindex="-1"></a>y_{ij}=\mu+\tau_{i}+\beta_{j}+\varepsilon_{ij}</span>
<span id="cb148-743"><a href="#cb148-743" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-744"><a href="#cb148-744" aria-hidden="true" tabindex="-1"></a>Terlihat bahwa tidak ada interaksi $(\tau_{i}\beta_{j})$ antara perlakuan dan kelompok. Dalam kata lain, efek suatu kelompok dianggap sama di semua perlakuan. Jika asumsi tersebut tidak terpenuhi, dapat terlihat bahwa:</span>
<span id="cb148-745"><a href="#cb148-745" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-746"><a href="#cb148-746" aria-hidden="true" tabindex="-1"></a>v_{ij}=\lambda_{ij}+\varepsilon_{ij}=y_{ij}-\mu-\tau_{i}-\beta_{j}</span>
<span id="cb148-747"><a href="#cb148-747" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-748"><a href="#cb148-748" aria-hidden="true" tabindex="-1"></a>Akan menjadi komponen galat. Ini berarti galat akan heterogen tergantung besaran interaksi di kelompok dan perlakuan tertentu, sehingga ragam galat tidak terduga dengan benar. Oleh karena uji-F menggunakan penduga ragam galat, hasil-hasil uji dapat *misleading*. Ada beberapa cari menguji asumsi ini.</span>
<span id="cb148-749"><a href="#cb148-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-750"><a href="#cb148-750" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot Interaksi</span></span>
<span id="cb148-751"><a href="#cb148-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-752"><a href="#cb148-752" aria-hidden="true" tabindex="-1"></a>Plot interaksi sudah didiskusikan di <span class="co">[</span><span class="ot">Bab 2</span><span class="co">](#plot-interaksi)</span>. Jika garis plot interaksi sejajar, asumsi keaditifan dianggap terpenuhi. Jika plot interaksi tidak sejajar, ada bukti untuk menduga bahwa asumsi keaditifan tidak terpenuhi. Sebagai contoh, plot interaksi ini:</span>
<span id="cb148-753"><a href="#cb148-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-756"><a href="#cb148-756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-757"><a href="#cb148-757" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb148-758"><a href="#cb148-758" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DataRAKL, <span class="fu">aes</span>(<span class="at">x =</span> Perlakuan, <span class="at">y =</span> Produksi, <span class="at">colour =</span> Kelompok)) <span class="sc">+</span> </span>
<span id="cb148-759"><a href="#cb148-759" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> DataRAKL, <span class="fu">aes</span>(<span class="at">y =</span> Produksi)) <span class="sc">+</span></span>
<span id="cb148-760"><a href="#cb148-760" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> DataRAKL, <span class="fu">aes</span>(<span class="at">y =</span> Produksi, <span class="at">group =</span> Kelompok)) <span class="sc">+</span> </span>
<span id="cb148-761"><a href="#cb148-761" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb148-762"><a href="#cb148-762" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-763"><a href="#cb148-763" aria-hidden="true" tabindex="-1"></a>Menandakan bahwa mungkin ada interaksi antara perlakuan dan kelompok karena garis plot interaksi tidak sejajar.</span>
<span id="cb148-764"><a href="#cb148-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-765"><a href="#cb148-765" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uji formal</span></span>
<span id="cb148-766"><a href="#cb148-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-767"><a href="#cb148-767" aria-hidden="true" tabindex="-1"></a>Asumsi aditivitas juga dapat diuji secara formal. Ada beberapa uji aditivitas yang dapat digunakan, antara lain uji Tukey, uji Mandel, uji Johnson-Graybill, uji Tussel, dan uji LBI (*locally best invariant*). Akan diberikan sintaks untuk tiap uji tersebut. Uji Tukey dan uji Tussel akan dijelaskan secara singkat. Filosofi inti dari uji Tukey mirip dengan uji Mandel, sedangkan filosofi uji Johnson-Graybill, Tussel, dan LBI juga saling mirip. Oleh karena itu, hanya akan diberikan penjelasan singkat mengenai uji Tukey dan Tussel. Referensi tambahan mengenai uji aditivitas dapat dilihat di [Simeckova *et al.* (2018)](https://www2.karlin.mff.cuni.cz/~antoch/robust08/postery/simeckova.pdf)</span>
<span id="cb148-768"><a href="#cb148-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-769"><a href="#cb148-769" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Asumsi bentuk interaksi tertentu: uji Tukey</span></span>
<span id="cb148-770"><a href="#cb148-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-771"><a href="#cb148-771" aria-hidden="true" tabindex="-1"></a>Jika kita menggunakan rancangan faktorial, di mana kombinasi perlakuan diulang sebanyakan $r$ kali, uji-F untuk efek interaksi merupakan bagian dari ANOVA. Namun, derajat bebas galat di rancangan faktorial adalah $ab(n-1)$, sedangkan $n=1$ di RAKL - satu perlakuan hanya muncul sekali di tiap kelompok. Derajat bebas galat akan nol jika kita menggunakan cara tersebut. </span>
<span id="cb148-772"><a href="#cb148-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-773"><a href="#cb148-773" aria-hidden="true" tabindex="-1"></a>Namun, Uji Tukey pada dasarnya hanya menambahkan satu parameter $\theta$. Parameter tersebut hanya mengambil satu derajat bebas sehingga derajat bebas galat tidak menjadi nol. Akan dibandingkan model tanpa interaksi dengan model berbentuk:</span>
<span id="cb148-774"><a href="#cb148-774" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-775"><a href="#cb148-775" aria-hidden="true" tabindex="-1"></a>y_{ij}=\mu+\tau_{i}+\beta_{j}+\theta\tau_{i}\beta_{j}+\varepsilon_{ij}</span>
<span id="cb148-776"><a href="#cb148-776" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-777"><a href="#cb148-777" aria-hidden="true" tabindex="-1"></a>Dalam kata lain, penduga interaksi dalam uji Tukey berbentuk $\lambda_{ij}=\theta\bar{y}_{i.}\bar{y}_{.j}$ - perkalian antara rata-rata perlakuan ke-i dan rata-rata kelompok ke-j, serta suaut konstanta. Oleh karena itu, hipotesis uji Tukey adalah:</span>
<span id="cb148-778"><a href="#cb148-778" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-779"><a href="#cb148-779" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb148-780"><a href="#cb148-780" aria-hidden="true" tabindex="-1"></a>H_{0}&amp;: \theta=0 \text{ (Model aditif)} <span class="sc">\\</span></span>
<span id="cb148-781"><a href="#cb148-781" aria-hidden="true" tabindex="-1"></a>H_{1}&amp;: \theta\neq0 \text{ (Model tak aditif)}</span>
<span id="cb148-782"><a href="#cb148-782" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb148-783"><a href="#cb148-783" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-784"><a href="#cb148-784" aria-hidden="true" tabindex="-1"></a>Dengan statistik uji:</span>
<span id="cb148-785"><a href="#cb148-785" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-786"><a href="#cb148-786" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb148-787"><a href="#cb148-787" aria-hidden="true" tabindex="-1"></a>S_{T}&amp;=\frac{KT_{interaksi}}{KTG} \sim F_{(\alpha,1,db_{g})}<span class="sc">\\</span></span>
<span id="cb148-788"><a href="#cb148-788" aria-hidden="true" tabindex="-1"></a>KT_{interaksi}&amp;=JK_{interaksi}=\frac{\left<span class="co">[</span><span class="ot">\sum_{i=1}^t\sum_{j=1}^r y_{ij}(\bar{y}_{i.}-\bar{y}_{..})(\bar{y}_{.j}-\bar{y}_{..})\right</span><span class="co">]</span>^2}{\sum_{i=1}^t(\bar{y}_{i.}-\bar{y}_{..})^2\sum_{j=1}^r(\bar{y}_{.j}-\bar{y}_{..})^2}<span class="sc">\\</span></span>
<span id="cb148-789"><a href="#cb148-789" aria-hidden="true" tabindex="-1"></a>JK_{P}&amp;=r\sum_{i=1}^t(\bar{y}_{i.}-\bar{y}_{..})^2<span class="sc">\\</span></span>
<span id="cb148-790"><a href="#cb148-790" aria-hidden="true" tabindex="-1"></a>JK_{K}&amp;=t\sum_{j=1}^r(\bar{y}_{.j}-\bar{y}_{..})^2<span class="sc">\\</span></span>
<span id="cb148-791"><a href="#cb148-791" aria-hidden="true" tabindex="-1"></a>JK_{T}&amp;=\sum_{i=1}^t\sum_{j=1}^r(\bar{y}_{ij}-\bar{y}_{..})^2<span class="sc">\\</span></span>
<span id="cb148-792"><a href="#cb148-792" aria-hidden="true" tabindex="-1"></a>JK_{G}&amp;=JK_{T}-JK_{P}-JK_{K}-JK_{interaksi}<span class="sc">\\</span></span>
<span id="cb148-793"><a href="#cb148-793" aria-hidden="true" tabindex="-1"></a>KT_{g}&amp;=\frac{JK_{G}}{db_{g}}=\frac{JK_{G}}{(t-1)(r-1)-1}</span>
<span id="cb148-794"><a href="#cb148-794" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb148-795"><a href="#cb148-795" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-796"><a href="#cb148-796" aria-hidden="true" tabindex="-1"></a>Note, $db_{g}=(t-1)(r-1)-1$ karena derajat bebas galat RAKL biasa berupa $(t-1)(r-1)$, tertapi satu derajat bebas diambil $\theta$. Untuk mengimplementasikan uji di R, data harus berbentuk matriks - dalam kata lain, tiap kelompok merupakan baris, dan tiap kolom merupakan perlakuan. Lalu, kolom kelompok harus tidak ada. Matriks hanya berisi data, dengan tiap baris menandakan kelompok dan kolom menandakan perlakuan.</span>
<span id="cb148-797"><a href="#cb148-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-800"><a href="#cb148-800" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-801"><a href="#cb148-801" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb148-802"><a href="#cb148-802" aria-hidden="true" tabindex="-1"></a>DataRAKLWide<span class="ot">&lt;-</span><span class="fu">dcast</span>(DataRAKL,Kelompok<span class="sc">~</span>Perlakuan,<span class="at">value.var=</span><span class="st">"Produksi"</span>) <span class="co"># (data, baris~kolom)</span></span>
<span id="cb148-803"><a href="#cb148-803" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(DataRAKLWide[<span class="sc">-</span><span class="dv">1</span>]) <span class="co">#keluarkan kolom 1 (nama kelompok)</span></span>
<span id="cb148-804"><a href="#cb148-804" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-805"><a href="#cb148-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-806"><a href="#cb148-806" aria-hidden="true" tabindex="-1"></a>Lakukan uji:</span>
<span id="cb148-807"><a href="#cb148-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-810"><a href="#cb148-810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-811"><a href="#cb148-811" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(additivityTests)</span>
<span id="cb148-812"><a href="#cb148-812" aria-hidden="true" tabindex="-1"></a><span class="fu">tukey.test</span>(Y,<span class="at">alpha=</span><span class="fl">0.05</span>) <span class="co">#alpha dapat dispesifikasi</span></span>
<span id="cb148-813"><a href="#cb148-813" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-814"><a href="#cb148-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-815"><a href="#cb148-815" aria-hidden="true" tabindex="-1"></a>Uji Tukey menolak $H_{0}$, sehingga dapat disimpulkan $\theta\neq0$ dan model tak aditif. Bandingkan dengan uji Mandel:</span>
<span id="cb148-816"><a href="#cb148-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-819"><a href="#cb148-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-820"><a href="#cb148-820" aria-hidden="true" tabindex="-1"></a><span class="fu">mandel.test</span>(Y,<span class="at">alpha=</span><span class="fl">0.05</span>)</span>
<span id="cb148-821"><a href="#cb148-821" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-822"><a href="#cb148-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-823"><a href="#cb148-823" aria-hidden="true" tabindex="-1"></a>Uji tersebut juga menolak $H_{0}$.</span>
<span id="cb148-824"><a href="#cb148-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-825"><a href="#cb148-825" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Uji dari akar ciri: Tussel, LBI, Johnson-Graybill</span></span>
<span id="cb148-826"><a href="#cb148-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-827"><a href="#cb148-827" aria-hidden="true" tabindex="-1"></a>Uji Tukey mengasumsikan bentuk interaksi tertentu. Namun, bisa saja bentuk interaksi antara kelompok dan perlakuan lebih kompleks dari yang diberikan uji Tukey. Dalam kasus ini, kuasa uji (probabilitas menolak $H_{0}$ jika $H_{1}$ benar) dari uji Tukey dan Mandel relatif lebih rendah.</span>
<span id="cb148-828"><a href="#cb148-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-829"><a href="#cb148-829" aria-hidden="true" tabindex="-1"></a>Ketiga uji ini muncul dari mengkaji matriks residual $R$, di mana elemen matriks tersebut adalah:</span>
<span id="cb148-830"><a href="#cb148-830" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-831"><a href="#cb148-831" aria-hidden="true" tabindex="-1"></a>r_{ij}=y_{ij}-\bar{y}_{i.}-\bar{y}_{.j}+\bar{y}_{..}</span>
<span id="cb148-832"><a href="#cb148-832" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb148-833"><a href="#cb148-833" aria-hidden="true" tabindex="-1"></a>Lalu, matriks tersebut akan dikali dengan transposenya, $RR^{T}$ dan akan dicari akar ciri matriks tersebut. Akar ciri diurutkan sehingga $k_{1}\geq k_{2}\geq ... \geq k_{n}$. Lalu, tiap akar ciri dibagi dengan jumlah total akar ciri, sehingga $\omega_{i}=k_{1}/\sum_{i=1}^n k_{i}$. Jika ada interaksi, beberapa $\omega_{i}$ akan lebih besar dari yang lainnya. Statistik uji Johnson-Graybill merupakan akar ciri terstandarisasi terbesar $\omega_{1}$. Statistik uji Tussel dan LBI mencari m jumlah akar ciri, di mana jumlah tersebut adalah $min(r,t)-1$. Maka, dicari jumlah yang terkecil dari jumlah perlakuan atau jumlah kelompok. Angka tersebut dikurangi satu dan diambil m akar ciri sebanyak jumlah tersebut. LBI menambahkan akar ciri tersebut sedangkan Tussel mengalikan akar ciri. Johnson Graybill dan LBI menolak $H_{0}$ jika statistik ujinya lebih besar dari nilai kritis. Uji Tussel menolak $H_{0}$ jika statistik ujinya lebih kecil dari nilai kritis. Implementasi uji di R:</span>
<span id="cb148-834"><a href="#cb148-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-837"><a href="#cb148-837" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-838"><a href="#cb148-838" aria-hidden="true" tabindex="-1"></a><span class="fu">johnson.graybill.test</span>(Y)</span>
<span id="cb148-839"><a href="#cb148-839" aria-hidden="true" tabindex="-1"></a><span class="fu">lbi.test</span>(Y)</span>
<span id="cb148-840"><a href="#cb148-840" aria-hidden="true" tabindex="-1"></a><span class="fu">tusell.test</span>(Y)</span>
<span id="cb148-841"><a href="#cb148-841" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-842"><a href="#cb148-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-843"><a href="#cb148-843" aria-hidden="true" tabindex="-1"></a>Dapat dilihat bahwa hasil uji Tukey dan Mandel berbeda dengan uji berdasarkan akar ciri. $\alpha$ sama - dalam kata lain, probabilitas menolak $H_{0}$ jika $H_{0}$ benar sama. Namun, kuasa uji berbeda. Jika bentuk interaksi sederhana ($\theta\tau_{i}\beta_{j}$), uji Tukey dan Mandel memiliki kuasa lebih besar dari uji berdasarkan akar ciri. Namun, jika bentuk interaksi lebih kompleks, uji akar ciri memiliki kuasa lebih besar.</span>
<span id="cb148-844"><a href="#cb148-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-845"><a href="#cb148-845" aria-hidden="true" tabindex="-1"></a>Dalam kasus ini, dapat dilihat skenario-skenario tertentu. Jika interaksi kompleks, seharusnya uji Tukey dan Mandel cendurung taktolak $H_{0}$ (karena kuasa uji lebih rendah) dan uji akar ciri cenderung menolak $H_{0}$. Jika interaksi sederhana, seharusnya uji Tukey dan Mandel cenderung tolak $H_{0}$ (karena kuasa uji lebih tinggi) dan uji akar ciri cenderung taktolak $H_{0}$. Jika tidak ada interaksi, $\alpha$ sudah dibuat sama sehingga seharusnya tidak ada kecenderungan tertentu.</span>
<span id="cb148-846"><a href="#cb148-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-847"><a href="#cb148-847" aria-hidden="true" tabindex="-1"></a>Kasus ini sepertinya sesuai dengan skenario interaksi sederhana. Oleh karena itu, hasil uji Tukey dan Mandel dapat lebih dipercaya. Selain itu, sudah ada plot interaksi yang memperkuat kepercayaan bahwa interaksi benar adanya.</span>
<span id="cb148-848"><a href="#cb148-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-849"><a href="#cb148-849" aria-hidden="true" tabindex="-1"></a>Sebagai tambahan terakhir, implementasi uji Tukey di Python dapat dilihat di notebook Google Colab <span class="co">[</span><span class="ot">ini</span><span class="co">](https://colab.research.google.com/drive/1JpEQ5KDOACZIBDlQW770NCJnaFDLNCQ3?usp=sharing)</span>.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>